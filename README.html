<!DOCTYPE html>
<html><body>
<head>
<style>
body {
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}
h1 { margin-top: 0.5em; margin-bottom: 0.3em; border-bottom: 2px solid }
h2 { margin-top: 0.3em; margin-bottom: 0.2em; border-bottom: 1px solid }
h3 { margin-top: 0.2em; margin-bottom: 0.1em; border-bottom: 1px solid silver }
h4 { margin-top: 0.1em; margin-bottom: 0.05em; }

p  { margin-top: 0.3em; margin-bottom: 0.0em; }
ul { margin-top: 0.1em; margin-bottom: 0.5em; }
li { margin-top: 0.1em; margin-bottom: 0.0em; }
blockquote {
  border: 1px solid #999;  border-radius: 0.1em;
  padding: 2px;            background-color: mintcream;
}
code {
  background-color: whitesmoke;
  border: 1px solid #999;  border-radius: 0.3em;
  font-family: Monaco, monospace;
  font-size: 16px;
  padding: 0px;
  white-space: pre
}
.block {
  margin-top: 0.1em;
  background-color: snow;  display: block;
  padding: 5px;
}
table, th, td {
    vertical-align: top;
    text-align: left;
    border-collapse: collapse;
    border: 1px solid grey;
    margin: 0.05em 0.05em;
    padding: 3px 5px;
}
table { min-width: 400px;         }
th    { background-color: LightCyan; }
</style>
</head>
<h1><a id="Package_civ" href="#Package_civ">Package civ</a> (<a href="https://github.com/civboot/civlua/blob/main/./"><i>src</i></a>)</h1><table>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org">https://lua.civboot.org</a></td>
</tr>
<tr>
<td><b>repo</b></td>
<td><a href="https://github.com/civboot/civlua">https://github.com/civboot/civlua</a></td>
</tr>
</table>

civlua: a minimalist, self-documenting and public domain tech stack.
<p>
<blockquote>You are reading the developer documentation. Tutorial-style documentation is
planned in the future for both absolute beginners and knowledge experts,
but has not yet been started.</blockquote>
<p>
<h2><a id="Installation" href="#Installation">Installation</h2></a>
Install Lua with <code>apt-get install lua</code>, <code>brew lua</code> or however you normally
install software, or follow directions at <a href="https://lua.org/start.html">https://lua.org/start.html</a>.
<p>
Follow <a href="#Package_pkg">#Package_pkg</a> to be able to <code>require</code> civlua packages and write your
own packages.
<p>
<h2><a id="why" href="#why">Why?</h2></a>
The main motivation for me to write this repository is so I have a simple tech
stack that I can hack for my shell, editor, blog, documentation host, etc --
and so I can use that simple tech stack to teach my kids programming and
technology through small games and scripts. Eventually, this will be the core
user software of <a href="https://civboot.org">https://civboot.org</a>.
<p>
Software is complex. Some of the complexity is to serve goals like performance
and scaleability; which can be good for goals like large-scale collaboration.
However, the core tools of a developer such as their editor, shell, utilities
and documentation should should be completely <i>knowable</i> and <i>hackable</i>.
How can our tech stack be knowable when all the core tools are so bloated?
The <code>Python/</code> directory in  <a href="https://github.com/python/cpython">CPython</a> is
124k lines (and <code>Lib</code> is 790k). <a href="code.commonmark.org">CommonMark</a>, which just
renders markdown files, is 20 thousand lines alone!
<p>
The <a href="https://lua.org">Lua</a> language is only 20k lines of code and this library
(~15k lines) will soonish implement an entire tech stack that a small team of
developers or students could use to cooperate and hack. Technology is much more
joyful when it is at this size and complexity.
<p>
<h2><a id="Packages" href="#Packages">Packages</h2></a>
The following are packaged directly in this repository as subdirectories.
<p>
<h3>Commands</h3>
These can all be called directly in bash with <code>./civ.lua &lt;cmd&gt; ...</code>. You can view
their command documentation with <code>./civ.lua help &lt;cmd&gt;</code>. <ul>
<li><a href="#Package_ele"><b>Ele</b></a>: Extendable Lua Editor and Lua-first shell --
still in development.</li>
<li><a href="#Package_doc"><b>doc</b></a>: get help on any package or lua object as cxt or rendered
with color on the terminal.</li>
<li><a href="#Package_cxt"><b>cxt</b></a>: this document and all code documentation is written in
<b>cxt</b>, a powerful ultra-simple markup language which is designed to be as
easy as possible to parse (for computers <i>and</i> humans) while still using as
few characters as possible to express format for common cases. Commands: <ul>
<li><code>cxt.html</code>: render a cxt document in html.</li>
<li><code>cxt.term</code>: render a cxt document on the terminal</li>
</ul></li>
<li><a href="#Package_ff"><b>ff</b></a>: find and fix utility, like a superchanged find+grep from unix
land.</li>
</ul>
<p>
<h3>Core Libraries</h3>
The following are the "core libraries" and represent the "batteries included"
of Civlua. They maintain minimalism but enable ergonomic programming, powerful
scripting, asynchronous file access and other goodies. <ul>
<li><a href="#Package_pkg"><b>pkg</b></a>: enables self-documenting code and cleaner dependency
management. Defines the PKG protocol to enable self-documenting modules
as well as fix Lua's biggest wart (implicit globals).</li>
<li><a href="#Package_shim"><b>shim</b></a>: write scripts for Lua, execute from shell. Think
python's <code>argparse</code> but cleaner and allows for Lua OR shell execution.</li>
<li><a href="#Package_metaty"><b>metaty</b></a>: enable typosafe, self documenting records (aka
structs) which utilize Lua metatables.</li>
<li><a href="#Package_fmt"><b>fmt</b></a>: format strings and lua nested types with an (optional)
style interface.</li>
<li><a href="#Package_ds"><b>ds</b></a>: Data Structures and algnorithms. This module is
packed with tons of tiny functions, types and interfaces which enable ergonomic
scripting as well as creating applications such as editors and version
control systems in pure Lua.</li>
<li><a href="#Package_lines"><b>lines</b></a>: treat files like tables of lines and apply
algorithms for that interface. The <code>lines.File</code> and <code>lines.EdFile</code> are
especially worth checking out.</li>
<li><a href="#Package_civix"><b>civix</b></a>: unix system interface: ergonomic unix <code>sh</code>,
time and file modification are here.</li>
<li><a href="#Package_civtest"><b>civtest</b></a>: no batteries would be complete without a testing
library.  civtest is minimal but gets the job done.</li>
<li><a href="#Package_lap"><b>lap</b></a>: Lua Asynchronous Protocol, for advanced users who want
concurrency in pure-lua.</li>
<li><a href="#Package_fd"><b>fd</b></a>: file-descriptor library for async files and other file
operations.</li>
<li><a href="#Package_pegl"><b>pegl</b></a>: general-purpose PEG-like parser library, used
for <a href="#Package_cxt">cxt</a> and will help provide syntax-highlighting in ele.</li>
<li><a href="#Package_lson"><b>lson</b></a>: implements de/serialization of arbitrary
concrete data (including tables) to/from JSON and an extension called LSON.</li>
</ul>
<p>
<h3>Styling</h3>
The following define an interface to enable color output across any device,
including: normal terminal, Ele (the civlua text editor) and html syntax
highlighting: <ul>
<li><a href="#Package_asciicolor"><b>asciicolor</b></a>: specify color and styles using
ascii characters, i.e. <code>"BW"</code> is bold+underlined black text on white
background.</li>
<li><a href="#Package_vt100"><b>vt100</b></a>: defines common VT100 (aka standard unix)
terminal input and output.</li>
</ul>
<p>
<h3>Data Management</h3>
Civlua aims to implement a simple version control (similar to git) while also
enabling CivbootOS's configuration and data storage needs (aka network config,
simple databases, maybe a spreadsheet program, etc): <ul>
<li><a href="#Package_luck"><b>luck</b></a>: lua-like configuration language with imports.
Think <a href="https://bazel.build/">bazel</a> but only for data -- though you could
make a build system on top!</li>
<li><a href="#Package_tv"><b>tv</b></a>: tabbed-values. Similar in spirit to TSV
(tab-separated-values) but with an actual spec and the ability to define a
header with types.</li>
<li><a href="#Package_vcds"><b>vcds</b></a>: version-control data structures. Diffs, cherry
picks, etc.</li>
</ul>
<p>
<h3><a id="Luarocks" href="#Luarocks">Luarocks</h3></a>
The <a href="#Package_pkgrock"><b>pkgrock</b></a> script enables converting <code>PKG.lua</code>
files to <a href="https://luarocks.org/">https://luarocks.org/</a> specs, as well as running the magical git
incantations necessary for luarocks to find the version.
<p>
<h2><a id="references" href="#references">Shoutouts and Inspiration</h2></a> <ul>
<li><a href="https://duskos.org">https://duskos.org</a> which inspired Civboot and which this software
eventually hopes to use as (one of) its target operating systems</li>
<li><a href="https://lua.org">https://lua.org</a> for creating an awesome and minimal programming langauge</li>
<li><a href="https://civboot.org">https://civboot.org</a></li>
</ul>
<p>
<h2><a id="LICENSE" href="#LICENSE">LICENSE</h2></a>
All software, tests, documentation, notes and anything else in this repository
is released into the public domain (<a href="https://github.com/civboot/civlua/blob/main/UNLICENSE">UNLICENSE</a>) unless otherwise noted in
the given source file.
<p>
If you find any of this software helpful or copy large parts of it, please give
us a a shoutout in your own projects and let us know by opening an
<a href="https://github.com/civboot/civlua/issues">issue</a>. Please note that this is not
required but is highly appreciated, thanks!
<p>
<p>
<h2>Module <a id="civ" href="#civ">civ</a> (<a href="https://github.com/civboot/civlua/blob/main/civ.lua#L5"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="civ.__name" href="#civ.__name">civ.__name</a></h4>
<h3>Function <a id="civ.Fmt" href="#civ.Fmt">civ.Fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/civ.lua#L19"><i>src</i></a>)</h3>
create a Fmt with sensible defaults for scripts
Typically <code>t.to</code> is unset (default=stderr) or set to stdout.
<h3>Function <a id="civ.main" href="#civ.main">civ.main</a><code>(arg) -&gt; int: return code</code> (<a href="https://github.com/civboot/civlua/blob/main/civ.lua#L37"><i>src</i></a>)</h3>
<h3>Function <a id="civ.setupFmt" href="#civ.setupFmt">civ.setupFmt</a> (<a href="https://github.com/civboot/civlua/blob/main/civ.lua#L21"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_shim" href="#Package_shim">Package shim</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>write scripts for Lua, execute from shell</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-5</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_shim">https://lua.civboot.org#Package_shim</a></td>
</tr>
</table>
write scripts for Lua, execute from shell. This is a tiny Lua module that makes
it easy to write utilities that work from either bash or Lua.
<p>
Example script (see also: <a href="#pkg-script">#pkg-script</a>) <code class="block">#!/usr/bin/env -S lua -e "require'pkglib'()"
local G = G or _G -- typosafe globals

--- module documentation
local M = G.mod and mod'myCmdName' or {} -- self-documenting module
G.MAIN = G.MAIN or M

local mty = require'metaty'
local shim = require'shim'

--- Comamnd documentation
M.Args = mty'Args' {
  'name [string]: the name to say hello to', name='World',
}

M.main = function(args)
  args = M.Args(shim.parseStr(args))
  print('Hello '..args.name..'!')
end

if M == MAIN then os.exit(M.main(G.arg)) end
return M -- return as library</code>
<p>
Then in <code>PKG.lua</code> add <code>main = 'myCmdName.Main'</code> to enable better
documentation formatting. Get documentation with <code>doc 'myCmdName'</code>.
<p>
<h2>Module <a id="shim" href="#shim">shim</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L2"><i>src</i></a>)</h2>
shim: use a lua module in lua OR in the shell.
<p>
<h4>Value <a id="shim.__name" href="#shim.__name">shim.__name</a></h4>
<h3>Function <a id="shim.boolean" href="#shim.boolean">shim.boolean</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L75"><i>src</i></a>)</h3>
Duck type: always return a boolean (except for nil).
See BOOLS (above) for mapping.
<h3>Function <a id="shim.bools" href="#shim.bools">shim.bools</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L80"><i>src</i></a>)</h3>
<h3>Function <a id="shim.expand" href="#shim.expand">shim.expand</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L141"><i>src</i></a>)</h3>
expand string keys into <code>--key=value</code>, ordered alphabetically.
This is mostly useful for interfacing with non-lua shells.
<h3>Function <a id="shim.file" href="#shim.file">shim.file</a><code>(v, default, mode--[[w+]]) -&gt; file, error?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L126"><i>src</i></a>)</h3>
Duck type: get a file handle.
If <code>v or default</code> is a string then open the file in mode <code>default='w+'</code>
<h3>Function <a id="shim.getEnvBool" href="#shim.getEnvBool">shim.getEnvBool</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L148"><i>src</i></a>)</h3>
<h3>Function <a id="shim.list" href="#shim.list">shim.list</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L108"><i>src</i></a>)</h3>
<h3>Function <a id="shim.listSplit" href="#shim.listSplit">shim.listSplit</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L118"><i>src</i></a>)</h3>
Duck type: if val is a string then splits it
if it's a list leaves alone.
<h3>Function <a id="shim.number" href="#shim.number">shim.number</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L86"><i>src</i></a>)</h3>
Duck type: always return a number
<h3>Function <a id="shim.parse" href="#shim.parse">shim.parse</a><code>(v) -&gt; args</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L18"><i>src</i></a>)</h3>
Parse either a string or list and convert them to key=value table.
v can be either a list of <code>{'strings', '--option=foo'}</code>
or <code>{'strings", option='foo'}</code> or a combination of both. If v is a string then
it is split on whitespace and parsed as a list.
<p>
Note: this handles repeat keys by creating and appending a list for that key.
<h3>Function <a id="shim.parseList" href="#shim.parseList">shim.parseList</a><code>(strlist) -&gt; args</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L56"><i>src</i></a>)</h3>
Note: typically use parse() or parseStr() instead.
<h3>Function <a id="shim.parseStr" href="#shim.parseStr">shim.parseStr</a><code>(str) -&gt; args</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L41"><i>src</i></a>)</h3>
parses the string by splitting via whitespace.
Asserts the string contains no special chars: <code>'"[]</code>
This is for convinience, use a table if it's not enough.
<p>
Note: if the input is already a table it just returns it.
<h3>Function <a id="shim.popRaw" href="#shim.popRaw">shim.popRaw</a><code>(args, to) -&gt; to</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L160"><i>src</i></a>)</h3>
pop raw arguments after '--'
Removes them (including '--') from args.
<h3>Function <a id="shim.setup" href="#shim.setup">shim.setup</a><code>(Args, args) -&gt; args, styler</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L177"><i>src</i></a>)</h3>
Performs common setup by parsing and constructing an Args metaty, getting
the standard `to` attribute and checking help and printing to <code>to</code> if
requested.
<p>
Returns the constructed Args and Styler.
<p>
<blockquote> Note: This method depends on the <code>doc</code> module</blockquote>
<h3>Function <a id="shim.short" href="#shim.short">shim.short</a><code>(args, short, long, value) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L62"><i>src</i></a>)</h3>
Helper for dealing with <code>-s --short</code> arguments. Mutates
args to convert short paramaters to their long counterpart.
<h3>Function <a id="shim.string" href="#shim.string">shim.string</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/shim/shim.lua#L99"><i>src</i></a>)</h3>
Duck type: always return a string
This is useful for some APIs where you want to convert
number/true/false to strings
Converts nil to ''
<p>
<h1><a id="Package_metaty" href="#Package_metaty">Package metaty</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Simple but effective Lua type system using metatables</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-15</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_metaty">https://lua.civboot.org#Package_metaty</a></td>
</tr>
</table>
simple but effective Lua type system using metatables
<p>
Metatype is a library and specification for creating performant, documented, and
typo-safe Lua record-types which can be formatted.
<p>
<blockquote> Turn on typo checking by setting the global <code>METATY_CHECK=true</code> before
requiring any modules that require metaty.</blockquote>
<p>
<code class="block">local G = G or _G
--- module documentation
local M = G.mod and mod'myMod' or {} -- (see pkg)

local mty = require'metaty'

-- Documentation for Pos (position)
M.Pos = mty'Pos' {
  'x[int]: x coordinate',
  'y[int]: y coordinate', y = 0,
}

local p1 = Pos{x=4}
local p1 = Pos{x=4, y=3, z=5} -- error if checking turned on</code>
<p>
The above expands to the following. Note that the "typosafe" elements
are removed when <code>not METATY_CHECK</code> <code class="block">local M = {}
local metaty = require'metaty'

local Pos = setmetatable({
  __name='Pos',
  y = 0,
  -- used with metaty.Fmt and help()
  __fields={'x', 'y', x='[int]', y='[int]'},
  __newindex = metaty.newindex, -- typosafe setting
}, {
  __call = function(T, t)
    metaty.fieldsCheck(T.__fields, t) -- typosafe constructor
    return setmetatable(t, T)
  end,
  __index = metaty.index, -- typosafe getting
})
Pos.__index = Pos

-- `mod` gives documentation reflection
PKG_LOCS[M.myFn]         = 'path/to/file.lua:123'
PKG_NAMES[M.myFn]        = 'mymod.Pos'
PKG_LOOKUP['myMod.Pos'] = M.Pos</code>
<p>
<h3><a id="metaty-API" href="#metaty-API">API</h3></a> <ul>
<li><code>ty(v)</code> return the metaty of <code>v</code>. For tables this is <code>getmetatable(v)</code>,
else it is <code>type(v)</code>.</li>
<li><code>metaty'name' {'field1[type] documentation', 'field2[type]'}</code>
creates a documented and typo-safe record type (see examples) <ul>
<li>the <code>[type]</code> field can also be in the form <code>{type}</code> for a list
of the type or <code>{string: type}</code> for a map of the type.</li>
<li><code>@&lt;decimal&gt;</code> (i.e. <code>@2</code>) can be put after the type to specify the
decimal value to use for the field when de/serializing.
<p>
It is recommended that once you assign a field to a decimal value to
never change it if there is any chance it is stored or being used
by an RPC service/etc with the previous version.</li>
</ul></li>
</ul>
<p>
See also: <a href="#Package_fmt">#Package_fmt</a>
<p>
<h3><a id="metaty-why" href="#metaty-why">Why?</h3></a>
<p>
Lua is a fast and fun language. However it often lacks the ability to express
intent when it comes to the structure of data. Also, not only is it not
type-safe but it is also TYPO-unsafe -- small mistakes in the name of a field
can easily result in hard to diagnose bugs, even when they occur in one's
unit-test suite.
<p>
Checking for typos incurrs a small performance cost, so it is disabled by
default. However, it is well-worth the cost in your unit tests.
<p>
<h3><a id="metaty-spec" href="#metaty-spec">Spec</h3></a>
For a type to be considered a "metaty" the only requirement is that it has a
metatable set and that metatable has a <code>__name</code> field.
<p>
The following fields can optionally be set on the metatable: <ul>
<li><code>__fmt</code>: used with <a href="#Package_fmt">#Package_fmt</a></li>
<li><code>__fields</code>: should contain a table of <code>fieldName -&gt; fieldtype</code>.
<code>fieldType</code> can be an arbitrary string and is only for documentation, though
future libraries/applications (type checkers) may eventually wish to consume
it. <code>metaty</code> (the library) uses the format <code>"fieldName [user-specified-type]"</code> <ul>
<li>This is used by formatting libraries when printing the types (so the fields
are printed in deterministic order).</li>
</ul></li>
<li>default values (i.e. <code>y</code> in the example) are assigned directly to the type.
Documentation formatters may use these to format help messages.</li>
<li><code>__fieldIds</code>: set using the <code>@&lt;decimal&gt;</code> syntax after the type, used
for de/serializing.</li>
</ul>
<p>
In addition, there is runtime type specification defined below.
<p>
<h3><a id="metaty-typoe-check" href="#metaty-typoe-check">Runtime typo checking (optional)</h3></a>
<blockquote>Note: Runtime typo checking has a cost and so is <b>optional</b>
(default=false)</blockquote>
<p>
To enable runtime checking set the global value <code>METATY_CHECK = true</code> at the
top of your application or test file (before executing ANY <code>require</code> calls).
<p>
You can override the typo-checking behavior of a single type with <code class="block">getmetatable(MyType).__call  = myConstructor
getmetatable(MyType).__index = myIndex
MyType.__newindex            = myNewIndex</code>
<p>
<h2>Module <a id="metaty" href="#metaty">metaty</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L4"><i>src</i></a>)</h2>
metaty: simple but effective Lua type system using metatable
<p>
<h4>Value <a id="metaty.DEPTH_ERROR" href="#metaty.DEPTH_ERROR">metaty.DEPTH_ERROR</a></h4>
<h3>Table <a id="metaty.KEYWORD" href="#metaty.KEYWORD">metaty.KEYWORD</a></h3>
<h4>Value <a id="metaty.__name" href="#metaty.__name">metaty.__name</a></h4>
<b>Functions: </b> <table>
<tr>
<td><code>metaty.constructChecked</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L202">src</a>)</td>
</tr>
</table>
<h3>Function <a id="metaty.callable" href="#metaty.callable">metaty.callable</a><code>(obj) -&gt; bool: return if obj is callable</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L83"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.constructChecked" href="#metaty.constructChecked">metaty.constructChecked</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L202"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.constructUnchecked" href="#metaty.constructUnchecked">metaty.constructUnchecked</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L205"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.enum" href="#metaty.enum">metaty.enum</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L401"><i>src</i></a>)</h3>
Create an enum type which can convert between string and integers.
<p>
This "type" is mainly to allow typosafe enums, both when creating the variant
(i.e. <code>v = MyEnum.VARIANT</code>) and when matching using the <code>matcher</code> method below.
It also allows using checked enums in <code>ds.pod</code>.
<p>
One of the main benefits of using an enum is to ensure that when you are
matching you don't make a typo mistake (i.e. WOKER instead of WORKER). In
lua there is no native <code>switch</code> statement (or similar), but table lookup
on functions can be equally as good -- see the example below.
<p>
<h2>Example</h2>
<code class="block">M.Job = enum'Job' {
  OWNER   = 1,
  MANAGER = 2,
  COOK    = 3,
  WAITER  = 4,
}

assert('OWNER', M.Job.OWNER)

-- either string or id will return string
assert('OWNER', M.Job.name(1))
assert('OWNER', M.Job.name('OWNER'))

-- either string or id will return id
assert(1, M.Job.id(1))
assert(1, M.Job.id('OWNER'))

-- create a table that converts a variant (name or id) -&gt; function.
local doJob = M.Job:matcher {
  OWNER   = function() print'tell them to get to work' end,
  MANAGER = function() print'get to work!'             end,
  COOK    = function() print'order up!'                end,
  WAITER  = function() print'they want spam and eggs'  end,

  -- Removing any of the above will cause an error that not all variants
  -- are covered. You can use :partialMatcher if you want to
  -- return nil instead.
  --
  -- Below will cause an error: no variant DISHWASHER
  DISHWASHER = function() end
}

-- call in your own function like:
doJob[job](my, args)</code>
<p>
<h3>Function <a id="metaty.enum_matcher" href="#metaty.enum_matcher">metaty.enum_matcher</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L312"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.enum_partialMatcher" href="#metaty.enum_partialMatcher">metaty.enum_partialMatcher</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L301"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.enum_toPod" href="#metaty.enum_toPod">metaty.enum_toPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L291"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.enum_tostring" href="#metaty.enum_tostring">metaty.enum_tostring</a><code>(E) -&gt; E.__name</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L288"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.eq" href="#metaty.eq">metaty.eq</a><code>(a, b) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L172"><i>src</i></a>)</h3>
compare tables or anything else
<h3>Function <a id="metaty.eqDeep" href="#metaty.eqDeep">metaty.eqDeep</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L169"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.extend" href="#metaty.extend">metaty.extend</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L286"><i>src</i></a>)</h3>
Extend the Type with (optional) new name and (optional) additional fields.
<h3>Function <a id="metaty.extendFields" href="#metaty.extendFields">metaty.extendFields</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L234"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.fieldsCheck" href="#metaty.fieldsCheck">metaty.fieldsCheck</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L198"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.fninfo" href="#metaty.fninfo">metaty.fninfo</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L113"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.getCheck" href="#metaty.getCheck">metaty.getCheck</a><code>() -&gt; CHECK</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L44"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.getmethod" href="#metaty.getmethod">metaty.getmethod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L51"><i>src</i></a>)</h3>
get method of table if it exists.
This first looks for the item directly on the table, then the item
in the table's metatable. It does NOT use the table's normal <code>__index</code>.
<h3>Function <a id="metaty.index" href="#metaty.index">metaty.index</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L183"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.indexError" href="#metaty.indexError">metaty.indexError</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L178"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.isEnv" href="#metaty.isEnv">metaty.isEnv</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L38"><i>src</i></a>)</h3>
isEnv: returns boolean for below values, else nil
<h3>Function <a id="metaty.isEnvG" href="#metaty.isEnvG">metaty.isEnvG</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L42"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.isRecord" href="#metaty.isRecord">metaty.isRecord</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L262"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.metaget" href="#metaty.metaget">metaty.metaget</a><code>(t, k) -&gt; rawget(getmetatable(t), k)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L84"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.name" href="#metaty.name">metaty.name</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L78"><i>src</i></a>)</h3>
Given an object (function, table, userdata) return its name.
return nil if it's not one of the above types
<h3>Function <a id="metaty.namedEnum" href="#metaty.namedEnum">metaty.namedEnum</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L346"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.namedRecord" href="#metaty.namedRecord">metaty.namedRecord</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L256"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.nativeEq" href="#metaty.nativeEq">metaty.nativeEq</a><code>(a, b) -&gt; a == b</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L142"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.newindex" href="#metaty.newindex">metaty.newindex</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.rawsplit" href="#metaty.rawsplit">metaty.rawsplit</a><code>(subj, ctx) -&gt; (state, splitstr)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L127"><i>src</i></a>)</h3>
You probably want split instead.
Usage: <code>for ctx, line in rawsplit, text, {'\n', 1} do</code>
<h3>Function <a id="metaty.record" href="#metaty.record">metaty.record</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L268"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.split" href="#metaty.split">metaty.split</a><code>(subj, pat--[[%s+]], index--[[1]]) -&gt; (cxt, str) iter</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L138"><i>src</i></a>)</h3>
split the subj by pattern. <code>ctx</code> has two keys: <code>si</code> (start index) and
<code>ei</code> (end index)
<code class="block">for ctx, line in split(text, '\n') do -- split lines
  ... do something with line
end</code>
<h3>Function <a id="metaty.ty" href="#metaty.ty">metaty.ty</a><code>(o) -&gt; Type: string or metatable</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L60"><i>src</i></a>)</h3>
<h3>Function <a id="metaty.tyName" href="#metaty.tyName">metaty.tyName</a><code>(T, default) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L68"><i>src</i></a>)</h3>
Given a type return it's name
<h3>Function <a id="metaty.validKey" href="#metaty.validKey">metaty.validKey</a><code>(s) -&gt; boolean: s=value is valid syntax</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L98"><i>src</i></a>)</h3>
<h3>Table <a id="metaty.native" href="#metaty.native">metaty.native</a></h3>
<p>
<h1><a id="Package_fmt" href="#Package_fmt">Package fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>format lua types</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_fmt">https://lua.civboot.org#Package_fmt</a></td>
</tr>
</table>
<p>
<h2>Module <a id="fmt" href="#fmt">fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L4"><i>src</i></a>)</h2>
format module: format any type into a readable string
<p>
<h3>Table <a id="fmt.KEYWORD" href="#fmt.KEYWORD">fmt.KEYWORD</a></h3>
<h4>Value <a id="fmt.__name" href="#fmt.__name">fmt.__name</a></h4>
<h3>Record <a id="fmt.Fmt" href="#fmt.Fmt">fmt.Fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L67"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>fmt.Fmt.style</code></td>
<td>[bool] 
enable styling. If true, set <code>to=Styler</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.to</code></td>
<td>[file?] 
if set calls write</td>
</tr>
<tr>
<td><code>fmt.Fmt.keyEnd</code></td>
<td>[string] = <code>", "</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.keySet</code></td>
<td>[string] = <code>"="</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.indexEnd</code></td>
<td>[string] = <code>", "</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.tableStart</code></td>
<td>[string] = <code>"{"</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.tableEnd</code></td>
<td>[string] = <code>"}"</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.listEnd</code></td>
<td>[string] = <code>""</code>
separator between list/map</td>
</tr>
<tr>
<td><code>fmt.Fmt.indent</code></td>
<td>[string] = <code>"  "</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.maxIndent</code></td>
<td>[int] = <code>20</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.numfmt</code></td>
<td>[string] = <code>"%q"</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.strfmt</code></td>
<td>[string] = <code>"%q"</code></td>
</tr>
<tr>
<td><code>fmt.Fmt._level</code></td>
<td>[int] = <code>0</code></td>
</tr>
<tr>
<td><code>fmt.Fmt._nl</code></td>
<td>[string] = <code>"\
  "</code>
(default='\n') newline, indent is added/removed</td>
</tr>
<tr>
<td><code>fmt.Fmt.table</code></td>
<td>[function] = <code>fn"Fmt.table"[/home/rett/projects/civlua/lib/fmt/fmt.lua:184]</code></td>
</tr>
<tr>
<td><code>fmt.Fmt.string</code></td>
<td>[function] = <code>fn"Fmt.string"[/home/rett/projects/civlua/lib/fmt/fmt.lua:135]</code></td>
</tr>
</table>
<h3>Table <a id="fmt.Fmt.__docs" href="#fmt.Fmt.__docs">fmt.Fmt.__docs</a></h3>
<h3>Table <a id="fmt.Fmt.__fieldIds" href="#fmt.Fmt.__fieldIds">fmt.Fmt.__fieldIds</a></h3>
<h3>Table <a id="fmt.Fmt.__fields" href="#fmt.Fmt.__fields">fmt.Fmt.__fields</a></h3>
<h4>Value <a id="fmt.Fmt.__name" href="#fmt.Fmt.__name">fmt.Fmt.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>fmt.Fmt.__index</code></td>
<td>[Ty<Fmt>] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L67">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>fmt.Fmt.tostring</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L220">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Fmt.__call" href="#Fmt.__call">Fmt.__call</a><code>(f, v) -&gt; f</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L185"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.__tostring" href="#Fmt.__tostring">Fmt.__tostring</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L220"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt._write" href="#Fmt._write">Fmt._write</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L93"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.boolean" href="#Fmt.boolean">Fmt.boolean</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L133"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.concat" href="#Fmt.concat">Fmt.concat</a><code>(f, sep, ...) -&gt; f</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L210"><i>src</i></a>)</h4>
fmt ... separated by sep
<h4>Function <a id="Fmt.flush" href="#Fmt.flush">Fmt.flush</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L90"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.format" href="#Fmt.format">Fmt.format</a><code>(f, fmt, ...) -&gt; varargsUsed</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L201"><i>src</i></a>)</h4>
like string.format but use <code>Fmt</code> for <code>%q</code>.
Doesn't return the string, instead writes to <code>Fmt</code>
<h4>Function <a id="Fmt.function" href="#Fmt.function">Fmt.function</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L138"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.items" href="#Fmt.items">Fmt.items</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L147"><i>src</i></a>)</h4>
format items in table "list"
<h4>Function <a id="Fmt.keyvals" href="#Fmt.keyvals">Fmt.keyvals</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L159"><i>src</i></a>)</h4>
format key/vals in table "map"
<h4>Function <a id="Fmt.level" href="#Fmt.level">Fmt.level</a><code>(f, add) -&gt; int: current level</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L88"><i>src</i></a>)</h4>
add to the indent level and get the new value
call with <code>add=nil</code> to just get the current level
<h4>Function <a id="Fmt.lined" href="#Fmt.lined">Fmt.lined</a><code>(f, ...) -&gt; f:concat('\n', ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L215"><i>src</i></a>)</h4>
fmt ... separated by newlines
<h4>Function <a id="Fmt.nil" href="#Fmt.nil">Fmt.nil</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L132"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.number" href="#Fmt.number">Fmt.number</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L134"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.pretty" href="#Fmt.pretty">Fmt.pretty</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L77"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.styled" href="#Fmt.styled">Fmt.styled</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L114"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.tableKey" href="#Fmt.tableKey">Fmt.tableKey</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L130"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.tabulated" href="#Fmt.tabulated">Fmt.tabulated</a><code>(f, ...) -&gt; f:concat('\t', ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L212"><i>src</i></a>)</h4>
fmt ... separated by tabs
<h4>Function <a id="Fmt.thread" href="#Fmt.thread">Fmt.thread</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L136"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.userdata" href="#Fmt.userdata">Fmt.userdata</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L137"><i>src</i></a>)</h4>
<h4>Function <a id="Fmt.write" href="#Fmt.write">Fmt.write</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L101"><i>src</i></a>)</h4>
<h3>Function <a id="fmt.assertf" href="#fmt.assertf">fmt.assertf</a><code>(a, ...) -&gt; a or error(format(...), 2)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L238"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.cmpDuck" href="#fmt.cmpDuck">fmt.cmpDuck</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L22"><i>src</i></a>)</h3>
for comparing two (possibly) different types
<code>nil &lt; bool &lt; number &lt; string &lt; table</code>
<h3>Function <a id="fmt.errorf" href="#fmt.errorf">fmt.errorf</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L237"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.format" href="#fmt.format">fmt.format</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L234"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.fprint" href="#fmt.fprint">fmt.fprint</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L249"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.pretty" href="#fmt.pretty">fmt.pretty</a><code>(v) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L256"><i>src</i></a>)</h3>
pretty format the value
<h3>Function <a id="fmt.print" href="#fmt.print">fmt.print</a><code>(...) -&gt; fprint(io.fmt, ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L253"><i>src</i></a>)</h3>
<code>print(...)</code> but using <code>io.fmt</code>
<h3>Function <a id="fmt.sortKeys" href="#fmt.sortKeys">fmt.sortKeys</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L46"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.tostring" href="#fmt.tostring">fmt.tostring</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L227"><i>src</i></a>)</h3>
<h2>Module <a id="fmt.binary" href="#fmt.binary">fmt.binary</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/binary.lua#L6"><i>src</i></a>)</h2>
format binary text
When called directly returns the result of
<code>binary.columns(fmt.Fmt{}, ...)</code>
<p>
<h4>Value <a id="fmt.binary.__name" href="#fmt.binary.__name">fmt.binary.__name</a></h4>
<h3>Record <a id="fmt.binary.Args" href="#fmt.binary.Args">fmt.binary.Args</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/binary.lua#L26"><i>src</i></a>)</h3>
Command: <code>{'path.bin', width=16, '--', 'literal binary'}</code>
Use <code>-</code> to format stdin
<p>
<b>Fields: </b> <table>
<tr>
<td><code>fmt.binary.Args.width</code></td>
<td>[int] = <code>16</code>
column width in bytes</td>
</tr>
<tr>
<td><code>fmt.binary.Args.fmt</code></td>
<td>[string] = <code>"%.2x "</code>
format string for hex</td>
</tr>
<tr>
<td><code>fmt.binary.Args.to</code></td>
<td>[file] 
(lua only) file to output to (default=stdout)</td>
</tr>
<tr>
<td><code>fmt.binary.Args.i</code></td>
<td>[int] = <code>0</code>
starting index to use</td>
</tr>
</table>
<h3>Table <a id="fmt.binary.Args.__docs" href="#fmt.binary.Args.__docs">fmt.binary.Args.__docs</a></h3>
<h3>Table <a id="fmt.binary.Args.__fieldIds" href="#fmt.binary.Args.__fieldIds">fmt.binary.Args.__fieldIds</a></h3>
<h3>Table <a id="fmt.binary.Args.__fields" href="#fmt.binary.Args.__fields">fmt.binary.Args.__fields</a></h3>
<h4>Value <a id="fmt.binary.Args.__name" href="#fmt.binary.Args.__name">fmt.binary.Args.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>fmt.binary.Args.__index</code></td>
<td>[Ty<Args>] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/binary.lua#L26">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>fmt.binary.Args.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Function <a id="fmt.binary.ascii" href="#fmt.binary.ascii">fmt.binary.ascii</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/binary.lua#L46"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.binary.columns" href="#fmt.binary.columns">fmt.binary.columns</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/binary.lua#L77"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.binary.format" href="#fmt.binary.format">fmt.binary.format</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/binary.lua#L37"><i>src</i></a>)</h3>
<h3>Function <a id="fmt.binary.main" href="#fmt.binary.main">fmt.binary.main</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/binary.lua#L95"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_civtest" href="#Package_civtest">Package civtest</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Ultra simple testing library</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-2</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_civtest">https://lua.civboot.org#Package_civtest</a></td>
</tr>
</table>
Civtest: absurdly simple test library
<p>
This is a no-frills test library. It simply builds on <a href="https://github.com/civboot/civlua/blob/main/lib/metaty">lib/metaty</a> and
<a href="https://github.com/civboot/civlua/blob/main/lib/ds">lib/ds</a> to provide the simplest possible needs for testing.
<p>
<h2>Module <a id="civtest" href="#civtest">civtest</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L4"><i>src</i></a>)</h2>
module for writing simple tests
<p>
<h4>Value <a id="civtest.__name" href="#civtest.__name">civtest.__name</a></h4>
<h3>Record <a id="civtest.Test" href="#civtest.Test">civtest.Test</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L28"><i>src</i></a>)</h3>
<p>
<h3>Table <a id="civtest.Test.__docs" href="#civtest.Test.__docs">civtest.Test.__docs</a></h3>
<h3>Table <a id="civtest.Test.__fieldIds" href="#civtest.Test.__fieldIds">civtest.Test.__fieldIds</a></h3>
<h3>Table <a id="civtest.Test.__fields" href="#civtest.Test.__fields">civtest.Test.__fields</a></h3>
<h4>Value <a id="civtest.Test.__name" href="#civtest.Test.__name">civtest.Test.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>civtest.Test.__index</code></td>
<td>[Ty<Test>] (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L28">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>civtest.Test.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Test.binEq" href="#Test.binEq">Test.binEq</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L56"><i>src</i></a>)</h4>
<h4>Function <a id="Test.contains" href="#Test.contains">Test.contains</a><code>(plain, subj) -&gt; !?error</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L75"><i>src</i></a>)</h4>
assert <code>subj:find(pat, 1, true)</code> (plain find)
<h4>Function <a id="Test.eq" href="#Test.eq">Test.eq</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L45"><i>src</i></a>)</h4>
<h4>Function <a id="Test.matches" href="#Test.matches">Test.matches</a><code>(pat, subj) -&gt; !?error</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L66"><i>src</i></a>)</h4>
assert <code>subj:find(pat)</code>
<h4>Function <a id="Test.throws" href="#Test.throws">Test.throws</a><code>(contains, fn) -&gt; ds.Error</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L88"><i>src</i></a>)</h4>
assert <code>fn()</code> fails and the <code>contains</code> is in the message.
<h3>Function <a id="civtest.assertEq" href="#civtest.assertEq">civtest.assertEq</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L106"><i>src</i></a>)</h3>
simplest assertEq
<h3>Function <a id="civtest.assertErrorPat" href="#civtest.assertErrorPat">civtest.assertErrorPat</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L119"><i>src</i></a>)</h3>
<h3>Function <a id="civtest.assertMatch" href="#civtest.assertMatch">civtest.assertMatch</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L126"><i>src</i></a>)</h3>
<h3>Function <a id="civtest.asyncTest" href="#civtest.asyncTest">civtest.asyncTest</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L143"><i>src</i></a>)</h3>
Runs until yields non-truthy. See lib/lap/README.md
<h3>Function <a id="civtest.lapTest" href="#civtest.lapTest">civtest.lapTest</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L148"><i>src</i></a>)</h3>
<h3>Function <a id="civtest.test" href="#civtest.test">civtest.test</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civtest/civtest.lua#L132"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_ds" href="#Package_ds">Package ds</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Tiny data structures and algorithms</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-12</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_ds">https://lua.civboot.org#Package_ds</a></td>
</tr>
</table>
<b>ds</b>: absurdly necessary data structures and algorithms
<p>
ds is a small-ish lua library which fills many of the data structure and method
gaps (needed "batteries") in Lua's standard library. It's only dependency is
<a href="https://github.com/civboot/civlua/blob/main/lib/metaty">lib/metaty</a> which it uses for defining it's records and <a href="https://github.com/civboot/civlua/blob/main/lib/fmt">lib/fmt</a> which it
uses to define the logging interface.
<p>
<h3>none: "set but none" vs nil's simply "unset"</h3>
In Lua <code>nil</code> always means "unset". Certain APIs (like JSON) might distinguish
between unset vs null/empty/none. For such APIs <code>none</code> can be used to mean "set
as none" instead of simply "unset" (which is what <code>nil</code> means).
<p>
<code>none</code> overrides <code>__metatable='none'</code> so that <code>getmetatable(none)=='none'</code> and
<code>metaty.ty(none) == 'none'</code>.
<p>
<blockquote>WARNING: <code>assert(none)</code> will pass.  Use <code>ds.bool</code> to make <code>none</code> falsy.</blockquote>
<p>
<h3>path</h3>
<code>ds.path</code> has some functions for working with paths.
<p>
It interacts (but does not set) the <b>globals</b> <code>CWD</code> and <code>HOME</code> to get the
"current working directory" and "home directory", respectively.
<p>
<p>
<h2>Module <a id="ds" href="#ds">ds</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L3"><i>src</i></a>)</h2>
<p>
<h3>Table <a id="ds.CONCRETE_TYPES" href="#ds.CONCRETE_TYPES">ds.CONCRETE_TYPES</a></h3>
<h3>Table <a id="ds.DURATION_ZERO" href="#ds.DURATION_ZERO">ds.DURATION_ZERO</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L785"><i>src</i></a>)</h3>
<h3>Table <a id="ds.IGNORE_TRACE" href="#ds.IGNORE_TRACE">ds.IGNORE_TRACE</a></h3>
<h3>Table <a id="ds.R" href="#ds.R">ds.R</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1135"><i>src</i></a>)</h3>
indexrequire: <code>R.foo</code> is same as <code>require'foo'</code>
This is mostly used in scripts/etc<code class="block">M.R = setmetatable({}, {
  __index=function(_, k) return require(k) end,
  __newindex=function() error"don't set fields" end,
})</code>
<h4>Value <a id="ds.SKIP" href="#ds.SKIP">ds.SKIP</a></h4>
<h4>Value <a id="ds.__name" href="#ds.__name">ds.__name</a></h4>
<h3>Table <a id="ds.empty" href="#ds.empty">ds.empty</a></h3>
<h3>Table <a id="ds.none" href="#ds.none">ds.none</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L696"><i>src</i></a>)</h3>
none: "set as none" vs nil aka "unset"
<p>
none is a sentinel value. Use it in APIs where there is an
"unset but none" such as JSON's "null".
<h3>Record <a id="ds.BiMap" href="#ds.BiMap">ds.BiMap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L961"><i>src</i></a>)</h3>
Bidirectional Map.
Maps both <code>key -&gt; value</code> and <code>value -&gt; key</code>.
Must use <code>:remove</code> (instead of <code>bm[k] = nil</code> to handle deletions.
<p>
Note that <code>pairs()</code> will return BOTH directions (in an unspecified order)
<p>
<h3>Table <a id="ds.BiMap.__docs" href="#ds.BiMap.__docs">ds.BiMap.__docs</a></h3>
<h3>Table <a id="ds.BiMap.__fieldIds" href="#ds.BiMap.__fieldIds">ds.BiMap.__fieldIds</a></h3>
<h4>Value <a id="ds.BiMap.__name" href="#ds.BiMap.__name">ds.BiMap.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.BiMap.__index</code></td>
<td>[Ty<BiMap>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L961">src</a>)</td>
</tr>
</table>
<h4>Function <a id="BiMap.remove" href="#BiMap.remove">BiMap.remove</a><code>(t, k) -&gt; v</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L976"><i>src</i></a>)</h4>
<h3>Record <a id="ds.Checked" href="#ds.Checked">ds.Checked</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L639"><i>src</i></a>)</h3>
Table that errors on missing key
<p>
<h4>Value <a id="ds.Checked.__metatable" href="#ds.Checked.__metatable">ds.Checked.__metatable</a></h4>
<h4>Value <a id="ds.Checked.__name" href="#ds.Checked.__name">ds.Checked.__name</a></h4>
<h3>Record <a id="ds.Deq" href="#ds.Deq">ds.Deq</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L992"><i>src</i></a>)</h3>
<code>Deq() -&gt; Deq</code>, a deque
Use as a first in/out with <code>deq:push(v)/deq()</code>
<p>
Main methods: <code class="block">  pushLeft()  pushRight()
  popLeft()   popRight()</code>
Calling it is the same as popLeft (use as iterator)
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.Deq.right</code></td>
<td>[number] </td>
</tr>
<tr>
<td><code>ds.Deq.left</code></td>
<td>[number] </td>
</tr>
</table>
<h3>Table <a id="ds.Deq.__docs" href="#ds.Deq.__docs">ds.Deq.__docs</a></h3>
<h3>Table <a id="ds.Deq.__fieldIds" href="#ds.Deq.__fieldIds">ds.Deq.__fieldIds</a></h3>
<h3>Table <a id="ds.Deq.__fields" href="#ds.Deq.__fields">ds.Deq.__fields</a></h3>
<h4>Value <a id="ds.Deq.__name" href="#ds.Deq.__name">ds.Deq.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Deq.__index</code></td>
<td>[Ty<Deq>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L992">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.Deq.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>ds.Deq.pop</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1018">src</a>)</td>
</tr>
<tr>
<td><code>ds.Deq.popLeft</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1018">src</a>)</td>
</tr>
<tr>
<td><code>ds.Deq.pushRight</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L998">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Deq.popLeft" href="#Deq.popLeft">Deq.popLeft</a><code>(deq) -&gt; v</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1018"><i>src</i></a>)</h4>
<h4>Function <a id="Deq.__len" href="#Deq.__len">Deq.__len</a><code>(d) -&gt; #d</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1025"><i>src</i></a>)</h4>
<h4>Function <a id="Deq.clear" href="#Deq.clear">Deq.clear</a><code>(deq) -&gt; nil: clear deq</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1031"><i>src</i></a>)</h4>
<h4>Function <a id="Deq.drain" href="#Deq.drain">Deq.drain</a><code>(deq) -&gt; table: get all items and clear deq</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1035"><i>src</i></a>)</h4>
<h4>Function <a id="Deq.extendLeft" href="#Deq.extendLeft">Deq.extendLeft</a><code>(deq, vals) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1013"><i>src</i></a>)</h4>
extend deq to left (<code>vals[1]</code> is left-most)
<h4>Function <a id="Deq.extendRight" href="#Deq.extendRight">Deq.extendRight</a><code>(deq, vals) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1004"><i>src</i></a>)</h4>
extend deq to right
<h4>Function <a id="Deq.popRight" href="#Deq.popRight">Deq.popRight</a><code>(deq) -&gt; v</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1023"><i>src</i></a>)</h4>
<h4>Function <a id="Deq.pushRight" href="#Deq.pushRight">Deq.pushRight</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L998"><i>src</i></a>)</h4>
<h4>Function <a id="Deq.pushLeft" href="#Deq.pushLeft">Deq.pushLeft</a><code>(deq, val) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1007"><i>src</i></a>)</h4>
<h3>Record <a id="ds.Duration" href="#ds.Duration">ds.Duration</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L761"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.Duration.s</code></td>
<td>[int] 
seconds</td>
</tr>
<tr>
<td><code>ds.Duration.ns</code></td>
<td>[int] 
nanoseconds</td>
</tr>
</table>
<h4>Value <a id="ds.Duration.NANO" href="#ds.Duration.NANO">ds.Duration.NANO</a></h4>
<h3>Table <a id="ds.Duration.__docs" href="#ds.Duration.__docs">ds.Duration.__docs</a></h3>
<h3>Table <a id="ds.Duration.__fieldIds" href="#ds.Duration.__fieldIds">ds.Duration.__fieldIds</a></h3>
<h3>Table <a id="ds.Duration.__fields" href="#ds.Duration.__fields">ds.Duration.__fields</a></h3>
<h4>Value <a id="ds.Duration.__name" href="#ds.Duration.__name">ds.Duration.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Duration.__index</code></td>
<td>[Ty<Duration>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L761">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.Duration.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Duration.__add" href="#Duration.__add">Duration.__add</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L777"><i>src</i></a>)</h4>
<h4>Function <a id="Duration.__lt" href="#Duration.__lt">Duration.__lt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L781"><i>src</i></a>)</h4>
<h4>Function <a id="Duration.__sub" href="#Duration.__sub">Duration.__sub</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L772"><i>src</i></a>)</h4>
<h4>Function <a id="Duration.__tostring" href="#Duration.__tostring">Duration.__tostring</a><code>(self) -&gt; self:asSeconds() .. 's'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L783"><i>src</i></a>)</h4>
<h4>Function <a id="Duration.asSeconds" href="#Duration.asSeconds">Duration.asSeconds</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L767"><i>src</i></a>)</h4>
<h4>Function <a id="Duration.fromMs" href="#Duration.fromMs">Duration.fromMs</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L766"><i>src</i></a>)</h4>
<h4>Function <a id="Duration.fromSeconds" href="#Duration.fromSeconds">Duration.fromSeconds</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L765"><i>src</i></a>)</h4>
<h3>Record <a id="ds.Epoch" href="#ds.Epoch">ds.Epoch</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L791"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.Epoch.s</code></td>
<td>[int] 
seconds</td>
</tr>
<tr>
<td><code>ds.Epoch.ns</code></td>
<td>[int] 
nanoseconds</td>
</tr>
</table>
<h3>Table <a id="ds.Epoch.__docs" href="#ds.Epoch.__docs">ds.Epoch.__docs</a></h3>
<h3>Table <a id="ds.Epoch.__fieldIds" href="#ds.Epoch.__fieldIds">ds.Epoch.__fieldIds</a></h3>
<h3>Table <a id="ds.Epoch.__fields" href="#ds.Epoch.__fields">ds.Epoch.__fields</a></h3>
<h4>Value <a id="ds.Epoch.__name" href="#ds.Epoch.__name">ds.Epoch.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Epoch.__index</code></td>
<td>[Ty<Epoch>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L791">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.Epoch.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>ds.Epoch.asSeconds</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L767">src</a>)</td>
</tr>
<tr>
<td><code>ds.Epoch.fromSeconds</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L765">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Epoch.__lt" href="#Epoch.__lt">Epoch.__lt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L807"><i>src</i></a>)</h4>
<h4>Function <a id="Epoch.__sub" href="#Epoch.__sub">Epoch.__sub</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L803"><i>src</i></a>)</h4>
<h4>Function <a id="Epoch.__tostring" href="#Epoch.__tostring">Epoch.__tostring</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L811"><i>src</i></a>)</h4>
<h3>Record <a id="ds.Error" href="#ds.Error">ds.Error</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1063"><i>src</i></a>)</h3>
Error message, traceback and cause
NOTE: you should only use this for printing/logging/etc.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.Error.msg</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>ds.Error.traceback</code></td>
<td>[table] </td>
</tr>
<tr>
<td><code>ds.Error.cause</code></td>
<td>[Error] </td>
</tr>
</table>
<h3>Table <a id="ds.Error.__docs" href="#ds.Error.__docs">ds.Error.__docs</a></h3>
<h3>Table <a id="ds.Error.__fieldIds" href="#ds.Error.__fieldIds">ds.Error.__fieldIds</a></h3>
<h3>Table <a id="ds.Error.__fields" href="#ds.Error.__fields">ds.Error.__fields</a></h3>
<h4>Value <a id="ds.Error.__name" href="#ds.Error.__name">ds.Error.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Error.__index</code></td>
<td>[Ty<Error>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1063">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.Error.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Error.__fmt" href="#Error.__fmt">Error.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1076"><i>src</i></a>)</h4>
<h4>Function <a id="Error.__tostring" href="#Error.__tostring">Error.__tostring</a><code>(e) -&gt; fmt(e)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1077"><i>src</i></a>)</h4>
<h4>Function <a id="Error.from" href="#Error.from">Error.from</a><code>(msg, tb, cause) -&gt; Error</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1088"><i>src</i></a>)</h4>
create the error from the arguments.
tb can be one of: <code>coroutine|string|table</code>
<h4>Function <a id="Error.msgh" href="#Error.msgh">Error.msgh</a><code>(msg, level) -&gt; Error</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1093"><i>src</i></a>)</h4>
for use with xpcall. See: try
<h3>Record <a id="ds.Forget" href="#ds.Forget">ds.Forget</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L631"><i>src</i></a>)</h3>
Table that ignores new indexes. Used to disable caching in tests.
<p>
<h4>Value <a id="ds.Forget.__name" href="#ds.Forget.__name">ds.Forget.__name</a></h4>
<h4>Function <a id="ds.noop" href="#ds.noop">ds.noop</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L87"><i>src</i></a>)</h4>
<h3>Record <a id="ds.Imm" href="#ds.Imm">ds.Imm</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L710"><i>src</i></a>)</h3>
Immutable table
<p>
<b>Values: </b> <table>
<tr>
<td><code>ds.Imm.__metatable</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="ds.Imm.__docs" href="#ds.Imm.__docs">ds.Imm.__docs</a></h3>
<h3>Table <a id="ds.Imm.__fieldIds" href="#ds.Imm.__fieldIds">ds.Imm.__fieldIds</a></h3>
<h3>Table <a id="ds.Imm.__fields" href="#ds.Imm.__fields">ds.Imm.__fields</a></h3>
<h4>Value <a id="ds.Imm.__name" href="#ds.Imm.__name">ds.Imm.__name</a></h4>
<h4>Function <a id="Imm.__len" href="#Imm.__len">Imm.__len</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L723"><i>src</i></a>)</h4>
<h4>Function <a id="Imm.__pairs" href="#Imm.__pairs">Imm.__pairs</a><code>(t) -&gt; next, rawget(t, IMM_DATA) or t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L720"><i>src</i></a>)</h4>
<h3>Record <a id="ds.PlainStyler" href="#ds.PlainStyler">ds.PlainStyler</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L22"><i>src</i></a>)</h3>
<p>
<h3>Table <a id="ds.PlainStyler.__docs" href="#ds.PlainStyler.__docs">ds.PlainStyler.__docs</a></h3>
<h3>Table <a id="ds.PlainStyler.__fieldIds" href="#ds.PlainStyler.__fieldIds">ds.PlainStyler.__fieldIds</a></h3>
<h3>Table <a id="ds.PlainStyler.__fields" href="#ds.PlainStyler.__fields">ds.PlainStyler.__fields</a></h3>
<h4>Value <a id="ds.PlainStyler.__name" href="#ds.PlainStyler.__name">ds.PlainStyler.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.PlainStyler.__index</code></td>
<td>[Ty<PlainStyler>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L22">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.PlainStyler.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Record <a id="ds.Set" href="#ds.Set">ds.Set</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L815"><i>src</i></a>)</h3>
<p>
<h3>Table <a id="ds.Set.__docs" href="#ds.Set.__docs">ds.Set.__docs</a></h3>
<h3>Table <a id="ds.Set.__fieldIds" href="#ds.Set.__fieldIds">ds.Set.__fieldIds</a></h3>
<h3>Table <a id="ds.Set.__fields" href="#ds.Set.__fields">ds.Set.__fields</a></h3>
<h4>Value <a id="ds.Set.__name" href="#ds.Set.__name">ds.Set.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Set.__index</code></td>
<td>[Ty<Set>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L815">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Set.__eq" href="#Set.__eq">Set.__eq</a><code>(self, t) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L848"><i>src</i></a>)</h4>
<h4>Function <a id="Set.__fmt" href="#Set.__fmt">Set.__fmt</a><code>(self, f) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L835"><i>src</i></a>)</h4>
<h4>Function <a id="Set.diff" href="#Set.diff">Set.diff</a><code>(self, s) -&gt; Set</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L861"><i>src</i></a>)</h4>
items in self but not in s
<h4>Function <a id="Set.union" href="#Set.union">Set.union</a><code>(self, s) -&gt; Set</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L854"><i>src</i></a>)</h4>
<h3>Record <a id="ds.Slc" href="#ds.Slc">ds.Slc</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L648"><i>src</i></a>)</h3>
A slice of anything with start and end indexes.
<blockquote>Note: This object does not hold a reference to the object being
sliced.</blockquote>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.Slc.si</code></td>
<td>[int] 
start index</td>
</tr>
<tr>
<td><code>ds.Slc.ei</code></td>
<td>[int] 
end index</td>
</tr>
</table>
<h3>Table <a id="ds.Slc.__docs" href="#ds.Slc.__docs">ds.Slc.__docs</a></h3>
<h3>Table <a id="ds.Slc.__fieldIds" href="#ds.Slc.__fieldIds">ds.Slc.__fieldIds</a></h3>
<h3>Table <a id="ds.Slc.__fields" href="#ds.Slc.__fields">ds.Slc.__fields</a></h3>
<h4>Value <a id="ds.Slc.__name" href="#ds.Slc.__name">ds.Slc.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Slc.__index</code></td>
<td>[Ty<Slc>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L648">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.Slc.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Slc.__len" href="#Slc.__len">Slc.__len</a><code>(s) -&gt; #s</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L650"><i>src</i></a>)</h4>
<h4>Function <a id="Slc.__tostring" href="#Slc.__tostring">Slc.__tostring</a><code>(s) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L661"><i>src</i></a>)</h4>
<h4>Function <a id="Slc.merge" href="#Slc.merge">Slc.merge</a><code>(a, b) -&gt; first, second?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L657"><i>src</i></a>)</h4>
return either a single (new) merged or two sorted Slcs.
<h3>Record <a id="ds.TypoSafe" href="#ds.TypoSafe">ds.TypoSafe</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L521"><i>src</i></a>)</h3>
A typo-safe table, typically used in libraries for storing constants.
<p>
Adding keys is always allowed but getting non-existant keys is an error.
<p>
<h3>Table <a id="ds.TypoSafe.__docs" href="#ds.TypoSafe.__docs">ds.TypoSafe.__docs</a></h3>
<h3>Table <a id="ds.TypoSafe.__fieldIds" href="#ds.TypoSafe.__fieldIds">ds.TypoSafe.__fieldIds</a></h3>
<h3>Table <a id="ds.TypoSafe.__fields" href="#ds.TypoSafe.__fields">ds.TypoSafe.__fields</a></h3>
<h4>Value <a id="ds.TypoSafe.__name" href="#ds.TypoSafe.__name">ds.TypoSafe.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.TypoSafe.__index</code></td>
<td>[Ty<TypoSafe>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L521">src</a>)</td>
</tr>
</table>
<h3>Record <a id="ds.WeakK" href="#ds.WeakK">ds.WeakK</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L613"><i>src</i></a>)</h3>
Weak key table, see docs on <code>__mode</code>
<p>
<h4>Value <a id="ds.WeakK.__mode" href="#ds.WeakK.__mode">ds.WeakK.__mode</a></h4>
<h4>Value <a id="ds.WeakK.__name" href="#ds.WeakK.__name">ds.WeakK.__name</a></h4>
<h3>Record <a id="ds.WeakKV" href="#ds.WeakKV">ds.WeakKV</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L625"><i>src</i></a>)</h3>
Weak key+value table, see docs on <code>__mode</code>
<p>
<h4>Value <a id="ds.WeakKV.__mode" href="#ds.WeakKV.__mode">ds.WeakKV.__mode</a></h4>
<h4>Value <a id="ds.WeakKV.__name" href="#ds.WeakKV.__name">ds.WeakKV.__name</a></h4>
<h3>Record <a id="ds.WeakV" href="#ds.WeakV">ds.WeakV</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L619"><i>src</i></a>)</h3>
Weak value table, see docs on <code>__mode</code>
<p>
<h4>Value <a id="ds.WeakV.__mode" href="#ds.WeakV.__mode">ds.WeakV.__mode</a></h4>
<h4>Value <a id="ds.WeakV.__name" href="#ds.WeakV.__name">ds.WeakV.__name</a></h4>
<b>Functions: </b> <table>
<tr>
<td><code>ds.noop</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L87">src</a>)</td>
</tr>
<tr>
<td><code>ds.split</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L138">src</a>)</td>
</tr>
</table>
<h3>Function <a id="ds.add" href="#ds.add">ds.add</a><code>(t, ...) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L349"><i>src</i></a>)</h3>
<h3>Function <a id="ds.auto" href="#ds.auto">ds.auto</a><code>(mod, i) -&gt; (mod, i)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1128"><i>src</i></a>)</h3>
auto-set nil locals using require(mod)
<code>local x, y, z; ds.auto'mm' -- sets x=mm.x; y=mm.y; z=mm.z</code>
<h3>Function <a id="ds.binarySearch" href="#ds.binarySearch">ds.binarySearch</a><code>(t, v, cmp, si--[[1]], ei--[[#t]]) -&gt; index</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L884"><i>src</i></a>)</h3>
Search the sorted table, return i such that: <ul>
<li><code>cmp(t[i], v)</code> returns true  for indexes <= i</li>
<li><code>cmp(t[i], v)</code> returns false for indexes >  i</li>
</ul>
If you want a value perfectly equal then check equality
on the resulting index.
<h3>Function <a id="ds.bool" href="#ds.bool">ds.bool</a><code>(v) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L701"><i>src</i></a>)</h3>
convert to boolean (none aware)
<h3>Function <a id="ds.bound" href="#ds.bound">ds.bound</a><code>(v, min, max) -&gt; value within [min,max]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L127"><i>src</i></a>)</h3>
<h3>Function <a id="ds.clear" href="#ds.clear">ds.clear</a><code>(t, si, len) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L343"><i>src</i></a>)</h3>
<h3>Function <a id="ds.copy" href="#ds.copy">ds.copy</a><code>(t, update) -&gt; new t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L539"><i>src</i></a>)</h3>
Copy and update full table
<h3>Function <a id="ds.coroutineErrorMessage" href="#ds.coroutineErrorMessage">ds.coroutineErrorMessage</a><code>(cor, err) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L113"><i>src</i></a>)</h3>
<h3>Function <a id="ds.decAbs" href="#ds.decAbs">ds.decAbs</a><code>(v) -&gt; number</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L140"><i>src</i></a>)</h3>
<h3>Function <a id="ds.deepcopy" href="#ds.deepcopy">ds.deepcopy</a><code>(t) -&gt; table</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L547"><i>src</i></a>)</h3>
<h3>Function <a id="ds.dotpath" href="#ds.dotpath">ds.dotpath</a><code>(dots) -&gt; list split by '.'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L438"><i>src</i></a>)</h3>
used with ds.get and ds.set. Example <code class="block">  local dp = require'ds'.dotpath
  ds.get(t, dp'a.b.c')</code>
<h3>Function <a id="ds.drain" href="#ds.drain">ds.drain</a><code>(t, len--[[#t]]) -&gt; table</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L403"><i>src</i></a>)</h3>
return len items from the end of <code>t</code>, removing them from <code>t</code>
<h3>Function <a id="ds.emptyTable" href="#ds.emptyTable">ds.emptyTable</a><code>() -&gt; {}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L414"><i>src</i></a>)</h3>
<h3>Function <a id="ds.eq" href="#ds.eq">ds.eq</a><code>(a, b) -&gt; a == b</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L93"><i>src</i></a>)</h3>
<h3>Function <a id="ds.eval" href="#ds.eval">ds.eval</a><code>(chunk, env, name) -&gt; (ok, ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L604"><i>src</i></a>)</h3>
evaluate lua code
<h3>Function <a id="ds.extend" href="#ds.extend">ds.extend</a><code>(t, l) -&gt; t: move vals to end of t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L336"><i>src</i></a>)</h3>
<h3>Function <a id="ds.fdMv" href="#ds.fdMv">ds.fdMv</a><code>(fdTo, fdFrom) -&gt; (fdTo, fdFrom)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L578"><i>src</i></a>)</h3>
Read data from fdFrom and write to fdTo, then flush.
<blockquote> memonic: fdTo = fdFrom</blockquote>
<h3>Function <a id="ds.fileWithText" href="#ds.fileWithText">ds.fileWithText</a><code>(path, text, mode) -&gt; file</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L568"><i>src</i></a>)</h3>
<h3>Function <a id="ds.find" href="#ds.find">ds.find</a><code>(subj, pats, si, plain) -&gt; (ms, me, pi, pat)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L176"><i>src</i></a>)</h3>
find any of a list of patterns. Return the match <code>start, end</code> as well as
the <code>index, pat</code> of the pattern matched.
<h3>Function <a id="ds.flatten" href="#ds.flatten">ds.flatten</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L363"><i>src</i></a>)</h3>
return new list which contains all elements inserted in order
<h3>Function <a id="ds.get" href="#ds.get">ds.get</a><code>(t, path) -&gt; value? at path</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L451"><i>src</i></a>)</h3>
get the value at the path or nil if the value or any
intermediate table is missing.
<code class="block">  get(t, {'a', 2, 'c'})  -&gt; t.a?[2]?.c?
  get(t, dotpath'a.b.c') -&gt; t.a?.b?.c?</code>
<h3>Function <a id="ds.getOrSet" href="#ds.getOrSet">ds.getOrSet</a><code>(t, k, newFn) -&gt; t[k] or newFn()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L409"><i>src</i></a>)</h3>
<h3>Function <a id="ds.geti" href="#ds.geti">ds.geti</a><code>(t, i) -&gt; t[i]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L261"><i>src</i></a>)</h3>
get index, handling negatives
<h3>Function <a id="ds.gt" href="#ds.gt">ds.gt</a><code>(a, b) -&gt; a &gt; b</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L122"><i>src</i></a>)</h3>
<h3>Function <a id="ds.icopy" href="#ds.icopy">ds.icopy</a><code>(t) -&gt; list</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L531"><i>src</i></a>)</h3>
Copy list-elements only
<h3>Function <a id="ds.iden" href="#ds.iden">ds.iden</a><code>(...) -&gt; ...</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L89"><i>src</i></a>)</h3>
<h3>Function <a id="ds.ilast" href="#ds.ilast">ds.ilast</a><code>(t, starti, endi) -&gt; iter[starti:endi]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L322"><i>src</i></a>)</h3>
iend(t, starti, endi=-1): get islice from the end.
starti and endi must be negative.
<p>
Example: <code>iend({1, 2, 3, 4, 5}, -3, -2) -&gt; 3, 4</code>
<h3>Function <a id="ds.indexOf" href="#ds.indexOf">ds.indexOf</a><code>(t, find) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L477"><i>src</i></a>)</h3>
<h3>Function <a id="ds.indexOfPat" href="#ds.indexOfPat">ds.indexOfPat</a><code>(strs, pat) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L481"><i>src</i></a>)</h3>
<h3>Function <a id="ds.inext" href="#ds.inext">ds.inext</a><code>(t, i) -&gt; (i+1, v)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L283"><i>src</i></a>)</h3>
next(t, key) but with indexes
<h3>Function <a id="ds.inset" href="#ds.inset">ds.inset</a><code>(t, i, values, rmlen) -&gt; removed?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L53"><i>src</i></a>)</h3>
insert values into list at i.
Uses <code>__inset</code> metamethod if available.
rmlen, if provided, will cause <code>t[i:i+rmlen]</code> to be removed first
<h3>Function <a id="ds.iprev" href="#ds.iprev">ds.iprev</a><code>(t, i) -&gt; (i-1, v)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L289"><i>src</i></a>)</h3>
inext but reversed.
<h3>Function <a id="ds.ireverse" href="#ds.ireverse">ds.ireverse</a><code>(t) -&gt; iter</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L292"><i>src</i></a>)</h3>
ipairs reversed
<h3>Function <a id="ds.isEmpty" href="#ds.isEmpty">ds.isEmpty</a><code>(t) -&gt; t == nil or next(t) == nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L240"><i>src</i></a>)</h3>
<h3>Function <a id="ds.isEven" href="#ds.isEven">ds.isEven</a><code>(a) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L135"><i>src</i></a>)</h3>
<h3>Function <a id="ds.isOdd" href="#ds.isOdd">ds.isOdd</a><code>(a) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L136"><i>src</i></a>)</h3>
<h3>Function <a id="ds.isPod" href="#ds.isPod">ds.isPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L81"><i>src</i></a>)</h3>
<h3>Function <a id="ds.isWithin" href="#ds.isWithin">ds.isWithin</a><code>(v, min, max) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L120"><i>src</i></a>)</h3>
<h3>Function <a id="ds.islice" href="#ds.islice">ds.islice</a><code>(t, starti, endi) -&gt; iter[starti:endi]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L307"><i>src</i></a>)</h3>
<h3>Function <a id="ds.islower" href="#ds.islower">ds.islower</a><code>(c) -&gt; string?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L161"><i>src</i></a>)</h3>
return the string if it is only lowercase letters
<h3>Function <a id="ds.isupper" href="#ds.isupper">ds.isupper</a><code>(c) -&gt; string?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L158"><i>src</i></a>)</h3>
return the string if it is only uppercase letters
<h3>Function <a id="ds.keys" href="#ds.keys">ds.keys</a><code>(t) -&gt; list</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L280"><i>src</i></a>)</h3>
<h3>Function <a id="ds.last" href="#ds.last">ds.last</a><code>(t) -&gt; t[#t]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L262"><i>src</i></a>)</h3>
<h3>Function <a id="ds.lineschunk" href="#ds.lineschunk">ds.lineschunk</a><code>(dat) -&gt; iter()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L592"><i>src</i></a>)</h3>
convert lines-like table into chunk for eval
<h3>Function <a id="ds.lt" href="#ds.lt">ds.lt</a><code>(a, b) -&gt; a &lt; b</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L121"><i>src</i></a>)</h3>
<h3>Function <a id="ds.lte" href="#ds.lte">ds.lte</a><code>(a, b) -&gt; a &lt;= b</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L123"><i>src</i></a>)</h3>
<h3>Function <a id="ds.merge" href="#ds.merge">ds.merge</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L393"><i>src</i></a>)</h3>
recursively update t with add. This will call update on inner tables as
well.
<blockquote>Note: treats list indexes as normal keys (does not append)</blockquote>
<h3>Function <a id="ds.name" href="#ds.name">ds.name</a><code>(t) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L32"><i>src</i></a>)</h3>
if t is a table returns t.__name or '?'
<h3>Function <a id="ds.newTable" href="#ds.newTable">ds.newTable</a><code>() -&gt; {}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L92"><i>src</i></a>)</h3>
<h3>Function <a id="ds.nosupport" href="#ds.nosupport">ds.nosupport</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L88"><i>src</i></a>)</h3>
<h3>Function <a id="ds.only" href="#ds.only">ds.only</a><code>(t) -&gt; t[1]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L268"><i>src</i></a>)</h3>
get the first (and assert only) element of the list
<h3>Function <a id="ds.orderedKeys" href="#ds.orderedKeys">ds.orderedKeys</a><code>(t, cmpFn) -&gt; keys</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L373"><i>src</i></a>)</h3>
<h3>Function <a id="ds.pairlen" href="#ds.pairlen">ds.pairlen</a><code>(t) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L252"><i>src</i></a>)</h3>
the full length of all pairs
<blockquote>WARNING: very slow, requires iterating the whole table</blockquote>
<h3>Function <a id="ds.popit" href="#ds.popit">ds.popit</a><code>(t, i) -&gt; t[i] and length of t is reduced by 1</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L491"><i>src</i></a>)</h3>
popit (aka pop-index-top) will return the value at <code>t[i]</code>, replacing it
with the value at the end (aka top) of the list.
<p>
if <code>i &gt; #t</code> returns nil and doesn't affect the size of the list.
<h3>Function <a id="ds.popk" href="#ds.popk">ds.popk</a><code>(t, key) -&gt; t[k]: pop key</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L397"><i>src</i></a>)</h3>
<h3>Function <a id="ds.pushSortedKeys" href="#ds.pushSortedKeys">ds.pushSortedKeys</a><code>(t, cmpFn) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L380"><i>src</i></a>)</h3>
adds all <code>key=index</code> to the table so the keys can
be iterated using <code>for _, k in ipairs(t)</code>
<h3>Function <a id="ds.pushfmt" href="#ds.pushfmt">ds.pushfmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L245"><i>src</i></a>)</h3>
push the <code>fmt:format(...)</code> to the table
<p>
Example: <code>pushfmt(t, 'a=%s b=%s', a, b)</code>
<h3>Function <a id="ds.rawget" href="#ds.rawget">ds.rawget</a><code>(t, path) -&gt; value? at path</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L459"><i>src</i></a>)</h3>
same as ds.get but uses <code>rawget</code>
<h3>Function <a id="ds.rawislice" href="#ds.rawislice">ds.rawislice</a><code>(state, i) -&gt; (i+1, v)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L297"><i>src</i></a>)</h3>
<h3>Function <a id="ds.readPath" href="#ds.readPath">ds.readPath</a><code>(path) -&gt; ok</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L555"><i>src</i></a>)</h3>
<h3>Function <a id="ds.replace" href="#ds.replace">ds.replace</a><code>(t, r) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L353"><i>src</i></a>)</h3>
<h3>Function <a id="ds.repr" href="#ds.repr">ds.repr</a><code>(v) -&gt; sfmt('%q', v)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L131"><i>src</i></a>)</h3>
<h3>Function <a id="ds.resource" href="#ds.resource">ds.resource</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1142"><i>src</i></a>)</h3>
Include a resource (raw data) relative to the current file.
<p>
Example: <code>M.myData = ds.resource'data/myData.csv'</code>
<h3>Function <a id="ds.resume" href="#ds.resume">ds.resume</a><code>(th) -&gt; (ok, err, b, c)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1109"><i>src</i></a>)</h3>
Same as coroutine.resume except uses a ds.Error object for errors
(has traceback)
<h3>Function <a id="ds.retFalse" href="#ds.retFalse">ds.retFalse</a><code>() -&gt; false</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L91"><i>src</i></a>)</h3>
<h3>Function <a id="ds.retTrue" href="#ds.retTrue">ds.retTrue</a><code>() -&gt; true</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L90"><i>src</i></a>)</h3>
<h3>Function <a id="ds.reverse" href="#ds.reverse">ds.reverse</a><code>(t) -&gt; t (reversed)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L330"><i>src</i></a>)</h3>
reverse a list-like table in-place
<h3>Function <a id="ds.rmleft" href="#ds.rmleft">ds.rmleft</a><code>(t, rm, eq--[[ds.eq]]) -&gt; t (mutated)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L429"><i>src</i></a>)</h3>
remove (mutate) the left side of the table (list).
noop if rm is not exactly equal to the left side.
<h3>Function <a id="ds.sentinel" href="#ds.sentinel">ds.sentinel</a><code>(name, mt) -&gt; NewType</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L690"><i>src</i></a>)</h3>
<code>sentinel(name, metatable)</code>
Use to create a "sentinel type". Return the (singular) instance.
<p>
Sentinels are "single values" commonly used for things like: none, empty, EOF, etc.
They have most metatable methods disallowed and are immutable down. Methods can
only be set by the provided metatable value.
<h3>Function <a id="ds.set" href="#ds.set">ds.set</a><code>(d, path, value, newFn) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L471"><i>src</i></a>)</h3>
set the value at path using newFn (default=ds.newTable) to create
missing intermediate tables.
<code class="block">set(t, dotpath'a.b.c', 2) -- t.a?.b?.c = 2</code>
<h3>Function <a id="ds.setIfNil" href="#ds.setIfNil">ds.setIfNil</a><code>(t, k, v) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L413"><i>src</i></a>)</h3>
<h3>Function <a id="ds.shortloc" href="#ds.shortloc">ds.shortloc</a><code>(level) -&gt; "dir/file.lua:10"</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L104"><i>src</i></a>)</h3>
<h3>Function <a id="ds.simplestr" href="#ds.simplestr">ds.simplestr</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L236"><i>src</i></a>)</h3>
A way to declare simpler mulitline strings which: <ul>
<li>ignores the first/last newline if empty</li>
<li>removes leading whitespace equal to the first
line (or second line if first line has no indent)</li>
</ul>
Example: <code class="block">local s = require'ds'.simplestr
local mystr = s[[
  this is
    a string.
]]
assertEq('this is\n  a string.', mystr)</code>
<h3>Function <a id="ds.slice" href="#ds.slice">ds.slice</a><code>(t, starti, endi) -&gt; list[starti:endi]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L313"><i>src</i></a>)</h3>
<h3>Function <a id="ds.sort" href="#ds.sort">ds.sort</a><code>(t, fn) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L256"><i>src</i></a>)</h3>
sort table and return it.
Eventually this may use the <code>__sort</code> metamethod
<h3>Function <a id="ds.sort2" href="#ds.sort2">ds.sort2</a><code>(a, b) -&gt; (small, large)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L130"><i>src</i></a>)</h3>
<h3>Function <a id="ds.splitList" href="#ds.splitList">ds.splitList</a><code>(...) -&gt; list</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L183"><i>src</i></a>)</h3>
<h3>Function <a id="ds.squash" href="#ds.squash">ds.squash</a><code>(s, repl) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L192"><i>src</i></a>)</h3>
Squash a string: convert all whitespace to repl (default=' ').
<h3>Function <a id="ds.srcdir" href="#ds.srcdir">ds.srcdir</a><code>(level) -&gt; "/path/to/dir/"</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L107"><i>src</i></a>)</h3>
<h3>Function <a id="ds.srcloc" href="#ds.srcloc">ds.srcloc</a><code>(level) -&gt; "/path/to/dir/file.lua:10"</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L99"><i>src</i></a>)</h3>
<h3>Function <a id="ds.traceback" href="#ds.traceback">ds.traceback</a><code>(level) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1057"><i>src</i></a>)</h3>
<h3>Function <a id="ds.tracelist" href="#ds.tracelist">ds.tracelist</a><code>(tbstr, level) -&gt; {traceback}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1054"><i>src</i></a>)</h3>
convert the string traceback into a list
<h3>Function <a id="ds.trim" href="#ds.trim">ds.trim</a><code>(subj, pat, index) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L166"><i>src</i></a>)</h3>
<h3>Function <a id="ds.trimEnd" href="#ds.trimEnd">ds.trimEnd</a><code>(subj, pat, index) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L189"><i>src</i></a>)</h3>
trim the end of the string by removing pat (default='%s')
<h3>Function <a id="ds.try" href="#ds.try">ds.try</a><code>(fn, ...) -&gt; (ok, ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L1101"><i>src</i></a>)</h3>
try to run the fn. Similar to pcall. Return one of: <ul>
<li>successs: <code>(true, ...)</code></li>
<li>failure: <code>(false, ds.Error{...})</code></li>
</ul>
<h3>Function <a id="ds.update" href="#ds.update">ds.update</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L357"><i>src</i></a>)</h3>
return t with the key/vals of add inserted
<h3>Function <a id="ds.updateKeys" href="#ds.updateKeys">ds.updateKeys</a><code>(t, add, keys) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L368"><i>src</i></a>)</h3>
like update but only for specified keys
<h3>Function <a id="ds.usub" href="#ds.usub">ds.usub</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L206"><i>src</i></a>)</h3>
utf8 sub. If len is pre-computed you can pass it in for better performance.
<h3>Function <a id="ds.values" href="#ds.values">ds.values</a><code>(t) -&gt; list</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L274"><i>src</i></a>)</h3>
get only the values of pairs(t) as a list
<h3>Function <a id="ds.walk" href="#ds.walk">ds.walk</a><code>(t, fieldFn, tableFn, maxDepth, state) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L516"><i>src</i></a>)</h3>
Walk the table up to depth maxDepth (or infinite if nil) <ul>
<li><code>fieldFn(key, value, state)    -&gt; stop</code> is called for every non-table value.</li>
<li><code>tableFn(key, tblValue, state) -&gt; stop</code> is called for every table value</li>
</ul>
<p>
If tableFn <code>stop==ds.SKIP</code> (i.e. 'skip') then that table is not recursed.
Else if stop then the walk is halted immediately
<h3>Function <a id="ds.writePath" href="#ds.writePath">ds.writePath</a><code>(path, text) -&gt; ok</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L561"><i>src</i></a>)</h3>
<p>
<h2>Module <a id="bt" href="#bt">bt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L892"><i>src</i></a>)</h2>
indexed table as Binary Tree.
These functions treat an indexed table as a binary tree
where root is at <code>index=1</code>
<p>
<h4>Value <a id="ds.bt.__name" href="#ds.bt.__name">ds.bt.__name</a></h4>
<h3>Function <a id="bt.left" href="#bt.left">bt.left</a><code>(t, i) -&gt; t[i * 2]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L893"><i>src</i></a>)</h3>
<h3>Function <a id="bt.lefti" href="#bt.lefti">bt.lefti</a><code>(t, i) -&gt; i * 2</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L896"><i>src</i></a>)</h3>
<h3>Function <a id="bt.parent" href="#bt.parent">bt.parent</a><code>(t, i) -&gt; t[i // 2]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L895"><i>src</i></a>)</h3>
<h3>Function <a id="bt.parenti" href="#bt.parenti">bt.parenti</a><code>(t, i) -&gt; i // 2</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L898"><i>src</i></a>)</h3>
<h3>Function <a id="bt.right" href="#bt.right">bt.right</a><code>(t, i) -&gt; t[i * 2 + 1]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L894"><i>src</i></a>)</h3>
<h3>Function <a id="bt.righti" href="#bt.righti">bt.righti</a><code>(t, i) -&gt; i * 2 + 1</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L897"><i>src</i></a>)</h3>
<h2>Module <a id="dag" href="#dag">dag</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L904"><i>src</i></a>)</h2>
Functions for working with directed acyclic graphs.
<p>
<h4>Value <a id="ds.dag.__name" href="#ds.dag.__name">ds.dag.__name</a></h4>
<h3>Function <a id="dag.missing" href="#dag.missing">dag.missing</a><code>(depsMap) -&gt; missingDeps</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L951"><i>src</i></a>)</h3>
Given a depsMap return missing deps (items in a deps with no name).
<h3>Function <a id="dag.reverseMap" href="#dag.reverseMap">dag.reverseMap</a><code>(childrenMap) -&gt; parentsMap (or vice-versa)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L941"><i>src</i></a>)</h3>
<h3>Function <a id="dag.sort" href="#dag.sort">dag.sort</a><code>(depsMap) -&gt; sortedDeps</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L930"><i>src</i></a>)</h3>
Sort the directed acyclic graph. depsMap must behave like a table which:
<code class="block">  for pairs(depsMap) -&gt; nodeName, ...
  depsMap[nodeName]  -&gt; nodeDeps (list)</code>
<p>
If depsMap is a map of pkg -> depPkgs then the result is the order the pkgs
should be built.
<p>
Note: this function does NOT detect cycles.
<h3>Record <a id="ds.Grid" href="#ds.Grid">ds.Grid</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.Grid.h</code></td>
<td>[int] 
height</td>
</tr>
<tr>
<td><code>ds.Grid.w</code></td>
<td>[int] 
width</td>
</tr>
</table>
<h3>Table <a id="ds.Grid.__docs" href="#ds.Grid.__docs">ds.Grid.__docs</a></h3>
<h3>Table <a id="ds.Grid.__fieldIds" href="#ds.Grid.__fieldIds">ds.Grid.__fieldIds</a></h3>
<h3>Table <a id="ds.Grid.__fields" href="#ds.Grid.__fields">ds.Grid.__fields</a></h3>
<h4>Value <a id="ds.Grid.__name" href="#ds.Grid.__name">ds.Grid.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Grid.__index</code></td>
<td>[Ty<ds.Grid>] </td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.Grid.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="ds.Grid.__fmt" href="#ds.Grid.__fmt">ds.Grid.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Grid.lua#L57"><i>src</i></a>)</h4>
<h4>Function <a id="ds.Grid.clear" href="#ds.Grid.clear">ds.Grid.clear</a><code>(g) -&gt; g</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Grid.lua#L29"><i>src</i></a>)</h4>
clear the grid
<h4>Function <a id="ds.Grid.insert" href="#ds.Grid.insert">ds.Grid.insert</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Grid.lua#L50"><i>src</i></a>)</h4>
insert the str|lines into the grid at l.c
this handles newlines by inserting at the same column
<h3>Record <a id="ds.Iter" href="#ds.Iter">ds.Iter</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.Iter._li</code></td>
<td>[int] = <code>0</code>
left index of fns (stored at negative index)</td>
</tr>
<tr>
<td><code>ds.Iter._nextK</code></td>
<td>[any] 
next key when <code>iter()</code>ated</td>
</tr>
</table>
<h3>Table <a id="ds.Iter.__docs" href="#ds.Iter.__docs">ds.Iter.__docs</a></h3>
<h3>Table <a id="ds.Iter.__fieldIds" href="#ds.Iter.__fieldIds">ds.Iter.__fieldIds</a></h3>
<h3>Table <a id="ds.Iter.__fields" href="#ds.Iter.__fields">ds.Iter.__fields</a></h3>
<h4>Value <a id="ds.Iter.__name" href="#ds.Iter.__name">ds.Iter.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.Iter.__index</code></td>
<td>[Ty<Iter>] </td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.Iter.__ipairs</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L88">src</a>)</td>
</tr>
<tr>
<td><code>ds.Iter.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Iter.__call" href="#Iter.__call">Iter.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L256"><i>src</i></a>)</h4>
use as an iterator.
<h4>Function <a id="Iter.all" href="#Iter.all">Iter.all</a><code>(it) -&gt; not it:find(allFn)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L201"><i>src</i></a>)</h4>
return true if any of the values are truthy
<h4>Function <a id="Iter.any" href="#Iter.any">Iter.any</a><code>(it) -&gt; not not it:find(anyFn)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L205"><i>src</i></a>)</h4>
return true if any of the values are truthy
<h4>Function <a id="Iter.concat" href="#Iter.concat">Iter.concat</a><code>(it, sep) -&gt; concat(it:to(), sep)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L241"><i>src</i></a>)</h4>
<h4>Function <a id="Iter.filter" href="#Iter.filter">Iter.filter</a><code>(it, fn) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L102"><i>src</i></a>)</h4>
- emit only <code>if fn(k, v)</code> results
<h4>Function <a id="Iter.filterK" href="#Iter.filterK">Iter.filterK</a><code>(it, fn) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L109"><i>src</i></a>)</h4>
- emit only <code>if fn(k)</code> results
<h4>Function <a id="Iter.filterV" href="#Iter.filterV">Iter.filterV</a><code>(it, fn) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L116"><i>src</i></a>)</h4>
- emit only <code>if fn(v)</code> results
<h4>Function <a id="Iter.find" href="#Iter.find">Iter.find</a><code>(it, fn) -&gt; k, v</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L196"><i>src</i></a>)</h4>
run the iterator over all values, calling <code>fn(k, v)</code> for each.
return the first <code>k, v</code> where the fn returns a truthy value.
<h4>Function <a id="Iter.index" href="#Iter.index">Iter.index</a><code>(it) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L177"><i>src</i></a>)</h4>
emit <code>i, k</code>, dropping values. <code>i</code> starts at <code>1</code> and increments each
time called.
<p>
<blockquote> Note: this is most useful for iterators which don't emit a <code>v</code>.
i.e. getting the line number in <code>file:lines()</code></blockquote>
<h4>Function <a id="Iter.iter" href="#Iter.iter">Iter.iter</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L260"><i>src</i></a>)</h4>
<h4>Function <a id="Iter.keyIn" href="#Iter.keyIn">Iter.keyIn</a><code>(it, t) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L141"><i>src</i></a>)</h4>
emit <code>k, v</code> for each non-nil <code>t[k]</code>
<h4>Function <a id="Iter.keyNotIn" href="#Iter.keyNotIn">Iter.keyNotIn</a><code>(it, t) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L148"><i>src</i></a>)</h4>
emit <code>k, v</code> for each nil <code>t[k]</code>
<h4>Function <a id="Iter.keysTo" href="#Iter.keysTo">Iter.keysTo</a><code>(it, to={}) -&gt; to</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L232"><i>src</i></a>)</h4>
collect emitted <code>k</code> as a list (vals are dropped)
<h4>Function <a id="Iter.listen" href="#Iter.listen">Iter.listen</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L168"><i>src</i></a>)</h4>
emit <code>k, v</code> after calling <code>fn(k, v)</code>.
The results of the fn are ignored
<h4>Function <a id="Iter.lookup" href="#Iter.lookup">Iter.lookup</a><code>(it, t) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L122"><i>src</i></a>)</h4>
emit<code>v, $t[k]</code>, looking up the iter's values in the table's keys.
<h4>Function <a id="Iter.lookupK" href="#Iter.lookupK">Iter.lookupK</a><code>(it, t) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L127"><i>src</i></a>)</h4>
emit <code>t[k], v</code> for each non-nil <code>t[k]</code>
<h4>Function <a id="Iter.lookupV" href="#Iter.lookupV">Iter.lookupV</a><code>(it, t) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L134"><i>src</i></a>)</h4>
emit <code>k, $t[v]</code> for each non-nil <code>t[v]</code>
<h4>Function <a id="Iter.map" href="#Iter.map">Iter.map</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L82"><i>src</i></a>)</h4>
emit <code>k, fn(v)</code> for each non-nil result
<p>
<blockquote>Note: if performance matters this is the most performant
application function since it doesn't create an internal
function.
</blockquote>
<h4>Function <a id="Iter.mapK" href="#Iter.mapK">Iter.mapK</a><code>(it, fn) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L87"><i>src</i></a>)</h4>
- emit <code>fn(k), v)</code> for each non-nil result.
<h4>Function <a id="Iter.mapV" href="#Iter.mapV">Iter.mapV</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L95"><i>src</i></a>)</h4>
emit <code>k, fn(v)</code> for each non-nil result.
(filtered when <code>newK==nil</code>)
<h4>Function <a id="Iter.of" href="#Iter.of">Iter.of</a><code>(T, t) -&gt; T{pairs(t)}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L43"><i>src</i></a>)</h4>
create iterable of <code>pairs(t)</code>
<h4>Function <a id="Iter.ofList" href="#Iter.ofList">Iter.ofList</a><code>(T, t) -&gt; T{ipairs(t)}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L46"><i>src</i></a>)</h4>
create iterable of <code>ipairs(t)</code>
<h4>Function <a id="Iter.ofOrdList" href="#Iter.ofOrdList">Iter.ofOrdList</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L60"><i>src</i></a>)</h4>
sort t then iterate over list
<h4>Function <a id="Iter.ofOrdMap" href="#Iter.ofOrdMap">Iter.ofOrdMap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L55"><i>src</i></a>)</h4>
create an iterable of <code>t</code> which emits keys in order.
<p>
<blockquote> WARNING: this first sorts the keys, which can be slow</blockquote>
<h4>Function <a id="Iter.ofSlc" href="#Iter.ofSlc">Iter.ofSlc</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L68"><i>src</i></a>)</h4>
iterate over slice of <code>starti:endi</code> in <code>t</code>
<h4>Function <a id="Iter.reset" href="#Iter.reset">Iter.reset</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L244"><i>src</i></a>)</h4>
reset the iterator to run from the start
<h4>Function <a id="Iter.run" href="#Iter.run">Iter.run</a><code>(it, fn--[[noop]]) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L217"><i>src</i></a>)</h4>
run the iterator over all values, calling <code>fn(k, v)</code> for each.
<h4>Function <a id="Iter.single" href="#Iter.single">Iter.single</a><code>(k, v) -&gt; (k, v)-&gt;nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L269"><i>src</i></a>)</h4>
create an iterator that returns a single value
<h4>Function <a id="Iter.swap" href="#Iter.swap">Iter.swap</a><code>(it) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L180"><i>src</i></a>)</h4>
emit <code>v, k</code> (swaps key and value)
<h4>Function <a id="Iter.to" href="#Iter.to">Iter.to</a><code>(it, to={}) -&gt; to</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L225"><i>src</i></a>)</h4>
collect non-nil <code>k, v</code> into table-like object <code>to</code>
<h4>Function <a id="Iter.valIn" href="#Iter.valIn">Iter.valIn</a><code>(it, t) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L155"><i>src</i></a>)</h4>
emit <code>k, v</code> for each non-nil <code>t[v]</code>
<h4>Function <a id="Iter.valNotIn" href="#Iter.valNotIn">Iter.valNotIn</a><code>(it, t) -&gt; it</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L162"><i>src</i></a>)</h4>
emit <code>k, v</code> for each nil <code>t[v]</code>
<h4>Function <a id="Iter.valsTo" href="#Iter.valsTo">Iter.valsTo</a><code>(it, to={}) -&gt; to</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/Iter.lua#L239"><i>src</i></a>)</h4>
collect emitted <code>v</code> as a list (keys are dropped)
<h3>Record <a id="ds.LL" href="#ds.LL">ds.LL</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.LL.l</code></td>
<td>[&LL] 
left node</td>
</tr>
<tr>
<td><code>ds.LL.r</code></td>
<td>[&LL] 
right node</td>
</tr>
<tr>
<td><code>ds.LL.v</code></td>
<td>[any] 
value</td>
</tr>
</table>
<h3>Table <a id="ds.LL.__docs" href="#ds.LL.__docs">ds.LL.__docs</a></h3>
<h3>Table <a id="ds.LL.__fieldIds" href="#ds.LL.__fieldIds">ds.LL.__fieldIds</a></h3>
<h3>Table <a id="ds.LL.__fields" href="#ds.LL.__fields">ds.LL.__fields</a></h3>
<h4>Value <a id="ds.LL.__name" href="#ds.LL.__name">ds.LL.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.LL.__index</code></td>
<td>[Ty<LL>] </td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.LL.__ipairs</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L88">src</a>)</td>
</tr>
<tr>
<td><code>ds.LL.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>ds.LL.__pairs</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L88">src</a>)</td>
</tr>
</table>
<h4>Function <a id="LL.__add" href="#LL.__add">LL.__add</a><code>(ll, v) -&gt; tail</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L94"><i>src</i></a>)</h4>
Add DSL (ll + v). Puts node with v=v after tail, returns new tail.
<h4>Function <a id="LL.__call" href="#LL.__call">LL.__call</a><code>(ll) -&gt; ll.r (use with `for`)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L113"><i>src</i></a>)</h4>
<h4>Function <a id="LL.__fmt" href="#LL.__fmt">LL.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L123"><i>src</i></a>)</h4>
<h4>Function <a id="LL.__sub" href="#LL.__sub">LL.__sub</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L111"><i>src</i></a>)</h4>
Link DSL: l - r ==> l -> r
Links <code>l:tail() -&gt; r:head(), return r:tail()</code>
<p>
Note: This is for convienience and expressiveness of small lists.
Use link() or insert() if performance matters.
<p>
Example: <code class="block">  l6     = LL(3) - (LL(4) + 5) - L(6) ==&gt; (3 -&gt; 4 -&gt; 5 -&gt; 6)
  l3tail = l1 - l2 - l3</code>
<h4>Function <a id="LL.from" href="#LL.from">LL.from</a><code>(T, list) -&gt; (head, tail) from list of vals</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L43"><i>src</i></a>)</h4>
<h4>Function <a id="LL.get" href="#LL.get">LL.get</a><code>(ll, i) -&gt; node? (at index +/- i)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L86"><i>src</i></a>)</h4>
<h4>Function <a id="LL.head" href="#LL.head">LL.head</a><code>(ll) -&gt; ll</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L45"><i>src</i></a>)</h4>
<h4>Function <a id="LL.insert" href="#LL.insert">LL.insert</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L60"><i>src</i></a>)</h4>
insert LL(v) to right of ll
<code>(h -&gt; 2); h:insert(1) ==&gt; (h -&gt; 1 -&gt; 2)</code>
<h4>Function <a id="LL.link" href="#LL.link">LL.link</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L54"><i>src</i></a>)</h4>
create l -> r link
<h4>Function <a id="LL.rm" href="#LL.rm">LL.rm</a><code>(ll) -&gt; head?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L73"><i>src</i></a>)</h4>
remove node ll from linked list
if ll was the head, returns the new head (or nil)
<h4>Function <a id="LL.tail" href="#LL.tail">LL.tail</a><code>(ll) -&gt; ll</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L46"><i>src</i></a>)</h4>
<h4>Function <a id="LL.tolist" href="#LL.tolist">LL.tolist</a><code>(ll) -&gt; {a.v, b.v, c.v, ...}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/LL.lua#L51"><i>src</i></a>)</h4>
<h2>Module <a id="ds.heap" href="#ds.heap">ds.heap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/heap.lua#L2"><i>src</i></a>)</h2>
Binary Heap implementation
<p>
<h4>Value <a id="ds.heap.__name" href="#ds.heap.__name">ds.heap.__name</a></h4>
<h3>Record <a id="ds.heap.Heap" href="#ds.heap.Heap">ds.heap.Heap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/heap.lua#L66"><i>src</i></a>)</h3>
Heap(t, cmp) binary heap using a table.
A binary heap is a binary tree where the value of the parent always
satisfies `cmp(parent, child) == true`
Min Heap: cmp = function(p, c) return p < c end (default)
Max Heap: cmp = function(p, c) return p > c end
<p>
add and push take only O(log n), making it very useful for
priority queues and similar problems.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ds.heap.Heap.cmp</code></td>
<td>[function] = <code>fn"ds.lt"[/home/rett/projects/civlua/lib/ds/ds.lua:121]</code>
comparison function to use</td>
</tr>
</table>
<h3>Table <a id="ds.heap.Heap.__docs" href="#ds.heap.Heap.__docs">ds.heap.Heap.__docs</a></h3>
<h3>Table <a id="ds.heap.Heap.__fieldIds" href="#ds.heap.Heap.__fieldIds">ds.heap.Heap.__fieldIds</a></h3>
<h3>Table <a id="ds.heap.Heap.__fields" href="#ds.heap.Heap.__fields">ds.heap.Heap.__fields</a></h3>
<h4>Value <a id="ds.heap.Heap.__name" href="#ds.heap.Heap.__name">ds.heap.Heap.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.heap.Heap.__index</code></td>
<td>[Ty<Heap>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/heap.lua#L66">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.heap.Heap.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Heap.add" href="#Heap.add">Heap.add</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/heap.lua#L74"><i>src</i></a>)</h4>
<code>h:add(v)</code> add value to the heap.
<h4>Function <a id="Heap.pop" href="#Heap.pop">Heap.pop</a><code>(h) -&gt; v</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/heap.lua#L83"><i>src</i></a>)</h4>
<code>h:pop() -&gt; v</code> pop the top node.
<h2>Module <a id="ds.log" href="#ds.log">ds.log</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L18"><i>src</i></a>)</h2>
Simple logging library, set i.e. LOGLEVEL=TRACE to enable logging.
<p>
This module has the functions <code>trace info warn err crit</code> with the signature:
<code>function(fmt, ... [, data])</code> <ul>
<li>the ... are the format args which behave like <code>fmt.format</code> (aka <code>%q</code>
formats tables/etc).</li>
<li>data is optional arbitrary data that can be serialized/formatted.</li>
</ul>
<p>
To enable logging the user should set a global (or env var) LOGLEVEL
to oneof: C/CRIT/1 E/ERROR/2 W/WARN/3 I/INFO/4 T/TRACE/5
<p>
This module also sets (if not already set) the global LOGFN to <code>ds.logFn</code>
which logs to stderr. This fn is called with signature
<code>function(level, srcloc, fmt, ...)</code>
<p>
<h3>Table <a id="ds.log.LEVEL" href="#ds.log.LEVEL">ds.log.LEVEL</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L37"><i>src</i></a>)</h3><code class="block">local LEVEL = ds.Checked{
  SLIENT=0, [0]='SILENT',
  C=1, CRIT=1,
  E=2, ERROR=2,
  W=3, WARN=3,
  I=4, INFO=4,
  T=5, TRACE=5,
  'CRIT', 'ERROR', 'WARN', 'INFO', 'TRACE'
}; M.LEVEL = LEVEL</code>
<h4>Value <a id="ds.log.__name" href="#ds.log.__name">ds.log.__name</a></h4>
<h3>Record <a id="ds.log.LogTable" href="#ds.log.LogTable">ds.log.LogTable</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L74"><i>src</i></a>)</h3>
used in tests
<p>
<h3>Table <a id="ds.log.LogTable.__docs" href="#ds.log.LogTable.__docs">ds.log.LogTable.__docs</a></h3>
<h3>Table <a id="ds.log.LogTable.__fieldIds" href="#ds.log.LogTable.__fieldIds">ds.log.LogTable.__fieldIds</a></h3>
<h3>Table <a id="ds.log.LogTable.__fields" href="#ds.log.LogTable.__fields">ds.log.LogTable.__fields</a></h3>
<h4>Value <a id="ds.log.LogTable.__name" href="#ds.log.LogTable.__name">ds.log.LogTable.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ds.log.LogTable.__index</code></td>
<td>[Ty<LogTable>] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L74">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ds.log.LogTable.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="LogTable.__call" href="#LogTable.__call">LogTable.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L75"><i>src</i></a>)</h4>
<h3>Function <a id="ds.log.crit" href="#ds.log.crit">ds.log.crit</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L67"><i>src</i></a>)</h3>
<h3>Function <a id="ds.log.err" href="#ds.log.err">ds.log.err</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L68"><i>src</i></a>)</h3>
<h3>Function <a id="ds.log.info" href="#ds.log.info">ds.log.info</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L70"><i>src</i></a>)</h3>
<h3>Function <a id="ds.log.levelInt" href="#ds.log.levelInt">ds.log.levelInt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L39"><i>src</i></a>)</h3>
<h3>Function <a id="ds.log.levelStr" href="#ds.log.levelStr">ds.log.levelStr</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L43"><i>src</i></a>)</h3>
<h3>Function <a id="ds.log.logFn" href="#ds.log.logFn">ds.log.logFn</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L51"><i>src</i></a>)</h3>
set the global logging level (default=os.getenv'LOGLEVEL')
<h3>Function <a id="ds.log.setLevel" href="#ds.log.setLevel">ds.log.setLevel</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L48"><i>src</i></a>)</h3>
set the global logging level (default=os.getenv'LOGLEVEL')
<h3>Function <a id="ds.log.time" href="#ds.log.time">ds.log.time</a><code>() -&gt; os.date():match'%d%d:%d%d:%d%d'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L27"><i>src</i></a>)</h3>
<h3>Function <a id="ds.log.trace" href="#ds.log.trace">ds.log.trace</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L71"><i>src</i></a>)</h3>
<h3>Function <a id="ds.log.warn" href="#ds.log.warn">ds.log.warn</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/log.lua#L69"><i>src</i></a>)</h3>
<h2>Module <a id="ds.path" href="#ds.path">ds.path</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L5"><i>src</i></a>)</h2>
working with paths
Call directly to convert a list|str to a list of path components.
<p>
<h4>Value <a id="ds.path.__name" href="#ds.path.__name">ds.path.__name</a></h4>
<h3>Function <a id="ds.path.abs" href="#ds.path.abs">ds.path.abs</a><code>(path, wd) -&gt; /absolute/path</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L70"><i>src</i></a>)</h3>
E-nsure the path is absolute, using the wd (default=cwd()) if necessary
<p>
This preserves the type of the input: str -> str; table -> table
<h3>Function <a id="ds.path.cmpDirsLast" href="#ds.path.cmpDirsLast">ds.path.cmpDirsLast</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L172"><i>src</i></a>)</h3>
path comparison function for <code>table.sort</code> that sorts
dirs last, else alphabetically.
<h3>Function <a id="ds.path.concat" href="#ds.path.concat">ds.path.concat</a><code>(t) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L40"><i>src</i></a>)</h3>
join a table of path components
<h3>Function <a id="ds.path.cwd" href="#ds.path.cwd">ds.path.cwd</a><code>() -&gt; G.CWD or os.getenv'PWD' or os.getenv'CD'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L24"><i>src</i></a>)</h3>
get current working directory
<h3>Function <a id="ds.path.ext" href="#ds.path.ext">ds.path.ext</a><code>(path) -&gt; string. path: [str|list]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L55"><i>src</i></a>)</h3>
<h3>Function <a id="ds.path.first" href="#ds.path.first">ds.path.first</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L142"><i>src</i></a>)</h3>
<code>first/middle/last -&gt; ("first", "middle/last")</code>
<h3>Function <a id="ds.path.hasBacktrack" href="#ds.path.hasBacktrack">ds.path.hasBacktrack</a><code>(path) -&gt; bool. path: [str|list]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L51"><i>src</i></a>)</h3>
return whether a path has any '..' components
<h3>Function <a id="ds.path.home" href="#ds.path.home">ds.path.home</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L28"><i>src</i></a>)</h3>
get the user's home directory
<h3>Function <a id="ds.path.isDir" href="#ds.path.isDir">ds.path.isDir</a><code>(path) -&gt; path:sub(-1) == '/'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L154"><i>src</i></a>)</h3>
return whether the path looks like a dir.
Note: civlua tries to make all ftype='dir' paths end in '/'
but other libraries or APIs may not conform to this.
<h3>Function <a id="ds.path.itemeq" href="#ds.path.itemeq">ds.path.itemeq</a><code>(a, b) -&gt; boolean: path items are equal</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L111"><i>src</i></a>)</h3>
<h3>Function <a id="ds.path.last" href="#ds.path.last">ds.path.last</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L149"><i>src</i></a>)</h3>
<code>first/middle/last -&gt; ("first/middle", "last")</code>
<h3>Function <a id="ds.path.nice" href="#ds.path.nice">ds.path.nice</a><code>(path, wd) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L128"><i>src</i></a>)</h3>
return a nice path (string) that is resolved and readable.
<p>
It's 'nice' because it has no '/../' or '/./' elements
and has CWD stripped.
<h3>Function <a id="ds.path.resolve" href="#ds.path.resolve">ds.path.resolve</a><code>(path, wd) -&gt; list</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L107"><i>src</i></a>)</h3>
resolve any `..` or `.` path components, making the path
/absolute if necessary.
<h3>Function <a id="ds.path.rmleft" href="#ds.path.rmleft">ds.path.rmleft</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L116"><i>src</i></a>)</h3>
ds.rmleft for path components
<h3>Function <a id="ds.path.short" href="#ds.path.short">ds.path.short</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L134"><i>src</i></a>)</h3>
Return only the parent dir and final item.
This is often used for documentation/etc
<h3>Function <a id="ds.path.toDir" href="#ds.path.toDir">ds.path.toDir</a><code>(path) -&gt; path/</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L158"><i>src</i></a>)</h3>
<h3>Function <a id="ds.path.toNonDir" href="#ds.path.toNonDir">ds.path.toNonDir</a><code>(path) -&gt; path (without ending /)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/path.lua#L162"><i>src</i></a>)</h3>
<h2>Module <a id="ds.utf8" href="#ds.utf8">ds.utf8</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/utf8.lua#L4"><i>src</i></a>)</h2>
utf8 stream decoding.
Get the length by decodelen(firstbyte), then decode the whole character
with decode(dat)
<p>
<h4>Value <a id="ds.utf8.__name" href="#ds.utf8.__name">ds.utf8.__name</a></h4>
<h3>Function <a id="ds.utf8.decode" href="#ds.utf8.decode">ds.utf8.decode</a><code>(dat) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/utf8.lua#L25"><i>src</i></a>)</h3>
decode utf8 data (table) into an integer.
Use <code>utf8.char</code> (from lua's stdlib) to turn into a string.
<h3>Function <a id="ds.utf8.decodelen" href="#ds.utf8.decodelen">ds.utf8.decodelen</a><code>(firstbyte) -&gt; U8LEN[0xF8 & firstbyte]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds/utf8.lua#L17"><i>src</i></a>)</h3>
given the first byte return the number of bytes in the utf8 char
<p>
<h1><a id="Package_lines" href="#Package_lines">Package lines</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Data structures for mixed media (memory/fs) lines of text</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_lines">https://lua.civboot.org#Package_lines</a></td>
</tr>
</table>
<p>
<h3>Table <a id="lines" href="#lines">lines</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines.lua#L7"><i>src</i></a>)</h3>
lines module, when called splits a string into lines.
<code>require'lines'(text) -&gt; table of lines</code>
<p>
sub-modules include several data structures with more performant
mechanisms to insert/remove/etc based on real-world workloads
(i.e. editor, parser, etc)
<h3>Record <a id="lines.EdFile" href="#lines.EdFile">lines.EdFile</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lines.EdFile.lf</code></td>
<td>[lines.File] 
indexed file</td>
</tr>
<tr>
<td><code>lines.EdFile.dats</code></td>
<td>[list] 
list of Slc</td>
<td>Gap</td>
</tr>
<tr>
<td><code>lines.EdFile.lens</code></td>
<td>[list] 
rolling sum of dat lengths</td>
</tr>
<tr>
<td><code>lines.EdFile.readonly</code></td>
<td>[bool] </td>
</tr>
</table>
<h3>Table <a id="lines.EdFile.__docs" href="#lines.EdFile.__docs">lines.EdFile.__docs</a></h3>
<h3>Table <a id="lines.EdFile.__fieldIds" href="#lines.EdFile.__fieldIds">lines.EdFile.__fieldIds</a></h3>
<h3>Table <a id="lines.EdFile.__fields" href="#lines.EdFile.__fields">lines.EdFile.__fields</a></h3>
<h4>Value <a id="lines.EdFile.__name" href="#lines.EdFile.__name">lines.EdFile.__name</a></h4>
<h4>Function <a id="EdFile.__extend" href="#EdFile.__extend">EdFile.__extend</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L158"><i>src</i></a>)</h4>
appends to lf for extend when possible.
<h4>Function <a id="EdFile.__inset" href="#EdFile.__inset">EdFile.__inset</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L273"><i>src</i></a>)</h4>
insert into EdFile's dats.
<h4>Function <a id="EdFile.__len" href="#EdFile.__len">EdFile.__len</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L50"><i>src</i></a>)</h4>
<h4>Function <a id="EdFile._datindex" href="#EdFile._datindex">EdFile._datindex</a><code>(ef, i) -&gt; di</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L59"><i>src</i></a>)</h4>
get the index into dats where <code>ef[i]</code> is located
<h4>Function <a id="EdFile._updateLens" href="#EdFile._updateLens">EdFile._updateLens</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L45"><i>src</i></a>)</h4>
<h4>Function <a id="EdFile.dumpf" href="#EdFile.dumpf">EdFile.dumpf</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L142"><i>src</i></a>)</h4>
Dump EdFile to file or path
<h4>Function <a id="EdFile.flush" href="#EdFile.flush">EdFile.flush</a><code>(ef) -&gt; ef.lf:flush()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L127"><i>src</i></a>)</h4>
Flush the .lf member (which can only be extended).
To write all data to disk use :dump()
<h4>Function <a id="EdFile.iter" href="#EdFile.iter">EdFile.iter</a><code>(ef) -&gt; EdIter(ef)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L123"><i>src</i></a>)</h4>
<h4>Function <a id="EdFile.write" href="#EdFile.write">EdFile.write</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/EdFile.lua#L82"><i>src</i></a>)</h4>
<h3>Record <a id="lines.File" href="#lines.File">lines.File</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lines.File.path</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>lines.File.mode</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>lines.File.f</code></td>
<td>[file] 
open file</td>
</tr>
<tr>
<td><code>lines.File.idx</code></td>
<td>[U3File] 
line index of f</td>
</tr>
<tr>
<td><code>lines.File.cache</code></td>
<td>[WeakV] 
cache of lines</td>
</tr>
<tr>
<td><code>lines.File._ln</code></td>
<td>[int] 
current line num (false=end)</td>
</tr>
<tr>
<td><code>lines.File._pos</code></td>
<td>[bool] 
current file pos</td>
</tr>
</table>
<h4>Value <a id="lines.File.IDX_DIR" href="#lines.File.IDX_DIR">lines.File.IDX_DIR</a></h4>
<h3>Table <a id="lines.File.__docs" href="#lines.File.__docs">lines.File.__docs</a></h3>
<h3>Table <a id="lines.File.__fieldIds" href="#lines.File.__fieldIds">lines.File.__fieldIds</a></h3>
<h3>Table <a id="lines.File.__fields" href="#lines.File.__fields">lines.File.__fields</a></h3>
<h4>Value <a id="lines.File.__name" href="#lines.File.__name">lines.File.__name</a></h4>
<b>Methods: </b> <table>
<tr>
<td><code>lines.File._initnew</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L87">src</a>)</td>
</tr>
</table>
<h4>Function <a id="File.__fmt" href="#File.__fmt">File.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L154"><i>src</i></a>)</h4>
<h4>Function <a id="File.__len" href="#File.__len">File.__len</a><code>(lf) -&gt; #lf.idx</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L110"><i>src</i></a>)</h4>
<h4>Function <a id="File._reindex" href="#File._reindex">File._reindex</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L53"><i>src</i></a>)</h4>
<h4>Function <a id="File.close" href="#File.close">File.close</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L77"><i>src</i></a>)</h4>
<h4>Function <a id="File.flush" href="#File.flush">File.flush</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L84"><i>src</i></a>)</h4>
<h4>Function <a id="File.reader" href="#File.reader">File.reader</a><code>(lf) -&gt; lines.File (readonly)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L163"><i>src</i></a>)</h4>
<h4>Function <a id="File.write" href="#File.write">File.write</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L108"><i>src</i></a>)</h4>
append to file
<h3>Record <a id="lines.Gap" href="#lines.Gap">lines.Gap</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lines.Gap.bot</code></td>
<td>[table] </td>
</tr>
<tr>
<td><code>lines.Gap.top</code></td>
<td>[table] </td>
</tr>
<tr>
<td><code>lines.Gap.path</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="lines.Gap.__docs" href="#lines.Gap.__docs">lines.Gap.__docs</a></h3>
<h3>Table <a id="lines.Gap.__fieldIds" href="#lines.Gap.__fieldIds">lines.Gap.__fieldIds</a></h3>
<h3>Table <a id="lines.Gap.__fields" href="#lines.Gap.__fields">lines.Gap.__fields</a></h3>
<h4>Value <a id="lines.Gap.__name" href="#lines.Gap.__name">lines.Gap.__name</a></h4>
<h4>Function <a id="Gap.__extend" href="#Gap.__extend">Gap.__extend</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Gap.lua#L83"><i>src</i></a>)</h4>
<h4>Function <a id="Gap.__fmt" href="#Gap.__fmt">Gap.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Gap.lua#L58"><i>src</i></a>)</h4>
<h4>Function <a id="Gap.__inset" href="#Gap.__inset">Gap.__inset</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Gap.lua#L77"><i>src</i></a>)</h4>
see lines.inset
This has much better performance than lines.inset when operations
are performed close together.
<h4>Function <a id="Gap.__len" href="#Gap.__len">Gap.__len</a><code>(g) -&gt; #g.bot + #g.top</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Gap.lua#L40"><i>src</i></a>)</h4>
<h4>Function <a id="lines.U3File.__pairs" href="#lines.U3File.__pairs">lines.U3File.__pairs</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L55"><i>src</i></a>)</h4>
<h4>Function <a id="Gap.load" href="#Gap.load">Gap.load</a><code>(T, f, close) -&gt; Gap?, err?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Gap.lua#L38"><i>src</i></a>)</h4>
Load gap from file, which can be a path.
returns nil, err on error
<h4>Function <a id="Gap.setGap" href="#Gap.setGap">Gap.setGap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Gap.lua#L105"><i>src</i></a>)</h4>
set the gap to the line
<h4>Function <a id="Gap.write" href="#Gap.write">Gap.write</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Gap.lua#L115"><i>src</i></a>)</h4>
<h3>Record <a id="lines.U3File" href="#lines.U3File">lines.U3File</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lines.U3File.f</code></td>
<td>[file] </td>
</tr>
<tr>
<td><code>lines.U3File.path</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>lines.U3File.len</code></td>
<td>[int] </td>
</tr>
<tr>
<td><code>lines.U3File._i</code></td>
<td>[int] </td>
</tr>
</table>
<h3>Table <a id="lines.U3File.__docs" href="#lines.U3File.__docs">lines.U3File.__docs</a></h3>
<h3>Table <a id="lines.U3File.__fieldIds" href="#lines.U3File.__fieldIds">lines.U3File.__fieldIds</a></h3>
<h3>Table <a id="lines.U3File.__fields" href="#lines.U3File.__fields">lines.U3File.__fields</a></h3>
<h4>Value <a id="lines.U3File.__name" href="#lines.U3File.__name">lines.U3File.__name</a></h4>
<b>Methods: </b> <table>
<tr>
<td><code>lines.U3File.__pairs</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L55">src</a>)</td>
</tr>
</table>
<h4>Function <a id="lines.U3File.__fmt" href="#lines.U3File.__fmt">lines.U3File.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L87"><i>src</i></a>)</h4>
<h4>Function <a id="lines.U3File.__len" href="#lines.U3File.__len">lines.U3File.__len</a><code>(u3) -&gt; u3.len</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L54"><i>src</i></a>)</h4>
<h4>Function <a id="lines.U3File.close" href="#lines.U3File.close">lines.U3File.close</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L59"><i>src</i></a>)</h4>
<h4>Function <a id="lines.U3File.create" href="#lines.U3File.create">lines.U3File.create</a><code>(T, path) -&gt; U3File?, err</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L35"><i>src</i></a>)</h4>
This creates a new index file at path (path=nil uses tmpfile()).
Note: Use load if you want to load an existing index.
<h4>Function <a id="lines.U3File.flush" href="#lines.U3File.flush">lines.U3File.flush</a><code>(u3) -&gt; u3.f:flush()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L53"><i>src</i></a>)</h4>
<h4>Function <a id="lines.U3File.load" href="#lines.U3File.load">lines.U3File.load</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L51"><i>src</i></a>)</h4>
load an index file
<h4>Function <a id="lines.U3File.reload" href="#lines.U3File.reload">lines.U3File.reload</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/U3File.lua#L46"><i>src</i></a>)</h4>
reload from path
<h3>Record <a id="lines.Writer" href="#lines.Writer">lines.Writer</a></h3>
<p>
<h3>Table <a id="lines.Writer.__docs" href="#lines.Writer.__docs">lines.Writer.__docs</a></h3>
<h3>Table <a id="lines.Writer.__fieldIds" href="#lines.Writer.__fieldIds">lines.Writer.__fieldIds</a></h3>
<h3>Table <a id="lines.Writer.__fields" href="#lines.Writer.__fields">lines.Writer.__fields</a></h3>
<h4>Value <a id="lines.Writer.__name" href="#lines.Writer.__name">lines.Writer.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lines.Writer.__index</code></td>
<td>[Ty<lines.Writer>] </td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lines.Writer.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>lines.Writer.flush</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L87">src</a>)</td>
</tr>
</table>
<h4>Function <a id="lines.Writer.write" href="#lines.Writer.write">lines.Writer.write</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/Writer.lua#L13"><i>src</i></a>)</h4>
<h3>Table <a id="lines.buffer" href="#lines.buffer">lines.buffer</a></h3>
<h2>Module <a id="lines.diff" href="#lines.diff">lines.diff</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L6"><i>src</i></a>)</h2>
Diffing module and command
Example command: <code>lines.diff{'file/path1.txt', 'file/path2.txt'}</code>
Note: the arguments can be a string (path) or list of lines.
<p>
<h4>Value <a id="lines.diff.__name" href="#lines.diff.__name">lines.diff.__name</a></h4>
<h3>Table <a id="lines.diff._toTest" href="#lines.diff._toTest">lines.diff._toTest</a></h3>
<h3>Record <a id="lines.diff.Diff" href="#lines.diff.Diff">lines.diff.Diff</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L35"><i>src</i></a>)</h3>
Line-based diff.
The default algorithm uses patience diff. Special thanks to:
<a href="https://blog.jcoglan.com/2017/09/19/the-patience-diff-algorithm">https://blog.jcoglan.com/2017/09/19/the-patience-diff-algorithm</a>
<p>
The basic algorithm on before/after line lists: <ul>
<li>skip unchanged lines on both top and bottom</li>
<li>find unique lines in both sets and "align" them with
using "longest increasing sequence"</li>
<li>repeat for each aligned section</li>
</ul>
<p>
Example: <code>io.fmt(Diff(linesA, linesB))</code>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lines.diff.Diff.b</code></td>
<td>[lines] 
base, aka original lines</td>
</tr>
<tr>
<td><code>lines.diff.Diff.c</code></td>
<td>[lines] 
change, aka new lines</td>
</tr>
<tr>
<td><code>lines.diff.Diff.di</code></td>
<td>[int] 
len of noc/rem/add</td>
</tr>
<tr>
<td><code>lines.diff.Diff.noc</code></td>
<td>[ints] 
nochange range (in both)</td>
</tr>
<tr>
<td><code>lines.diff.Diff.rem</code></td>
<td>[ints] 
removed from b</td>
</tr>
<tr>
<td><code>lines.diff.Diff.add</code></td>
<td>[ints] 
added from c</td>
</tr>
</table>
<h3>Table <a id="lines.diff.Diff.__docs" href="#lines.diff.Diff.__docs">lines.diff.Diff.__docs</a></h3>
<h3>Table <a id="lines.diff.Diff.__fieldIds" href="#lines.diff.Diff.__fieldIds">lines.diff.Diff.__fieldIds</a></h3>
<h3>Table <a id="lines.diff.Diff.__fields" href="#lines.diff.Diff.__fields">lines.diff.Diff.__fields</a></h3>
<h4>Value <a id="lines.diff.Diff.__name" href="#lines.diff.Diff.__name">lines.diff.Diff.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lines.diff.Diff.__index</code></td>
<td>[Ty<Diff>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L35">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lines.diff.Diff.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Diff.__fmt" href="#Diff.__fmt">Diff.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L236"><i>src</i></a>)</h4>
<h4>Function <a id="Diff._calc" href="#Diff._calc">Diff._calc</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L145"><i>src</i></a>)</h4>
<h4>Function <a id="Diff._compress" href="#Diff._compress">Diff._compress</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L176"><i>src</i></a>)</h4>
compress all like-fields together
<h4>Function <a id="Diff.map" href="#Diff.map">Diff.map</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L213"><i>src</i></a>)</h4>
iterate through nochange and change blocks, calling the functions for each
<ul>
<li><code>nocFn(baseStart, numUnchanged, changeStart, numUnchanged)</code></li>
<li><code>chgFn(baseStart, numRemoved,   changeStart, numAdded)</code></li>
</ul>
Note that the num removed/added will be nil if none were added/removed.
<h3>Function <a id="lines.diff.main" href="#lines.diff.main">lines.diff.main</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/diff.lua#L259"><i>src</i></a>)</h3>
<h2>Module <a id="lines.futils" href="#lines.futils">lines.futils</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/futils.lua#L3"><i>src</i></a>)</h2>
utilities for file loading of lines.
<p>
<h4>Value <a id="lines.futils.__name" href="#lines.futils.__name">lines.futils.__name</a></h4>
<h3>Function <a id="lines.futils.loadIdx" href="#lines.futils.loadIdx">lines.futils.loadIdx</a><code>(f, idxpath, fmode, reindex) -&gt; idxFile</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/futils.lua#L31"><i>src</i></a>)</h3>
load or reindex the file at path to/from idxpath.
<h2>Module <a id="rebuf.motion" href="#rebuf.motion">rebuf.motion</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L4"><i>src</i></a>)</h2>
module with helper methods for moving a cursor
around a lines-like 2D grid.
<p>
<h3>Table <a id="rebuf.motion.WordKind" href="#rebuf.motion.WordKind">rebuf.motion.WordKind</a></h3>
<h4>Value <a id="lines.motion.__name" href="#lines.motion.__name">lines.motion.__name</a></h4>
<h3>Function <a id="rebuf.motion.backword" href="#rebuf.motion.backword">rebuf.motion.backword</a><code>(s, end_) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L102"><i>src</i></a>)</h3>
Go backward to find the start of this (or previous) word
<h3>Function <a id="rebuf.motion.decDistance" href="#rebuf.motion.decDistance">rebuf.motion.decDistance</a><code>(s, e) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L17"><i>src</i></a>)</h3>
decrease distance (start -> end) by 1
<h3>Function <a id="rebuf.motion.findBack" href="#rebuf.motion.findBack">rebuf.motion.findBack</a><code>(s, pat, end_, plain) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L117"><i>src</i></a>)</h3>
find backwards
this searches for the pattern and returns the LAST one found.
This is HORRIBLY non-performant, only use for small amounts of data
<h3>Function <a id="rebuf.motion.forword" href="#rebuf.motion.forword">rebuf.motion.forword</a><code>(s, begin) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L88"><i>src</i></a>)</h3>
Go forward to find the start of the next word
<h3>Function <a id="rebuf.motion.lcGe" href="#rebuf.motion.lcGe">rebuf.motion.lcGe</a><code>(l, c, l2, c2) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L29"><i>src</i></a>)</h3>
return whether l.c is >= l2.c2
<h3>Function <a id="rebuf.motion.lcLe" href="#rebuf.motion.lcLe">rebuf.motion.lcLe</a><code>(l, c, l2, c2) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L23"><i>src</i></a>)</h3>
return whether l.c is <= l2.c2
<h3>Function <a id="rebuf.motion.lcWithin" href="#rebuf.motion.lcWithin">rebuf.motion.lcWithin</a><code>(l, c, l1, c1, l2, c2) -&gt; bool</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L54"><i>src</i></a>)</h3>
<h3>Function <a id="rebuf.motion.topLeft" href="#rebuf.motion.topLeft">rebuf.motion.topLeft</a><code>(l, c, l2, c2) -&gt; (l, c)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L39"><i>src</i></a>)</h3>
return the top-left of two points
<h3>Function <a id="rebuf.motion.wordKind" href="#rebuf.motion.wordKind">rebuf.motion.wordKind</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/motion.lua#L73"><i>src</i></a>)</h3>
<h2>Module <a id="lines.testing" href="#lines.testing">lines.testing</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/testing.lua#L2"><i>src</i></a>)</h2>
testing helpers for ds related data structures
<p>
<h3>Table <a id="lines.testing.DATA" href="#lines.testing.DATA">lines.testing.DATA</a></h3>
<h4>Value <a id="lines.testing.__name" href="#lines.testing.__name">lines.testing.__name</a></h4>
<h3>Function <a id="lines.testing.testLinesRemove" href="#lines.testing.testLinesRemove">lines.testing.testLinesRemove</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/testing.lua#L117"><i>src</i></a>)</h3>
Test lines.remove on object. new must accept either a string or table of
lines to create a new object (does NOT need to be copied)
called for various data structures which implement lines
<h3>Function <a id="lines.testing.testOffset" href="#lines.testing.testOffset">lines.testing.testOffset</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/testing.lua#L54"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_pod" href="#Package_pod">Package pod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Plain old data (POD) de/serialization</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-1</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_pod">https://lua.civboot.org#Package_pod</a></td>
</tr>
</table>
<h1>pod: plain-old-data library and serialization</h1>
<p>
A Lua library for specifying and converting types to/from "plain old data" and
methods to serialize/deserialize those types to/from bytes. In Lua, the 5
supported types considered "plain old data" are: nil, boolean, integer, string
and any table of only these types.
<p>
<code class="block">local M = mod'mymod'
local mty = require'metaty'
local pod = require'pod'

-- enums are already plain-old-data.
M.Job = mty.enum'Job' { BOSS = 1, PEON = 2 }

--- records need to have pod() called on them.
--- This implements __toPod and __fromPod for the metaty record.
M.Worker = pod(mty'Worker' {
  'name [string] #1',    -- must specify type and #id
  'job  [mymod.Job] #2', -- can lookup any type in PKG_LOOKUP
  'salary [int] #3',
  'schedule {int: mymod.Schedule} #4', -- map of weekday[1,7] -&gt; scheduled time
})

M.Schedule = pod(mty'Schedule' {
  'start [int]: start time in seconds since midnight',
  'stop  [int]: stop time in seconds since midnight',
})

local serialized = pod.ser(M.Worker{...})   -- convert to string
local worker = pod.de(serialized, M.Worker) -- convert from string</code>
<p>
Explanation of above:<ul>
<li><code>metaty.enum</code> are already plain-old-data (no need to call <code>pod()</code> on them).</li>
<li><code>metaty</code> record types can be made plain old data by calling the
<code>pod()</code> module on them.
<p>
This simply implements the <code>__toPod</code> and <code>__fromPod</code> methods on them --
you can do this yourself if you prefer!</li>
<li>pod parses the metaty field type stanza as <code>[singleType]</code>, <code>{listType}</code> or
<code>{map: type}</code> repsecitively. The collection types are converted to
<code>pod.List</code> and <code>pod.Map</code> respectively.</li>
</ul>
<p>
<h2>Serialization Best Practices</h2>
<ul>
<li>Only make a type pod if it is actually plain-old-data -- the type must be
always convert to/from Lua concrete types <i>even if called on a different
machine or on a future date</i>. For instance don't implement pod on a type with
a file inside it (even if you're using a path to reload it) since another
machine might not have that specific path!</li>
<li>If a type may be serialized anywhere (even by an older version of the
software), do not change or reuse the <code>#id</code> of a field (changing the name is
okay if you can fix your dependencies).
<p>
<blockquote>If you need to delete the field then add it to <code>__fieldIds={...}</code> to
ensure future you doesn't use the field id.</blockquote></li>
</ul>
<p>
<h2>Usecases</h2>
Usecases of pod are:<ul>
<li>database schema: The primary intended usecase of pod is to be used in
civdb -- each "row" is simply a pod record.
<p>
<blockquote>This is likely the only usecase civlua will use</blockquote></li>
<li>general data storage: use pod.load and pod.dump to de/serialize
values to/from a file.</li>
<li>cross-language communication, see <a href="#xlang">Cross Language Tooling</a>.</li>
<li>RPC framework: pod could be used in a similar capacity as JSON RPC to
communicate with other services (i.e. frontend <-> backend).</li>
</ul>
<p>
<h2>library support</h2>
In addition to providing methods to de/serialize data to a compact binary form,
pod exports the <code>toPod()</code> and <code>fromPod()</code> functions to help other libraries
(i.e. lson) de/serialize arbitrary lua types.
<p>
<h2><a id="xlang" href="#xlang">Cross Language Tooling</h2></a>
pod is designed to (eventually) serve the same need as
<a href="https://protobuf.dev">protobuf</a>: it can and will generate code for other
languages to read/write pod's binary serialization format.
<p>
At this time, support for other languages has not started -- but the design of
pod is meant to mimick protobuf as much as possible so that such a goal can be
met in the future. Work on supporting multiple languages will likely not be
part of the civlua project but the civlua project will support such work.
<p>
<p>
<h2>Module <a id="pod" href="#pod">pod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L4"><i>src</i></a>)</h2>
pod: plain old data
<p>
<b>Values: </b> <table>
<tr>
<td><code>pod.integer</code></td>
<td>[Podder] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90">src</a>)</td>
</tr>
<tr>
<td><code>pod.string</code></td>
<td>[Podder] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90">src</a>)</td>
</tr>
</table>
<h4>Value <a id="pod.__name" href="#pod.__name">pod.__name</a></h4>
<h3>Table <a id="pod.boolean" href="#pod.boolean">pod.boolean</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90"><i>src</i></a>)</h3>
<h3>Table <a id="pod.int" href="#pod.int">pod.int</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90"><i>src</i></a>)</h3>
<h3>Table <a id="pod.nil" href="#pod.nil">pod.nil</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90"><i>src</i></a>)</h3>
<h3>Table <a id="pod.number" href="#pod.number">pod.number</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90"><i>src</i></a>)</h3>
<h3>Table <a id="pod.str" href="#pod.str">pod.str</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90"><i>src</i></a>)</h3>
<h3>Table <a id="pod.table" href="#pod.table">pod.table</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L90"><i>src</i></a>)</h3>
<h3>Record <a id="pod.List" href="#pod.List">pod.List</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L119"><i>src</i></a>)</h3>
Poder for a list of items with a type.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pod.List.I</code></td>
<td>[Podder] 
the type of each list item</td>
</tr>
</table>
<h3>Table <a id="pod.List.__docs" href="#pod.List.__docs">pod.List.__docs</a></h3>
<h3>Table <a id="pod.List.__fieldIds" href="#pod.List.__fieldIds">pod.List.__fieldIds</a></h3>
<h3>Table <a id="pod.List.__fields" href="#pod.List.__fields">pod.List.__fields</a></h3>
<h4>Value <a id="pod.List.__name" href="#pod.List.__name">pod.List.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pod.List.__index</code></td>
<td>[Ty<List>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L119">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pod.List.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="List.__fromPod" href="#List.__fromPod">List.__fromPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L129"><i>src</i></a>)</h4>
<h4>Function <a id="List.__toPod" href="#List.__toPod">List.__toPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L124"><i>src</i></a>)</h4>
<h3>Record <a id="pod.Map" href="#pod.Map">pod.Map</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L135"><i>src</i></a>)</h3>
Poder for a map of key/value pairs.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pod.Map.K</code></td>
<td>[Podder] = <code>Ty&lt;key&gt;{__docs={}, __fieldIds={}, __fields={}, __fromPod=fn"key.__toPod"[/home/rett/projects/civlua/lib/pod/pod.lua:98], __index=self, __name="key", __newindex=fn"metaty.newindex"[/home/rett/projects/civlua/lib/metaty/metaty.lua:189], __toPod=fn"key.__toPod"[/home/rett/projects/civlua/lib/pod/pod.lua:98]}</code>
keys type</td>
</tr>
<tr>
<td><code>pod.Map.V</code></td>
<td>[Podder] 
values type</td>
</tr>
</table>
<h3>Table <a id="pod.Map.__docs" href="#pod.Map.__docs">pod.Map.__docs</a></h3>
<h3>Table <a id="pod.Map.__fieldIds" href="#pod.Map.__fieldIds">pod.Map.__fieldIds</a></h3>
<h3>Table <a id="pod.Map.__fields" href="#pod.Map.__fields">pod.Map.__fields</a></h3>
<h4>Value <a id="pod.Map.__name" href="#pod.Map.__name">pod.Map.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pod.Map.__index</code></td>
<td>[Ty<Map>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L135">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pod.Map.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Map.__fromPod" href="#Map.__fromPod">Map.__fromPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L149"><i>src</i></a>)</h4>
<h4>Function <a id="Map.__toPod" href="#Map.__toPod">Map.__toPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L142"><i>src</i></a>)</h4>
<h3>Record <a id="pod.Pod" href="#pod.Pod">pod.Pod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L20"><i>src</i></a>)</h3>
Pod: configuration for converting values to/from POD.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pod.Pod.fieldIds</code></td>
<td>[boolean] 
if true use the fieldIds when possible</td>
</tr>
<tr>
<td><code>pod.Pod.mtPodFn</code></td>
<td>[(mt) -> boolean] = <code>fn"function"[/home/rett/projects/civlua/lib/pod/pod.lua:18]</code>
function to classify if mt is pod</td>
</tr>
<tr>
<td><code>pod.Pod.enumIds</code></td>
<td>[boolean] 
if true use enum id variants, else name variants</td>
</tr>
</table>
<h3>Table <a id="Pod.DEFAULT" href="#Pod.DEFAULT">Pod.DEFAULT</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L22"><i>src</i></a>)</h3>
<h3>Table <a id="pod.Pod.__docs" href="#pod.Pod.__docs">pod.Pod.__docs</a></h3>
<h3>Table <a id="pod.Pod.__fieldIds" href="#pod.Pod.__fieldIds">pod.Pod.__fieldIds</a></h3>
<h3>Table <a id="pod.Pod.__fields" href="#pod.Pod.__fields">pod.Pod.__fields</a></h3>
<h4>Value <a id="pod.Pod.__name" href="#pod.Pod.__name">pod.Pod.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pod.Pod.__index</code></td>
<td>[Ty<Pod>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L20">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pod.Pod.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Record <a id="pod.Podder" href="#pod.Podder">pod.Podder</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L52"><i>src</i></a>)</h3>
A type who's sole job is converting values to/from POD.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pod.Podder.name</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>pod.Podder.__toPod</code></td>
<td>[(self, pset, v) -> p] </td>
</tr>
<tr>
<td><code>pod.Podder.__fromPod</code></td>
<td>[(self, pset, p) -> v] </td>
</tr>
</table>
<h3>Table <a id="pod.Podder.__docs" href="#pod.Podder.__docs">pod.Podder.__docs</a></h3>
<h3>Table <a id="pod.Podder.__fieldIds" href="#pod.Podder.__fieldIds">pod.Podder.__fieldIds</a></h3>
<h3>Table <a id="pod.Podder.__fields" href="#pod.Podder.__fields">pod.Podder.__fields</a></h3>
<h4>Value <a id="pod.Podder.__name" href="#pod.Podder.__name">pod.Podder.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pod.Podder.__index</code></td>
<td>[Ty<Podder>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L52">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pod.Podder.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Podder.__tostring" href="#Podder.__tostring">Podder.__tostring</a><code>(p) -&gt; p.name</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L53"><i>src</i></a>)</h4>
<h3>Record <a id="pod.builtin" href="#pod.builtin">pod.builtin</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L103"><i>src</i></a>)</h3>
Handles all native types (nil, boolean, number, string, table)
<p>
<h3>Table <a id="pod.builtin.__docs" href="#pod.builtin.__docs">pod.builtin.__docs</a></h3>
<h3>Table <a id="pod.builtin.__fieldIds" href="#pod.builtin.__fieldIds">pod.builtin.__fieldIds</a></h3>
<h3>Table <a id="pod.builtin.__fields" href="#pod.builtin.__fields">pod.builtin.__fields</a></h3>
<h4>Value <a id="pod.builtin.__name" href="#pod.builtin.__name">pod.builtin.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pod.builtin.__index</code></td>
<td>[Ty<builtin>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L103">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pod.builtin.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="builtin.__fromPod" href="#builtin.__fromPod">builtin.__fromPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L115"><i>src</i></a>)</h4>
<h4>Function <a id="builtin.__toPod" href="#builtin.__toPod">builtin.__toPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L111"><i>src</i></a>)</h4>
<h3>Record <a id="pod.key" href="#pod.key">pod.key</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L94"><i>src</i></a>)</h3>
Handles concrete non-nil types (boolean, number, string)
<p>
<h3>Table <a id="pod.key.__docs" href="#pod.key.__docs">pod.key.__docs</a></h3>
<h3>Table <a id="pod.key.__fieldIds" href="#pod.key.__fieldIds">pod.key.__fieldIds</a></h3>
<h3>Table <a id="pod.key.__fields" href="#pod.key.__fields">pod.key.__fields</a></h3>
<h4>Value <a id="pod.key.__name" href="#pod.key.__name">pod.key.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pod.key.__index</code></td>
<td>[Ty<key>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L94">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pod.key.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>pod.key.__toPod</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L98">src</a>)</td>
</tr>
</table>
<h4>Function <a id="key.__toPod" href="#key.__toPod">key.__toPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L98"><i>src</i></a>)</h4>
<h3>Function <a id="pod.deser" href="#pod.deser">pod.deser</a><code>(str, index) -&gt; value, lenUsed</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L259"><i>src</i></a>)</h3>
Deserialize value from a compact string (and call fromPod on it)
<code>index</code> (default=1) is where to start in <code>str</code>
<h3>Function <a id="pod.deserRaw" href="#pod.deserRaw">pod.deserRaw</a><code>(string) -&gt; value</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L246"><i>src</i></a>)</h3>
deserialize the value (without calling fromPod on it)
<h3>Function <a id="pod.fromPod" href="#pod.fromPod">pod.fromPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L165"><i>src</i></a>)</h3>
<h3>Function <a id="pod.implPod" href="#pod.implPod">pod.implPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L240"><i>src</i></a>)</h3>
Make metaty type convertable to/from plain-old-data
<p>
Typically this is called by calling the module itself,
i.e. <code>pod(mty'myType'{'field [int]#1'})</code>
<h3>Function <a id="pod.isConcrete" href="#pod.isConcrete">pod.isConcrete</a><code>(v) -&gt; CONCRETE[type(v)]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L27"><i>src</i></a>)</h3>
<h3>Function <a id="pod.isPod" href="#pod.isPod">pod.isPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L45"><i>src</i></a>)</h3>
<h3>Function <a id="pod.mty_fromPod" href="#pod.mty_fromPod">pod.mty_fromPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L196"><i>src</i></a>)</h3>
Default __fromPod for metatype records
<h3>Function <a id="pod.mty_toPod" href="#pod.mty_toPod">pod.mty_toPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L186"><i>src</i></a>)</h3>
Default __toPod for metatype records
<h3>Function <a id="pod.ser" href="#pod.ser">pod.ser</a><code>(value) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L252"><i>src</i></a>)</h3>
Serialize value, converting it to a compact string.
Note: this function first calls toPod on the value.
<h3>Function <a id="pod.serRaw" href="#pod.serRaw">pod.serRaw</a><code>(value) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L243"><i>src</i></a>)</h3>
serialize the value (without calling toPod on it)
<h3>Function <a id="pod.toPod" href="#pod.toPod">pod.toPod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod.lua#L162"><i>src</i></a>)</h3>
<h3>Table <a id="pod.native" href="#pod.native">pod.native</a></h3>
<h2>Module <a id="pod.testing" href="#pod.testing">pod.testing</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod/testing.lua#L2"><i>src</i></a>)</h2>
<p>
<h3>Table <a id="pod.testing.BOOLS" href="#pod.testing.BOOLS">pod.testing.BOOLS</a></h3>
<h3>Table <a id="pod.testing.BUILTIN" href="#pod.testing.BUILTIN">pod.testing.BUILTIN</a></h3>
<h3>Table <a id="pod.testing.BYTES" href="#pod.testing.BYTES">pod.testing.BYTES</a></h3>
<h3>Table <a id="pod.testing.INTS" href="#pod.testing.INTS">pod.testing.INTS</a></h3>
<h3>Table <a id="pod.testing.LISTS" href="#pod.testing.LISTS">pod.testing.LISTS</a></h3>
<h3>Table <a id="pod.testing.MAPS" href="#pod.testing.MAPS">pod.testing.MAPS</a></h3>
<h3>Table <a id="pod.testing.STRINGS" href="#pod.testing.STRINGS">pod.testing.STRINGS</a></h3>
<h3>Table <a id="pod.testing.TABLES" href="#pod.testing.TABLES">pod.testing.TABLES</a></h3>
<h4>Value <a id="pod.testing.__name" href="#pod.testing.__name">pod.testing.__name</a></h4>
<h3>Function <a id="pod.testing.round" href="#pod.testing.round">pod.testing.round</a><code>(v, encFn, decFn, expectEncoding) -&gt; (enc, dec)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod/testing.lua#L18"><i>src</i></a>)</h3>
Test <code>eq(v, decFn(encFn(v))</code>
If expectEncoding is provided then test <code>eq(expectEncoding, encFn(v)</code>
<h3>Function <a id="pod.testing.roundList" href="#pod.testing.roundList">pod.testing.roundList</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod/testing.lua#L26"><i>src</i></a>)</h3>
<h3>Function <a id="pod.testing.testAll" href="#pod.testing.testAll">pod.testing.testAll</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pod/pod/testing.lua#L67"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_lap" href="#Package_lap">Package lap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Lua Asynchronous Protocol and helper library</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-3</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_lap">https://lua.civboot.org#Package_lap</a></td>
</tr>
</table>
LAP: Lua Asynchronous Protocol
<p>
Lua has one of the coolest yet most underutilized asynchronous programming
tools: the <code>coroutine</code> module, specifically <code>coroutine.yield</code>. Lua's <code>yield</code>
can be called from any depth, resuming execution at the callsite upon
<code>coroutine.resume</code>. This means that if we swap out traditionally blocking APIs
like <code>file:read</code> with ones that are non-blocking and yielding (i.e. by running
IO in a separate thread or using unix's <code>aio</code> interface) we use most libraries
asynchronously without changing a single line of code.
<p>
<blockquote>For an example of implementing the LAP protocol see <a href="#Package_fd">#Package_fd</a></blockquote>
<p>
LAP is a lightweight zero-dependency asynchronous protocol which aims to take
advantage of Lua's awesomeness. It is architected to allow libraries to provide
a lightweight "asynchronous mode" so that they can be used asynchronously by a
coroutine executor. This allows users and library authors to write code that
looks synchronous but which can be executed asynchronously at the application
author's discression.
<p>
This folder also contains the <code>lap.lua</code> library, see the Library section.
Library authors <b>do not</b> need to depend on this library to work with the LAP
protocol.
<p>
The LAP protocol has two components: <ul>
<li>yielding protocol: An ultra simple yet optionally-performant to communicate
with the executor loop (example: see <code>lap.Lap</code>)</li>
<li>two global tables which libraries can use to schedule coroutines (<code>LAP_READY</code>)
and register their asynchronous API (<code>LAP_FNS_ASYNC</code> and <code>LAP_FNS_SYNC</code>)</li>
</ul>
Library authors can fully support the protocol by following the
Yielding Protocol below and copy/pasting the following:
<code class="block">LAP_FNS_SYNC  = LAP_FNS_SYNC  or {}
LAP_FNS_ASYNC = LAP_FNS_ASYNC or {}

// register functions to switch modes, see end of lap.lua for example
table.insert(LAP_FNS_SYNC,  function() ... end)
table.insert(LAP_FNS_ASYNC, function() ... end)

// implement your asynchronous functions by following the protocol.</code>
<p>
Library authors should make their default API <b>synchronous</b> (blocking) by
default, except for items that cannot be used synchronously.
<p>
<h3><code>LAP_READY</code> Global Table</h3>
<code>LAP_READY</code> is a global key/value table where the keys are the coroutines which
should be run at some later time (by the executor). The values are arbitrary
(typically a string identifier for debugging).
<p>
This means that a coroutine can schedule another coroutine <code>cor</code> by simply doing
<code>LAP_READY[cor] = "my_identifier"</code>. This simple feature can be used for many
purposes such as creating Channel datastructures as well as handling any/all
behavior. See the Library section for details.
<p>
<h3><a id="lap-protocol" href="#lap-protocol">Yielding Protocol</h3></a>
LAP's yielding protocol makes it trivial for Lua libraries to interface with
executors. Libraries can simply call <code>coroutine.yield</code> with one of the
following and a compliant executor will perform the behavior specified if it is
supported (else it will run the coroutine on the next loop). <ul>
<li><code>yield(nil)</code> or <code>yield(false)</code>: forget the coroutine, the executor will not
run it.</li>
<li><code>yield(true)</code>: run the corroutine again as soon as possible. <ul>
<li>Should prevent the executor loop from sleeping.</li>
<li>Equivalent to: <code>LAP_READY[coroutine.running()] = true; coroutine.yield()</code></li>
</ul></li>
<li><code>yield("sleep", sleepSec)</code>: run the coroutine again after <code>sleepSec</code> seconds
(a float).</li>
<li><code>yield("poll", fileno, events)</code>: tell the coroutine to use unix's
<code>poll(fileno, events)</code> syscall to determine when ready.</li>
<li>Other yield values may be defined by application-specific executors.
If the executor doesn't recognize a value it can either throw an error or
treat it as <code>true</code> (aka "ready"), depending on the application requirements.</li>
</ul>
<p>
<h4><a id="lap-globals" href="#lap-globals">Global Variables</h4></a>
<p>
There are four global variables defined by the LAP protocol: <ul>
<li><code>LAP_READY</code>: contains the currently ready coroutines for the executor loop to
resume.</li>
<li><code>LAP_FNS_SYNC</code> / <code>LAP_FNS_ASYNC</code>: contains functions to switch lua to synchronous /
asynchronous modes, respectively.</li>
<li><code>LAP_ASYNC</code>: is set to true when in async mode to determine behavior at
runtime.</li>
</ul>
<p>
The sync/async tables allows a user to write code in a blocking style yet it
can be run asynchronously, such as the following. You can even switch back and
forth so that tests can be run in both modes.
<p>
<code class="block">function getLines(path, fn)
  local lines = {}
  for line in io.lines(path) do
    table.insert(lines, line)
  end
  return lines
end</code>
<p>
<blockquote>Recomendation: use <a href="#lap.async">#lap.async</a> and <a href="#lap.sync">#lap.sync</a> to switch modes</blockquote>
<p>
<h3><code>lap.lua</code> Library</h3>
The (pure lua) <a href="#lap">#lap</a> library implements: <ul>
<li><a href="#lap.Lap">#lap.Lap</a> default implementation of a single loop (aka "lap") in an
executor.</li>
<li><a href="#lap.Any">#lap.Any</a> and <a href="lap.all">lap.all</a> for interacting with lists of coroutines.</li>
<li><a href="#lap.channel()">#lap.channel()</a> which creates the <a href="#lap.Recv">#lap.Recv</a> and <a href="#lap.Send">#lap.Send</a> channel types to send
values between coroutines.</li>
<li><a href="#lap.async">#lap.async</a> / <a href="#lap.sync">#lap.sync</a>: switches all registered libraries to
async/sync mode (just calls every function in <a href="#lap.LAP_FNS_SYNC">#lap.LAP_FNS_SYNC</a> or
<a href="#LAP_FNS_ASYNC">#LAP_FNS_ASYNC</a>)</li>
</ul>
<p>
<h2>Module <a id="lap" href="#lap">lap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L4"><i>src</i></a>)</h2>
superpower your libraries run either sync or async
<p>
<h3>Table <a id="lap.LAP_UPDATE" href="#lap.LAP_UPDATE">lap.LAP_UPDATE</a></h3>
<h4>Value <a id="lap.__name" href="#lap.__name">lap.__name</a></h4>
<h3>Table <a id="lap._async" href="#lap._async">lap._async</a></h3>
<h3>Table <a id="lap._sync" href="#lap._sync">lap._sync</a></h3>
<h3>Record <a id="lap.Any" href="#lap.Any">lap.Any</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L221"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lap.Any.cor</code></td>
<td>[thread] </td>
</tr>
<tr>
<td><code>lap.Any.fns</code></td>
<td>[table] </td>
</tr>
<tr>
<td><code>lap.Any.done</code></td>
<td>[table] </td>
</tr>
</table>
<h3>Table <a id="lap.Any.__docs" href="#lap.Any.__docs">lap.Any.__docs</a></h3>
<h3>Table <a id="lap.Any.__fieldIds" href="#lap.Any.__fieldIds">lap.Any.__fieldIds</a></h3>
<h3>Table <a id="lap.Any.__fields" href="#lap.Any.__fields">lap.Any.__fields</a></h3>
<h4>Value <a id="lap.Any.__name" href="#lap.Any.__name">lap.Any.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lap.Any.__index</code></td>
<td>[Ty<Any>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L221">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lap.Any.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Any.ignore" href="#Any.ignore">Any.ignore</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L236"><i>src</i></a>)</h4>
<h4>Function <a id="Any.restart" href="#Any.restart">Any.restart</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L251"><i>src</i></a>)</h4>
<h4>Function <a id="Any.schedule" href="#Any.schedule">Any.schedule</a><code>(self) -&gt; self</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L240"><i>src</i></a>)</h4>
ensure all fns are scheduled
<h4>Function <a id="Any.yield" href="#Any.yield">Any.yield</a><code>(self) -&gt; fnIndex</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L246"><i>src</i></a>)</h4>
<h3>Record <a id="lap.Lap" href="#lap.Lap">lap.Lap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L309"><i>src</i></a>)</h3>
A single lap of the executor loop
<p>
Example <code class="block">  -- schedule your main fn, which may schedule other fns
  lap.schedule(myMainFn)

  -- create a Lap instance with the necessary configs
  local Lap = lap.Lap{
    sleepFn=civix.sleep, monoFn=civix.monoSecs, pollList=fd.PollList()
  }

  -- run repeatedly while there are coroutines to run
  while next(LAP_READY) do
    errors = Lap(); if errors then
      -- handle errors
    end
    -- do other things in your application's executor loop
  end</code>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lap.Lap.sleepFn</code></td>
<td>[function] </td>
</tr>
<tr>
<td><code>lap.Lap.monoFn</code></td>
<td>[function] </td>
</tr>
<tr>
<td><code>lap.Lap.monoHeap</code></td>
<td>[Heap] </td>
</tr>
<tr>
<td><code>lap.Lap.defaultSleep</code></td>
<td>[float] = <code>0x1.47ae147ae147bp-7</code></td>
</tr>
<tr>
<td><code>lap.Lap.pollMap</code></td>
<td>[table] </td>
</tr>
<tr>
<td><code>lap.Lap.pollList</code></td>
<td>[PollList] 
Poll list data structure. Required methods:
* __len                   to get length with `#`
* insert(fileno, events)  insert the fileno+events into the poll list
* remove(fileno)          remove the fileno from poll list
* ready(self, durationSec) -> {filenos}
poll for durationSec (float), return any ready filenos.
</td>
</tr>
</table>
<h3>Table <a id="lap.Lap.__docs" href="#lap.Lap.__docs">lap.Lap.__docs</a></h3>
<h3>Table <a id="lap.Lap.__fieldIds" href="#lap.Lap.__fieldIds">lap.Lap.__fieldIds</a></h3>
<h3>Table <a id="lap.Lap.__fields" href="#lap.Lap.__fields">lap.Lap.__fields</a></h3>
<h4>Value <a id="lap.Lap.__name" href="#lap.Lap.__name">lap.Lap.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lap.Lap.__index</code></td>
<td>[Ty<Lap>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L309">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lap.Lap.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Lap.__call" href="#Lap.__call">Lap.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L372"><i>src</i></a>)</h4>
<h4>Function <a id="Lap.execute" href="#Lap.execute">Lap.execute</a><code>(lap, cor, note) -&gt; errstr?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L329"><i>src</i></a>)</h4>
<h4>Function <a id="Lap.isDone" href="#Lap.isDone">Lap.isDone</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L375"><i>src</i></a>)</h4>
<h4>Function <a id="Lap.poll" href="#Lap.poll">Lap.poll</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L317"><i>src</i></a>)</h4>
<h4>Function <a id="Lap.run" href="#Lap.run">Lap.run</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L395"><i>src</i></a>)</h4>
<h4>Function <a id="Lap.sleep" href="#Lap.sleep">Lap.sleep</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L316"><i>src</i></a>)</h4>
<h3>Record <a id="lap.Recv" href="#lap.Recv">lap.Recv</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L97"><i>src</i></a>)</h3>
<code>Recv() -&gt; recv</code> the receive side of channel.
<p>
Is considered closed when all senders are closed.
<p>
Notes: <ul>
<li>Use <code>recv:sender()</code> to create a sender. You can create
multiple senders.</li>
<li>Use <code>recv:recv()</code> or simply <code>recv()</code> to receive a value
(or block)</li>
<li>User <code>sender:send(v)</code> or simply <code>sender(v)</code> to send a value.</li>
<li><code>recv:close()</code> when done. Also closes all senders.</li>
<li><code>#recv</code> gets number of items buffered.</li>
<li><code>recv:isDone()</code> returns true when either recv is closed
OR all senders are closed and <code>#recv == 0</code></li>
</ul>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lap.Recv.deq</code></td>
<td>[Deq] </td>
</tr>
<tr>
<td><code>lap.Recv._sends</code></td>
<td>[WeakKV] </td>
</tr>
<tr>
<td><code>lap.Recv.cor</code></td>
<td>[thread] </td>
</tr>
</table>
<h3>Table <a id="lap.Recv.__docs" href="#lap.Recv.__docs">lap.Recv.__docs</a></h3>
<h3>Table <a id="lap.Recv.__fieldIds" href="#lap.Recv.__fieldIds">lap.Recv.__fieldIds</a></h3>
<h3>Table <a id="lap.Recv.__fields" href="#lap.Recv.__fields">lap.Recv.__fields</a></h3>
<h4>Value <a id="lap.Recv.__name" href="#lap.Recv.__name">lap.Recv.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lap.Recv.__index</code></td>
<td>[Ty<Recv>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L97">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lap.Recv.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>lap.Recv.close</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L107">src</a>)</td>
</tr>
<tr>
<td><code>lap.Recv.recv</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L128">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Recv.recv" href="#Recv.recv">Recv.recv</a><code>(r) -&gt; r.deq()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L128"><i>src</i></a>)</h4>
<h4>Function <a id="Recv.close" href="#Recv.close">Recv.close</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L107"><i>src</i></a>)</h4>
Close read side and all associated sends.
<h4>Function <a id="Recv.__fmt" href="#Recv.__fmt">Recv.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L136"><i>src</i></a>)</h4>
<h4>Function <a id="Recv.__len" href="#Recv.__len">Recv.__len</a><code>(r) -&gt; #r.deq</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L109"><i>src</i></a>)</h4>
<h4>Function <a id="Recv.drain" href="#Recv.drain">Recv.drain</a><code>(r) -&gt; r.deq:drain()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L131"><i>src</i></a>)</h4>
drain the recv. This does NOT wait for new items.
<h4>Function <a id="Recv.hasSender" href="#Recv.hasSender">Recv.hasSender</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L122"><i>src</i></a>)</h4>
<h4>Function <a id="Recv.isClosed" href="#Recv.isClosed">Recv.isClosed</a><code>(r) -&gt; r._s</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L110"><i>src</i></a>)</h4>
<h4>Function <a id="Recv.isDone" href="#Recv.isDone">Recv.isDone</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L114"><i>src</i></a>)</h4>
<h4>Function <a id="Recv.sender" href="#Recv.sender">Recv.sender</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L119"><i>src</i></a>)</h4>
<h4>Function <a id="Recv.wait" href="#Recv.wait">Recv.wait</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L127"><i>src</i></a>)</h4>
<h3>Record <a id="lap.Send" href="#lap.Send">lap.Send</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L144"><i>src</i></a>)</h3>
Sender, created through <code>recv:sender()</code>
Is considered closed if the receiver is closed.  The receiver will
automatically close if it is garbage collected.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lap.Send._recv</code></td>
<td>[Recv] </td>
</tr>
</table>
<b>Values: </b> <table>
<tr>
<td><code>lap.Send.__mode</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="lap.Send.__docs" href="#lap.Send.__docs">lap.Send.__docs</a></h3>
<h3>Table <a id="lap.Send.__fieldIds" href="#lap.Send.__fieldIds">lap.Send.__fieldIds</a></h3>
<h3>Table <a id="lap.Send.__fields" href="#lap.Send.__fields">lap.Send.__fields</a></h3>
<h4>Value <a id="lap.Send.__name" href="#lap.Send.__name">lap.Send.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lap.Send.__index</code></td>
<td>[Ty<Send>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L144">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lap.Send.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>lap.Send.close</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L157">src</a>)</td>
</tr>
<tr>
<td><code>lap.Send.push</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L163">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Send.push" href="#Send.push">Send.push</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L163"><i>src</i></a>)</h4>
<h4>Function <a id="Send.close" href="#Send.close">Send.close</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L157"><i>src</i></a>)</h4>
<h4>Function <a id="Send.__fmt" href="#Send.__fmt">Send.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L184"><i>src</i></a>)</h4>
<h4>Function <a id="Send.__len" href="#Send.__len">Send.__len</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L181"><i>src</i></a>)</h4>
<h4>Function <a id="Send.extend" href="#Send.extend">Send.extend</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L167"><i>src</i></a>)</h4>
<h4>Function <a id="Send.extendLeft" href="#Send.extendLeft">Send.extendLeft</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L177"><i>src</i></a>)</h4>
<h4>Function <a id="Send.isClosed" href="#Send.isClosed">Send.isClosed</a><code>(s) -&gt; s._recv == nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L159"><i>src</i></a>)</h4>
<h4>Function <a id="Send.pushLeft" href="#Send.pushLeft">Send.pushLeft</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L172"><i>src</i></a>)</h4>
<h3>Function <a id="lap.all" href="#lap.all">lap.all</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L406"><i>src</i></a>)</h3>
<h3>Function <a id="lap.async" href="#lap.async">lap.async</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L51"><i>src</i></a>)</h3>
Switch lua to asynchronous (yielding) mode
<h3>Function <a id="lap.formatCorErrors" href="#lap.formatCorErrors">lap.formatCorErrors</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L37"><i>src</i></a>)</h3>
<h3>Function <a id="lap.lt1" href="#lap.lt1">lap.lt1</a><code>(a, b) -&gt; a[1] &lt; b[1]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L255"><i>src</i></a>)</h3>
<h3>Function <a id="lap.schedule" href="#lap.schedule">lap.schedule</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L406"><i>src</i></a>)</h3>
<h3>Function <a id="lap.sync" href="#lap.sync">lap.sync</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L44"><i>src</i></a>)</h3>
Switch lua to synchronous mode
<h3>Function <a id="lap.yield" href="#lap.yield">lap.yield</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lap/lap.lua#L406"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_fd" href="#Package_fd">Package fd</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>filedescriptor interfaces</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-7</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_fd">https://lua.civboot.org#Package_fd</a></td>
</tr>
</table>
fd: synchronous and asynchronous file descriptors
<p>
fd implements an API identical to lua's <code>file</code> object but with support for
async operations following the <a href="https://github.com/civboot/civlua/blob/main/lib/lap">lib/lap</a> protocol.
<p>
<h2>Module <a id="fd" href="#fd">fd</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L6"><i>src</i></a>)</h2>
filedescriptor: direct control of filedescriptors.
async operations support the LAP (see lib/lap) protocol.
<p>
Can override default `io` module for global async mode.
<p>
<h3>Table <a id="fd.FD" href="#fd.FD">fd.FD</a></h3>
<h3>Table <a id="fd.FDT" href="#fd.FDT">fd.FDT</a></h3>
<h3>Table <a id="fd.FMODE" href="#fd.FMODE">fd.FMODE</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L34"><i>src</i></a>)</h3><code class="block">M.FMODE = mty.enum'FMODE' {
  sock = S.S_IFSOCK, link = S.S_IFLNK, file = S.S_IFREG,
  blk = S.S_IFBLK,  dir = S.S_IFDIR,  chr = S.S_IFCHR,
  fifo = S.S_IFIFO,
}</code>
<h4>Value <a id="fd.PIPE_BUF" href="#fd.PIPE_BUF">fd.PIPE_BUF</a></h4>
<h3>Table <a id="fd.PollList" href="#fd.PollList">fd.PollList</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L255"><i>src</i></a>)</h3><code class="block">M.PollList = setmetatable({
__name='PollList',
__index = {
  __len = function(pl) return pl._pl:size() - #pl.avail end,
  resize = function(pl, newSize)
    local size = pl._pl:size(); assert(newSize &gt;= size, 'attempted shrink')
    pl._pl:resize(newSize); for i=size,newSize-1 do push(pl.avail, i) end
  end,
  insert = function(pl, fileno, events)
    local i = pl.map[fileno] or pop(pl.avail)
    if not i then
      pl:resize((pl._pl:size() == 0) and 8 or pl._pl.size() * 2)
      i = assert(pop(pl.avail), 'failed to resize')
    end
    pl._pl:set(i, fileno, events)
    pl.map[fileno] = i
  end,
  ready = function(pl, timeoutSec)
    return pl._pl:ready(math.floor(timeoutSec * 1000))
  end,
  remove = function(pl, fileno)
    local i = assert(pl.map[fileno])
    push(pl.avail, i); pl.map[fileno] = nil;
    pl._pl:set(i, -1, 0)
  end,
}}, {
  __call=function(ty_)
    return setmetatable({
      _pl=S.pollList(),
      map  = {}, -- map of fileno -&gt; pl[index]
      avail = {}, -- list of available indexes
    }, ty_)
  end,
})</code>
<h4>Value <a id="fd.__name" href="#fd.__name">fd.__name</a></h4>
<h3>Table <a id="fd.io" href="#fd.io">fd.io</a></h3>
<h4>Value <a id="fd.stdin" href="#fd.stdin">fd.stdin</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L304"><i>src</i></a>)</h4>
<h4>Value <a id="fd.stdout" href="#fd.stdout">fd.stdout</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L305"><i>src</i></a>)</h4>
<h3>Table <a id="fd.sys" href="#fd.sys">fd.sys</a></h3>
<h3>Function <a id="fd.close" href="#fd.close">fd.close</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L272"><i>src</i></a>)</h3>
<h3>Function <a id="fd.fileno" href="#fd.fileno">fd.fileno</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L325"><i>src</i></a>)</h3>
<h3>Function <a id="fd.finishRunning" href="#fd.finishRunning">fd.finishRunning</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L73"><i>src</i></a>)</h3>
<h3>Function <a id="fd.flush" href="#fd.flush">fd.flush</a><code>() -&gt; M.output():flush()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L309"><i>src</i></a>)</h3>
<h3>Function <a id="fd.ftype" href="#fd.ftype">fd.ftype</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L329"><i>src</i></a>)</h3>
<h3>Function <a id="fd.input" href="#fd.input">fd.input</a><code>() -&gt; M.stdin</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L307"><i>src</i></a>)</h3>
<h3>Function <a id="fd.ioAsync" href="#fd.ioAsync">fd.ioAsync</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L364"><i>src</i></a>)</h3>
<h3>Function <a id="fd.ioSync" href="#fd.ioSync">fd.ioSync</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L361"><i>src</i></a>)</h3>
<h3>Function <a id="fd.isatty" href="#fd.isatty">fd.isatty</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L333"><i>src</i></a>)</h3>
<h3>Function <a id="fd.lines" href="#fd.lines">fd.lines</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L297"><i>src</i></a>)</h3>
<h3>Function <a id="fd.modifiedEq" href="#fd.modifiedEq">fd.modifiedEq</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L80"><i>src</i></a>)</h3>
return whether two fstat's have equal modification times
<h3>Function <a id="fd.newFD" href="#fd.newFD">fd.newFD</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L61"><i>src</i></a>)</h3>
<h3>Function <a id="fd.newFDT" href="#fd.newFDT">fd.newFDT</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L61"><i>src</i></a>)</h3>
<h3>Function <a id="fd.open" href="#fd.open">fd.open</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L271"><i>src</i></a>)</h3>
<h3>Function <a id="fd.openFD" href="#fd.openFD">fd.openFD</a><code>(...) -&gt; M.openWith(S.openFD, ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L267"><i>src</i></a>)</h3>
<h3>Function <a id="fd.openFDT" href="#fd.openFDT">fd.openFDT</a><code>(...) -&gt; M.openWith(S.openFDT, ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L268"><i>src</i></a>)</h3>
<h3>Function <a id="fd.openFileno" href="#fd.openFileno">fd.openFileno</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L303"><i>src</i></a>)</h3>
<h3>Function <a id="fd.openWith" href="#fd.openWith">fd.openWith</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L266"><i>src</i></a>)</h3>
<h3>Function <a id="fd.output" href="#fd.output">fd.output</a><code>() -&gt; M.stdout</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L308"><i>src</i></a>)</h3>
<h3>Function <a id="fd.read" href="#fd.read">fd.read</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L285"><i>src</i></a>)</h3>
<h3>Function <a id="fd.tmpfileFn" href="#fd.tmpfileFn">fd.tmpfileFn</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L277"><i>src</i></a>)</h3>
<h3>Function <a id="fd.type" href="#fd.type">fd.type</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L319"><i>src</i></a>)</h3>
<h3>Function <a id="fd.write" href="#fd.write">fd.write</a><code>(...) -&gt; M.output():write(...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L298"><i>src</i></a>)</h3>
<p>
<h2>Module <a id="fd(async)" href="#fd(async)">fd(async)</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L57"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="fd._async.__name" href="#fd._async.__name">fd._async.__name</a></h4>
<h3>Function <a id="fd(async).tmpfile" href="#fd(async).tmpfile">fd(async).tmpfile</a><code>() -&gt; M.tmpfileFn(S.tmpFDT)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L279"><i>src</i></a>)</h3>
<h2>Module <a id="fd(sync)" href="#fd(sync)">fd(sync)</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L56"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="fd._sync.__name" href="#fd._sync.__name">fd._sync.__name</a></h4>
<h3>Function <a id="fd(sync).tmpfile" href="#fd(sync).tmpfile">fd(sync).tmpfile</a><code>() -&gt; M.tmpfileFn(S.tmpFD)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/fd/fd.lua#L278"><i>src</i></a>)</h3>
<code>fd.sys</code>        | [table] 
<p>
<h1><a id="Package_civix" href="#Package_civix">Package civix</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Unix sys library</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-8</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_civix">https://lua.civboot.org#Package_civix</a></td>
</tr>
</table>
Civboot's unix system library
<p>
Civix contains standard unix functions that exist in most language's "sys"
library such as <code>sleep</code>, <code>epoch</code> etc. It also contains a powerful <code>Sh{}</code> type
and convieience <code>sh()</code> function for executing system shell commands, either
synchronously or asynchronously using the LAP protocol (see <a href="#Package_lap">#Package_lap</a>.
<p>
<code class="block">$ lua
&gt; sh = require'civix'.sh
&gt; print(sh'ls some/path')
&gt; -- cat /var/log/syslog | grep "netgroup: version"
&gt; out = sh{stdin=io.open'/var/log/syslog', 'grep', 'netgroup: version'}
&gt; for line in require'ds'.lines(out) do ... something per line ... end</code>
<p>
<blockquote>Civix depends on the <a href="#Package_fd">#Package_fd</a> library for async file descriptors and
other filedescriptor functionality.</blockquote>
<p>
<h2>Module <a id="civix" href="#civix">civix</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L2"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="civix.BLK" href="#civix.BLK">civix.BLK</a></h4>
<h4>Value <a id="civix.CHR" href="#civix.CHR">civix.CHR</a></h4>
<h4>Value <a id="civix.DIR" href="#civix.DIR">civix.DIR</a></h4>
<h4>Value <a id="civix.FIFO" href="#civix.FIFO">civix.FIFO</a></h4>
<h4>Value <a id="civix.FILE" href="#civix.FILE">civix.FILE</a></h4>
<h4>Value <a id="civix.LINK" href="#civix.LINK">civix.LINK</a></h4>
<h3>Table <a id="civix.SH_SET" href="#civix.SH_SET">civix.SH_SET</a></h3>
<h4>Value <a id="civix.SOCK" href="#civix.SOCK">civix.SOCK</a></h4>
<h4>Value <a id="civix.__name" href="#civix.__name">civix.__name</a></h4>
<h3>Record <a id="civix.Sh" href="#civix.Sh">civix.Sh</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L301"><i>src</i></a>)</h3>
Start args on the shell
<blockquote>Suggestion: use civix.sh instead.</blockquote>
<p>
<code>Sh:start()</code> kicks off a subprocess which start the shell using the fds
you pass in or creating them if you set them to true. Created file
descriptors will be stored in the associated name.
<p>
<blockquote>Why? This means that <code>:close()</code> will only close filedescriptors created
by the shell itself, and you won't accidentially close
io.stdout/etc.</blockquote>
<p>
Examples (see civix.sh for more examples): <table>
<tr>
<th>Lua</th>
<th>Bash</th>
</tr>
<tr>
<td><code>Sh({'ls', 'foo/bar'}, {stdout=io.stdout}):start()</code></td>
<td><code>ls foo/bar</code></td>
</tr>
<tr>
<td><code>v = Sh{'ls foo/bar', stdout=true}:start():read()</code></td>
<td><code>v=$(ls foo/bar)</code></td>
</tr>
</table>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>civix.Sh.args</code></td>
<td>[table] 
arguments to pass to shell</td>
</tr>
<tr>
<td><code>civix.Sh.stdin</code></td>
<td>[file</td>
<td>bool] 
shell's stdin to send  (default=empty)</td>
</tr>
<tr>
<td><code>civix.Sh.stdout</code></td>
<td>[file</td>
<td>bool] 
shell's stdout              (default=empty)</td>
</tr>
<tr>
<td><code>civix.Sh.stderr</code></td>
<td>[file</td>
<td>bool] 
shell's stderr              (default=empty)</td>
</tr>
<tr>
<td><code>civix.Sh.env</code></td>
<td>[list] 
shell's environment {'FOO=bar', ...}</td>
</tr>
<tr>
<td><code>civix.Sh._sh</code></td>
<td>[userdata] 
internal C implemented shell</td>
</tr>
</table>
<h3>Table <a id="civix.Sh.__docs" href="#civix.Sh.__docs">civix.Sh.__docs</a></h3>
<h3>Table <a id="civix.Sh.__fieldIds" href="#civix.Sh.__fieldIds">civix.Sh.__fieldIds</a></h3>
<h3>Table <a id="civix.Sh.__fields" href="#civix.Sh.__fields">civix.Sh.__fields</a></h3>
<h4>Value <a id="civix.Sh.__name" href="#civix.Sh.__name">civix.Sh.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>civix.Sh.__index</code></td>
<td>[Ty<Sh>] (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L301">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>civix.Sh.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Sh.finish" href="#Sh.finish">Sh.finish</a><code>(sh, other) -&gt; out, err</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L363"><i>src</i></a>)</h4>
finish files (in sh or other) by writing other.input to stdin and reading
stdout/stderr.  All processes are done asynchronously
<h4>Function <a id="Sh.isDone" href="#Sh.isDone">Sh.isDone</a><code>(sh) -&gt; sh._sh:isDone()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L331"><i>src</i></a>)</h4>
<h4>Function <a id="Sh.read" href="#Sh.read">Sh.read</a><code>(sh, ...) -&gt; sh.stdout:read(...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L365"><i>src</i></a>)</h4>
<h4>Function <a id="Sh.start" href="#Sh.start">Sh.start</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L329"><i>src</i></a>)</h4>
start the shell in the background.
Example: <code>sh{arg1, arg2, stdin=nostdin, stdout=true, stderr=io.stderr}</code>
<blockquote>Note: See Sh for how filedescriptors are set</blockquote>
<h4>Function <a id="Sh.wait" href="#Sh.wait">Sh.wait</a><code>(sh) -&gt; int</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L339"><i>src</i></a>)</h4>
wait for shell to complete, returns return code
<h4>Function <a id="Sh.write" href="#Sh.write">Sh.write</a><code>(sh, ...) -&gt; sh.stdin:write(...)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L364"><i>src</i></a>)</h4>
<h3>Record <a id="civix.ShFin" href="#civix.ShFin">civix.ShFin</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L344"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>civix.ShFin.stdin</code></td>
<td>[file] </td>
</tr>
<tr>
<td><code>civix.ShFin.stdout</code></td>
<td>[file] </td>
</tr>
<tr>
<td><code>civix.ShFin.stderr</code></td>
<td>[file] </td>
</tr>
<tr>
<td><code>civix.ShFin.input</code></td>
<td>[string] 
write to then close stdin (either self's or shell's)</td>
</tr>
</table>
<h3>Table <a id="civix.ShFin.__docs" href="#civix.ShFin.__docs">civix.ShFin.__docs</a></h3>
<h3>Table <a id="civix.ShFin.__fieldIds" href="#civix.ShFin.__fieldIds">civix.ShFin.__fieldIds</a></h3>
<h3>Table <a id="civix.ShFin.__fields" href="#civix.ShFin.__fields">civix.ShFin.__fields</a></h3>
<h4>Value <a id="civix.ShFin.__name" href="#civix.ShFin.__name">civix.ShFin.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>civix.ShFin.__index</code></td>
<td>[Ty<ShFin>] (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L344">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>civix.ShFin.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Record <a id="civix.Walk" href="#civix.Walk">civix.Walk</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L152"><i>src</i></a>)</h3>
Walk the directory tree as a iterator of <code>path, ftype</code>. Can walk either a
single path <code>Walk'path/'</code> or a list of paths <code>Walk{'a/', 'b.txt'}</code>. <ul>
<li>Note: all <code>ftype=='dir'</code> paths end in <code>/</code>.</li>
<li>Warning: you may want to handle <code>ftype=='error'</code></li>
</ul>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>civix.Walk.maxDepth</code></td>
<td>[int] 
maximum depth to walk (default=infinite)</td>
</tr>
<tr>
<td><code>civix.Walk.pi</code></td>
<td>[int] = <code>0</code>
the current (root) path being walked</td>
</tr>
<tr>
<td><code>civix.Walk._dirs</code></td>
<td>[table] 
a stack of WalkDirs that are being walked</td>
</tr>
</table>
<h3>Table <a id="civix.Walk.__docs" href="#civix.Walk.__docs">civix.Walk.__docs</a></h3>
<h3>Table <a id="civix.Walk.__fieldIds" href="#civix.Walk.__fieldIds">civix.Walk.__fieldIds</a></h3>
<h3>Table <a id="civix.Walk.__fields" href="#civix.Walk.__fields">civix.Walk.__fields</a></h3>
<h4>Value <a id="civix.Walk.__name" href="#civix.Walk.__name">civix.Walk.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>civix.Walk.__index</code></td>
<td>[Ty<Walk>] (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L152">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>civix.Walk.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Walk.__call" href="#Walk.__call">Walk.__call</a><code>(w) -&gt; path, ftype</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L175"><i>src</i></a>)</h4>
<h4>Function <a id="Walk._deeper" href="#Walk._deeper">Walk._deeper</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L181"><i>src</i></a>)</h4>
walk one level deeper by pushing onto _dirs stack.
<h4>Function <a id="Walk.depth" href="#Walk.depth">Walk.depth</a><code>(w) -&gt; #w._dirs</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L159"><i>src</i></a>)</h4>
- get the depth of the current directory being walked
<h4>Function <a id="Walk.skip" href="#Walk.skip">Walk.skip</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L161"><i>src</i></a>)</h4>
skip the current directory level
<h3>Record <a id="civix._WalkDir" href="#civix._WalkDir">civix._WalkDir</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L188"><i>src</i></a>)</h3>
Walk a single directory
<p>
<b>Fields: </b> <table>
<tr>
<td><code>civix._WalkDir.ftypes</code></td>
<td>[table] 
path -> ftype map</td>
</tr>
<tr>
<td><code>civix._WalkDir._i</code></td>
<td>[int] 
current index</td>
</tr>
<tr>
<td><code>civix._WalkDir.base</code></td>
<td>[string] 
base directory</td>
</tr>
</table>
<h3>Table <a id="civix._WalkDir.__docs" href="#civix._WalkDir.__docs">civix._WalkDir.__docs</a></h3>
<h3>Table <a id="civix._WalkDir.__fieldIds" href="#civix._WalkDir.__fieldIds">civix._WalkDir.__fieldIds</a></h3>
<h3>Table <a id="civix._WalkDir.__fields" href="#civix._WalkDir.__fields">civix._WalkDir.__fields</a></h3>
<h4>Value <a id="civix._WalkDir.__name" href="#civix._WalkDir.__name">civix._WalkDir.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>civix._WalkDir.__index</code></td>
<td>[Ty<_WalkDir>] (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L188">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>civix._WalkDir.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="_WalkDir.__call" href="#_WalkDir.__call">_WalkDir.__call</a><code>(wd, walk) -&gt; path, ftype</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L207"><i>src</i></a>)</h4>
<h3>Function <a id="civix.Lap" href="#civix.Lap">civix.Lap</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L276"><i>src</i></a>)</h3>
<h3>Function <a id="civix._sh" href="#civix._sh">civix._sh</a><code>(cmd) -&gt; Sh</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L383"><i>src</i></a>)</h3>
<h3>Function <a id="civix.dir" href="#civix.dir">civix.dir</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted
<h3>Function <a id="civix.epoch" href="#civix.epoch">civix.epoch</a><code>() -&gt; ds.Epoch(lib.epoch())</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L73"><i>src</i></a>)</h3>
Return the Epoch/Mono time
Time according to realtime clock
<h3>Function <a id="civix.exists" href="#civix.exists">civix.exists</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted
<h3>Function <a id="civix.isDir" href="#civix.isDir">civix.isDir</a><code>(path) -&gt; M.pathtype(path) == 'dir'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L91"><i>src</i></a>)</h3>
<h3>Function <a id="civix.isFile" href="#civix.isFile">civix.isFile</a><code>(path) -&gt; M.pathtype(path) == 'file'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L90"><i>src</i></a>)</h3>
<h3>Function <a id="civix.ls" href="#civix.ls">civix.ls</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L219"><i>src</i></a>)</h3>
A very simple ls (list paths) implementation
Returns (files, dirs) tables. Anything that is not a directory
is treated as a file.
<h3>Function <a id="civix.mkDir" href="#civix.mkDir">civix.mkDir</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L238"><i>src</i></a>)</h3>
<h3>Function <a id="civix.mkDirs" href="#civix.mkDirs">civix.mkDirs</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L234"><i>src</i></a>)</h3>
<h3>Function <a id="civix.mkTree" href="#civix.mkTree">civix.mkTree</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L272"><i>src</i></a>)</h3>
mkTree(tree) builds a tree of files and dirs at `dir` <ul>
<li>Dirs  are tables.</li>
<li>Files are string or fd -- which are read+closed.</li>
</ul>
Example: <code class="block">tree = {
  a = {
    ['a1.txt'] = 'stuff in a1.txt',
    ['a2.txt'] = 'stuff in a.txt',
    a3 = {
      ['a4.txt'] = io.open'some/file.txt',
    }
  }
}</code>
<p>
Builds a tree like <code class="block">a/a1.txt    # content: stuff in a1.txt
a/a2.txt    # content: stuff in a2.txt
a/a3/a4.txt # content: stuff in a3.txt</code>
<h3>Function <a id="civix.mono" href="#civix.mono">civix.mono</a><code>() -&gt; ds.Duration(lib.mono())</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L75"><i>src</i></a>)</h3>
Duration according to monotomically incrementing clock.
<h3>Function <a id="civix.monoSec" href="#civix.monoSec">civix.monoSec</a><code>() -&gt; M.mono():asSeconds()</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L76"><i>src</i></a>)</h3>
<h3>Function <a id="civix.mv" href="#civix.mv">civix.mv</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted
<h3>Function <a id="civix.pathtype" href="#civix.pathtype">civix.pathtype</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L89"><i>src</i></a>)</h3>
<h3>Function <a id="civix.quote" href="#civix.quote">civix.quote</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L57"><i>src</i></a>)</h3>
quote the str if it's possible
<h3>Function <a id="civix.rm" href="#civix.rm">civix.rm</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted
<h3>Function <a id="civix.rmRecursive" href="#civix.rmRecursive">civix.rmRecursive</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L224"><i>src</i></a>)</h3>
<h3>Function <a id="civix.rmdir" href="#civix.rmdir">civix.rmdir</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted
<h3>Function <a id="civix.setmodified" href="#civix.setmodified">civix.setmodified</a><code>(fileno, sec, nsec) -&gt; error?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L48"><i>src</i></a>)</h3>
set the modified time of the fileno
<h3>Function <a id="civix.sh" href="#civix.sh">civix.sh</a><code>(cmd) -&gt; out, err, sh</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L410"><i>src</i></a>)</h3>
Execute the command in another process via execvp (system shell). Throws an
error if the command fails.
<p>
if cmd is a table, the following keys are treated as special. If you need any
of these then you must use M.Sh directly (recommendation: use Plumb) <ul>
<li><code>stdin[string|file]</code> the process's stdin. If string it will be sent to stdin.</li>
<li><code>stdout[file]</code> the process's stdout. out will be nil if this is set</li>
<li><code>stderr[file]</code> the process's stderr (default=io.stderr)</li>
</ul>
<p>
Note: use <code>Plumb{...}:run()</code> if you want to pipe multiple shells together.
<table>
<tr>
<th>Command                               Bash</th>
</tr>
<tr>
<td><code>sh'ls foo/bar'</code></td>
<td><code>ls foo/bar</code></td>
</tr>
<tr>
<td><code>sh{'ls', 'foo/bar', 'dir w spc/'}</code></td>
<td><code>ls foo/bar "dir w spc/"</code></td>
</tr>
<tr>
<td><code>sh{stdin='sent to stdin', 'cat'}</code></td>
<td><code>echo "sent to stdin" | cat</code></td>
</tr>
</table>
<h3>Function <a id="civix.sleep" href="#civix.sleep">civix.sleep</a><code>(d) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L69"><i>src</i></a>)</h3>
Sleep for the specified duration
<h3>Function <a id="civix.stat" href="#civix.stat">civix.stat</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L45"><i>src</i></a>)</h3>
get the stat of the path, which has methods <ul>
<li><code>:mode() -&gt; mode</code> see FMODE</li>
<li><code>:modified() -&gt; sec, nsec</code> time modified</li>
</ul>
<h3>Function <a id="civix.walk" href="#civix.walk">civix.walk</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civix/civix.lua#L141"><i>src</i></a>)</h3>
TODO: remove this
walk the paths up to depth, calling <code>ftypeFns[ftype]</code> for
each item encountered.
<p>
If depth is nil/false then the depth is infinite.
<p>
ftypeFns must be a table of ftypes (file, dir) and: <ul>
<li>default: called as fallback (if missing ftype key)</li>
<li>error: called if determining the type caused an error,
typically due to the file not existing.
the call is: error(path, errstr)</li>
<li>dirDone: called AFTER the directory has been walked</li>
</ul>
<p>
The Fn signatures are: (path, ftype) -> stopWalk
If either return true then the walk is ended immediately
If dirFn returns 'skip' then the directory is skipped
<h3>Table <a id="civix.lib" href="#civix.lib">civix.lib</a></h3>
<p>
<h1><a id="Package_lson" href="#Package_lson">Package lson</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>JSON+ de/serializer in pure lua</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_lson">https://lua.civboot.org#Package_lson</a></td>
</tr>
</table>
JSON+ de/serializer in pure lua
<p>
This folder defines an LSON spec and an example public domain pure-lua
implementation of LSON/JSON encoder and decoder.
<p>
<h3>Lua Library</h3>
lson is a pure-lua JSON+ de/serialization library. The main functions are
the encoding functions <code>json()</code> and <code>lson()</code> and the  <code>decode()</code> function
(which decodes either encoder's output).
<p>
See also the types <a href="#lson.Json">#lson.Json</a>, <a href="#lson.Lson">#lson.Lson</a> and <a href="#lson.Decoder">#lson.Decoder</a> and
their documentation to have more control of the usage, including pretty printing
and a decoding iterator.
<p>
<blockquote>Note: If you want highly performant or compliant JSON library then use a
different one. This library is part of the civlua project and is optimized for
simplicy and improved features.</blockquote>
<p>
<h3><a id="lson-spec" href="#lson-spec">LSON spec</h3></a>
LSON is a strict superset of JSON: all valid JSON is valid LSON but not vice
versa. The difference is: <ul>
<li>LSON ignores commas (it treats them as whitespace). List and map entries can
be separated by any whitespace (including commas). This makes it easier for
a human to write and vcs to diff.</li>
<li>LSON adds binary syntax for bytes <code>|any binary data|</code>. The data within</li>
<li><code>|...|</code> is arbitrary bytes except the following will be converted:
<code>\\ -&gt; \   \| -&gt; |    \n -&gt; newline</code>
Other "escapes" are preserved, i.e. <code>\d -&gt; \d</code>. This makes encoding binary
data in LSON MUCH more compact (and possible) than JSON.</li>
</ul>
<p>
<h2>Module <a id="lson" href="#lson">lson</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L2"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="lson.__name" href="#lson.__name">lson.__name</a></h4>
<h3>Record <a id="lson.De" href="#lson.De">lson.De</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L225"><i>src</i></a>)</h3>
<code>De(string or lines) -&gt; value-iter</code>
<code>for val in De'["my", "lson"]' do ... end</code>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lson.De.dat</code></td>
<td>[lines] 
lines-like data to parse</td>
</tr>
<tr>
<td><code>lson.De.null</code></td>
<td>[any] = <code>none</code>
value to use for null</td>
</tr>
<tr>
<td><code>lson.De.l</code></td>
<td>[int] </td>
</tr>
<tr>
<td><code>lson.De.c</code></td>
<td>[int] </td>
</tr>
<tr>
<td><code>lson.De.line</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="lson.De.__docs" href="#lson.De.__docs">lson.De.__docs</a></h3>
<h3>Table <a id="lson.De.__fieldIds" href="#lson.De.__fieldIds">lson.De.__fieldIds</a></h3>
<h3>Table <a id="lson.De.__fields" href="#lson.De.__fields">lson.De.__fields</a></h3>
<h4>Value <a id="lson.De.__name" href="#lson.De.__name">lson.De.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lson.De.__index</code></td>
<td>[Ty<De>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L225">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lson.De.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="De.__call" href="#De.__call">De.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L268"><i>src</i></a>)</h4>
<h4>Function <a id="De.assert" href="#De.assert">De.assert</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L233"><i>src</i></a>)</h4>
<h4>Function <a id="De.consume" href="#De.consume">De.consume</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L260"><i>src</i></a>)</h4>
<h4>Function <a id="De.skipWs" href="#De.skipWs">De.skipWs</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L249"><i>src</i></a>)</h4>
<h3>Record <a id="lson.Json" href="#lson.Json">lson.Json</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L52"><i>src</i></a>)</h3>
Json Encoder (via fmt.Fmt)
This works identically to metaty.Fmt except it overrides
how tables are formatted to use JSON instead of printing them.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lson.Json.style</code></td>
<td>[bool] 
enable styling. If true, set <code>to=Styler</code></td>
</tr>
<tr>
<td><code>lson.Json.to</code></td>
<td>[file?] 
if set calls write</td>
</tr>
<tr>
<td><code>lson.Json.keyEnd</code></td>
<td>[string] = <code>","</code></td>
</tr>
<tr>
<td><code>lson.Json.keySet</code></td>
<td>[string] = <code>":"</code></td>
</tr>
<tr>
<td><code>lson.Json.indexEnd</code></td>
<td>[string] = <code>","</code></td>
</tr>
<tr>
<td><code>lson.Json.tableStart</code></td>
<td>[string] = <code>"{"</code></td>
</tr>
<tr>
<td><code>lson.Json.tableEnd</code></td>
<td>[string] = <code>"}"</code></td>
</tr>
<tr>
<td><code>lson.Json.listEnd</code></td>
<td>= <code>]"</code></td>
</tr>
<tr>
<td><code>lson.Json.indent</code></td>
<td>[string] = <code>"  "</code></td>
</tr>
<tr>
<td><code>lson.Json.maxIndent</code></td>
<td>[int] = <code>20</code></td>
</tr>
<tr>
<td><code>lson.Json.numfmt</code></td>
<td>[string] = <code>"%q"</code></td>
</tr>
<tr>
<td><code>lson.Json.strfmt</code></td>
<td>[string] = <code>"%q"</code></td>
</tr>
<tr>
<td><code>lson.Json._level</code></td>
<td>[int] = <code>0</code></td>
</tr>
<tr>
<td><code>lson.Json._nl</code></td>
<td>[string] = <code>"\
  "</code>
(default='\n') newline, indent is added/removed</td>
</tr>
<tr>
<td><code>lson.Json.table</code></td>
<td>[function] = <code>fn"function"[/home/rett/projects/civlua/lib/lson/lson.lua:69]</code></td>
</tr>
<tr>
<td><code>lson.Json.string</code></td>
<td>[function] = <code>fn"function"[/home/rett/projects/civlua/lib/lson/lson.lua:66]</code></td>
</tr>
<tr>
<td><code>lson.Json.null</code></td>
<td>[any] = <code>none</code>
value to use for null</td>
</tr>
<tr>
<td><code>lson.Json.listStart</code></td>
<td>[string] = <code>["</code></td>
</tr>
<tr>
<td><code>lson.Json.listEnd</code></td>
<td>= <code>]"</code></td>
</tr>
</table>
<h3>Table <a id="lson.Json.__docs" href="#lson.Json.__docs">lson.Json.__docs</a></h3>
<h3>Table <a id="lson.Json.__fieldIds" href="#lson.Json.__fieldIds">lson.Json.__fieldIds</a></h3>
<h3>Table <a id="lson.Json.__fields" href="#lson.Json.__fields">lson.Json.__fields</a></h3>
<h4>Value <a id="lson.Json.__name" href="#lson.Json.__name">lson.Json.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lson.Json.__index</code></td>
<td>[Ty<Json>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L52">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lson.Json.__tostring</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L220">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json._write</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L93">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.boolean</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L133">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.concat</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L210">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.flush</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L90">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.format</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L201">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.function</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L138">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.items</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L147">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.keyvals</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L159">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.level</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L88">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.lined</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L215">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.nil</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L132">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.number</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L134">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.styled</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L114">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.tabulated</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L212">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.thread</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L136">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.tostring</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L220">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.userdata</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L137">src</a>)</td>
</tr>
<tr>
<td><code>lson.Json.write</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L101">src</a>)</td>
</tr>
</table>
<h3>Record <a id="lson.Lson" href="#lson.Lson">lson.Lson</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L116"><i>src</i></a>)</h3>
Similar to JSON but no commas and strings are encoded as <code>|bytes|</code>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>lson.Lson.style</code></td>
<td>[bool] 
enable styling. If true, set <code>to=Styler</code></td>
</tr>
<tr>
<td><code>lson.Lson.to</code></td>
<td>[file?] 
if set calls write</td>
</tr>
<tr>
<td><code>lson.Lson.keyEnd</code></td>
<td>[string] = <code>" "</code></td>
</tr>
<tr>
<td><code>lson.Lson.keySet</code></td>
<td>[string] = <code>":"</code></td>
</tr>
<tr>
<td><code>lson.Lson.indexEnd</code></td>
<td>[string] = <code>" "</code></td>
</tr>
<tr>
<td><code>lson.Lson.tableStart</code></td>
<td>[string] = <code>"{"</code></td>
</tr>
<tr>
<td><code>lson.Lson.tableEnd</code></td>
<td>[string] = <code>"}"</code></td>
</tr>
<tr>
<td><code>lson.Lson.listEnd</code></td>
<td>= <code>]"</code></td>
</tr>
<tr>
<td><code>lson.Lson.indent</code></td>
<td>[string] = <code>"  "</code></td>
</tr>
<tr>
<td><code>lson.Lson.maxIndent</code></td>
<td>[int] = <code>20</code></td>
</tr>
<tr>
<td><code>lson.Lson.numfmt</code></td>
<td>[string] = <code>"%q"</code></td>
</tr>
<tr>
<td><code>lson.Lson.strfmt</code></td>
<td>[string] = <code>"%q"</code></td>
</tr>
<tr>
<td><code>lson.Lson._level</code></td>
<td>[int] = <code>0</code></td>
</tr>
<tr>
<td><code>lson.Lson._nl</code></td>
<td>[string] = <code>"\
  "</code>
(default='\n') newline, indent is added/removed</td>
</tr>
<tr>
<td><code>lson.Lson.table</code></td>
<td>[function] = <code>fn"function"[/home/rett/projects/civlua/lib/lson/lson.lua:69]</code></td>
</tr>
<tr>
<td><code>lson.Lson.string</code></td>
<td>[function] = <code>fn"lson.bytes"[/home/rett/projects/civlua/lib/lson/lson.lua:111]</code></td>
</tr>
<tr>
<td><code>lson.Lson.null</code></td>
<td>[any] = <code>none</code>
value to use for null</td>
</tr>
<tr>
<td><code>lson.Lson.listStart</code></td>
<td>[string] = <code>["</code></td>
</tr>
<tr>
<td><code>lson.Lson.listEnd</code></td>
<td>= <code>]"</code></td>
</tr>
</table>
<h3>Table <a id="lson.Lson.__docs" href="#lson.Lson.__docs">lson.Lson.__docs</a></h3>
<h3>Table <a id="lson.Lson.__fieldIds" href="#lson.Lson.__fieldIds">lson.Lson.__fieldIds</a></h3>
<h3>Table <a id="lson.Lson.__fields" href="#lson.Lson.__fields">lson.Lson.__fields</a></h3>
<h4>Value <a id="lson.Lson.__name" href="#lson.Lson.__name">lson.Lson.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>lson.Lson.__index</code></td>
<td>[Ty<Lson>] (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L116">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>lson.Lson.__tostring</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L220">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson._write</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L93">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.boolean</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L133">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.concat</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L210">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.flush</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L90">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.format</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L201">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.function</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L138">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.items</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L147">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.keyvals</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L159">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.level</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L88">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.lined</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L215">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.nil</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L132">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.number</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L134">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.styled</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L114">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.tabulated</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L212">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.thread</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L136">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.tostring</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L220">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.userdata</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L137">src</a>)</td>
</tr>
<tr>
<td><code>lson.Lson.write</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/fmt/fmt.lua#L101">src</a>)</td>
</tr>
</table>
<h3>Function <a id="lson.bytes" href="#lson.bytes">lson.bytes</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L111"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deArray" href="#lson.deArray">lson.deArray</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L190"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deBytes" href="#lson.deBytes">lson.deBytes</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L178"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deFalse" href="#lson.deFalse">lson.deFalse</a><code>(de) -&gt; false</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L133"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deNull" href="#lson.deNull">lson.deNull</a><code>(de) -&gt; de.null</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L131"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deNumber" href="#lson.deNumber">lson.deNumber</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L139"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deObject" href="#lson.deObject">lson.deObject</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L206"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deString" href="#lson.deString">lson.deString</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L151"><i>src</i></a>)</h3>
<h3>Function <a id="lson.deTrue" href="#lson.deTrue">lson.deTrue</a><code>(de) -&gt; true</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L132"><i>src</i></a>)</h3>
<h3>Function <a id="lson.decode" href="#lson.decode">lson.decode</a><code>(s) -&gt; obj</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L38"><i>src</i></a>)</h3>
<h3>Function <a id="lson.json" href="#lson.json">lson.json</a><code>(v, pretty) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L29"><i>src</i></a>)</h3>
Encode lua value to JSON string
<h3>Function <a id="lson.lson" href="#lson.lson">lson.lson</a><code>(v, pretty) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/lson/lson.lua#L35"><i>src</i></a>)</h3>
Encode lua value to LSON string
<p>
<h1><a id="Package_pegl" href="#Package_pegl">Package pegl</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>PEG-like recursive descent parsing in Lua</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-2</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_pegl">https://lua.civboot.org#Package_pegl</a></td>
</tr>
</table>
PEG like recursive descent Parser for Lua.
<p>
PEG stands for "Parsing Expression Grammar" and is one of the simplest parsing
grammars since it maps very-closesly to recursive descent -- which is a
hand-rolled parser that uses recursion. This library is a pure-LUA
recursive-descent parser which exports types and functions to create a PEG-like
DSL that is still just recursive descent under the hood.
<p>
The benefits of this library are: <ul>
<li><i>vs hand-rolled recursive descent</i> is more concise and readable, as well as
providing automatic error messages (i.e. symbol locations in your stack) and
debugging.</li>
<li><i>vs PEG</i> is nearly as concise while maintaining the ability to hand-roll any
logic needed.</li>
</ul>
<p>
<h2><a id="pegl-resources" href="#pegl-resources">Resources</h2></a>
If you are completely new to parsers and especially if you want to write your
own language with an AST then I cannot recommend
<a href="http://www.craftinginterpreters.com">http://www.craftinginterpreters.com</a> enough. It might be a better place to
start than this library.
<p>
<h2><a id="pegl-intro" href="#pegl-intro">Introduction</h2></a>
A parser is a way to convert text into structured node objects so that the text
can be compiled or annotated by a program. For example you might want to convert
some source code like:
<p>
<code class="block">x = 1 + 2</code>
<p>
Into something like:
<p>
<code class="block">{'x', '=', {'1', '+', '2', kind='op'}, kind='assign'}</code>
<p>
A recursive descent parser does so via hand-rolled functions which typically
<i>recurse</i> into eachother. Each function attempts to parse from the current
parser position using its spec (which may be composed of calling other parsing
functions) and returns either the successfully parsed node or <code>nil</code> (or
returns/throws an error if it finds a syntax error).
<p>
PEGL is a Lua library for writing the common-cases of a recursive descent parser
in a (pure Lua) syntax similar to PEG, while still being able to easily fallback
to hand-rolled recursive descent when needed.
<p>
Most traditional PEG parsers (as well as other parsers) struggle with
complicated syntax such as Lua's <code>===[raw string syntax]===]</code>, python's
whitespace denoted syntax or C's lookahead requirements (<code>(U2)*c**h</code> --
recursive descent can solve a lot of these problems relatively easily and
performantly.  However, recursive descent parsers can be very verbose and
sometimes difficult to understand. Below is a comparison of the above example
in both PEG, PEGL and a "traditional" (though not very good) recursive descent
implementation.
<p>
<h3>Examples</h3>
<p>
<b>PEG</b>: most concise but harder to fallback to hand-rolled recursive descent
<code class="block">grammar = [[
num    &lt;- '%d'
name   &lt;- '%w'
setVar &lt;- num '=' name
expr   &lt;- setVar / ... other valid expressions
]]
p:parse(grammar)</code>
<p>
<b>PEGL</b>: very concise and easy to fallback to hand-rolled recursive descent.
Things like `kind` and `name` make debug printing easier. <code class="block">num    = Pat{'%d+', kind='num'} -- kind=num sets the node name
name   = Pat{'%w+', kind='name'}
-- Note: UNPIN and PIN are used for when errors should be raised
setVar = {UNPIN, name, '=', PIN, num, kind='setVar'}
expr   = Or{setVar, ... other valid expressions, name='expr'}
p:parse(expr)
]

[*Recursive Descent]: not very concise, harder to debug. [{## lang=lua}
-- Note: p=parser, an object which tracks the current position
-- in it's `state`

function parseNum(p)
  local num = p:consume('%d+') -- return result and advance position
  if num then -- found
    return {num, kind='num'} end
  end
end

function parseSetVar(p)
  local state = p.state()
  local name = p:consume('%w+')
  if not name then return end
  local eq, num = p:consume('='), parseNum(p)
  if not (eq and num) then
    -- didn't match, reset state and return
    p.setState(state)
    return
  end
  return {{name, kind='name'}, eq, num, kind='setVar'}
end

function expression(p)
  local expr = parseSetVar(p)
  if expr then return expr end
  -- ... other possible expressions
end

expression(p)</code>
<p>
See <a href="#pegl.Seq">#pegl.Seq</a> for the basic API of parsing specs.
<p>
<h2>Module <a id="pegl" href="#pegl">pegl</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L4"><i>src</i></a>)</h2>
pegl: peg-like lua parser
<p>
<h3>Table <a id="pegl.EMPTY" href="#pegl.EMPTY">pegl.EMPTY</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L253"><i>src</i></a>)</h3>
<h3>Table <a id="pegl.EOF" href="#pegl.EOF">pegl.EOF</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L257"><i>src</i></a>)</h3>
<h3>Table <a id="pegl.Empty" href="#pegl.Empty">pegl.Empty</a><code>() -&gt; M.EMPTY</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L254"><i>src</i></a>)</h3>
<h3>Table <a id="pegl.Eof" href="#pegl.Eof">pegl.Eof</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L263"><i>src</i></a>)</h3><code class="block">M.Eof = ds.sentinel('Eof', {
  __tostring=function() return 'Eof' end,
  parse=function(self, p)
    p:skipEmpty(); if p:isEof() then return M.EOF end
  end
})</code>
<h3>Table <a id="pegl.PIN" href="#pegl.PIN">pegl.PIN</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L248"><i>src</i></a>)</h3>
<h4>Value <a id="pegl.SPAN_PACK" href="#pegl.SPAN_PACK">pegl.SPAN_PACK</a></h4>
<h3>Table <a id="pegl.UNPIN" href="#pegl.UNPIN">pegl.UNPIN</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L249"><i>src</i></a>)</h3>
<h4>Value <a id="pegl.__name" href="#pegl.__name">pegl.__name</a></h4>
<h3>Table <a id="pegl.common" href="#pegl.common">pegl.common</a></h3>
<h3>Table <a id="pegl.fmtKinds" href="#pegl.fmtKinds">pegl.fmtKinds</a></h3>
<h3>Table <a id="pegl.testing" href="#pegl.testing">pegl.testing</a></h3>
<h3>Record <a id="pegl.FmtPegl" href="#pegl.FmtPegl">pegl.FmtPegl</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L714"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.FmtPegl.kinds</code></td>
<td>[table] = <code>{EMPTY=fn"function"[/home/rett/projects/civlua/lib/pegl/pegl.lua:706], EOF=fn"function"[/home/rett/projects/civlua/lib/pegl/pegl.lua:705], n10=fn"function"[/home/rett/projects/civlua/lib/pegl/pegl.lua:708], n16=fn"function"[/home/rett/projects/civlua/lib/pegl/pegl.lua:709], name=fn"function"[/home/rett/projects/civlua/lib/pegl/pegl.lua:707]}</code>
kind -> fmtFn</td>
</tr>
</table>
<h3>Table <a id="pegl.FmtPegl.__docs" href="#pegl.FmtPegl.__docs">pegl.FmtPegl.__docs</a></h3>
<h3>Table <a id="pegl.FmtPegl.__fieldIds" href="#pegl.FmtPegl.__fieldIds">pegl.FmtPegl.__fieldIds</a></h3>
<h3>Table <a id="pegl.FmtPegl.__fields" href="#pegl.FmtPegl.__fields">pegl.FmtPegl.__fields</a></h3>
<h4>Value <a id="pegl.FmtPegl.__name" href="#pegl.FmtPegl.__name">pegl.FmtPegl.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.FmtPegl.__index</code></td>
<td>[Ty<FmtPegl>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L714">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.FmtPegl.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="FmtPegl.__call" href="#FmtPegl.__call">FmtPegl.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L719"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Key" href="#pegl.Key">pegl.Key</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L180"><i>src</i></a>)</h3>
The table given to <code>Key</code> forms a Trie which is extremely performant. Key depends
strongly on the <code>tokenizer</code> passed to RootSpec.
<p>
Example: <code>Key{{'myKeword', ['+']={'+'=true}}, kind='kw'}</code> will match tokens "myKeyword"
and "+" followed by "+" (but not "+" not followed by "+").
<p>
To also match "+" use <code>['+']={true, '+'=true}</code>
<p>
<blockquote>Note: The `Key` constructor converts all list items into
<code>value=true</code>, so <code>{'a', 'b'}</code> is converted to <code>{a=true, b=true}</code></blockquote>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Key.keys</code></td>
<td>[table] </td>
</tr>
<tr>
<td><code>pegl.Key.name</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>pegl.Key.kind</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="pegl.Key.__docs" href="#pegl.Key.__docs">pegl.Key.__docs</a></h3>
<h3>Table <a id="pegl.Key.__fieldIds" href="#pegl.Key.__fieldIds">pegl.Key.__fieldIds</a></h3>
<h3>Table <a id="pegl.Key.__fields" href="#pegl.Key.__fields">pegl.Key.__fields</a></h3>
<h4>Value <a id="pegl.Key.__name" href="#pegl.Key.__name">pegl.Key.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Key.__index</code></td>
<td>[Ty<Key>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L180">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Key.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="pegl.fmtSpec" href="#pegl.fmtSpec">pegl.fmtSpec</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L126"><i>src</i></a>)</h4>
<h4>Function <a id="Key.parse" href="#Key.parse">Key.parse</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L348"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Many" href="#pegl.Many">pegl.Many</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L208"><i>src</i></a>)</h3>
match a Spec multiple times
Example: <code>Many{'keyword', OtherSpec, min=1, kind='myMany'}</code> will match the
given sequence one or more times (<code>min=0</code> times by default). The parse
result is a list with <code>kind='myMany'</code>.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Many.min</code></td>
<td>[int] = <code>0</code></td>
</tr>
<tr>
<td><code>pegl.Many.kind</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>pegl.Many.name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="pegl.Many.__docs" href="#pegl.Many.__docs">pegl.Many.__docs</a></h3>
<h3>Table <a id="pegl.Many.__fieldIds" href="#pegl.Many.__fieldIds">pegl.Many.__fieldIds</a></h3>
<h3>Table <a id="pegl.Many.__fields" href="#pegl.Many.__fields">pegl.Many.__fields</a></h3>
<h4>Value <a id="pegl.Many.__name" href="#pegl.Many.__name">pegl.Many.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Many.__index</code></td>
<td>[Ty<Many>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L208">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Many.__fmt</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L126">src</a>)</td>
</tr>
<tr>
<td><code>pegl.Many.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Many.parse" href="#Many.parse">Many.parse</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L438"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Not" href="#pegl.Not">pegl.Not</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L243"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Not.kind</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>pegl.Not.name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="pegl.Not.__docs" href="#pegl.Not.__docs">pegl.Not.__docs</a></h3>
<h3>Table <a id="pegl.Not.__fieldIds" href="#pegl.Not.__fieldIds">pegl.Not.__fieldIds</a></h3>
<h3>Table <a id="pegl.Not.__fields" href="#pegl.Not.__fields">pegl.Not.__fields</a></h3>
<h4>Value <a id="pegl.Not.__name" href="#pegl.Not.__name">pegl.Not.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Not.__index</code></td>
<td>[Ty<Not>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L243">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Not.__fmt</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L126">src</a>)</td>
</tr>
<tr>
<td><code>pegl.Not.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Not.parse" href="#Not.parse">Not.parse</a><code>(self, p) -&gt; not M.parseSeq(p, self)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L244"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Or" href="#pegl.Or">pegl.Or</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L198"><i>src</i></a>)</h3>
choose one spec
<p>
Example: <code>Or{'keyword', OtherSpec, Empty}</code> will match one of the three
specs given.  Note that <code>Empty</code> will always match (and return
<code>pegl.EMPTY</code>).  Without <code>Empty</code> this could return <code>nil</code>, causing a
parent <code>Or</code> to match a different spec.
<p>
<blockquote>Note: <code>Maybe(spec)</code> literally expands to <code>Or{spec, Empty}</code></blockquote>
<p>
Prefer <code>Key</code> if selecting among multiple string or token paths as <code>Or</code> is
not performant (<code>O(N)</code> vs Key's <code>O(1)</code>)
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Or.kind</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>pegl.Or.name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="pegl.Or.__docs" href="#pegl.Or.__docs">pegl.Or.__docs</a></h3>
<h3>Table <a id="pegl.Or.__fieldIds" href="#pegl.Or.__fieldIds">pegl.Or.__fieldIds</a></h3>
<h3>Table <a id="pegl.Or.__fields" href="#pegl.Or.__fields">pegl.Or.__fields</a></h3>
<h4>Value <a id="pegl.Or.__name" href="#pegl.Or.__name">pegl.Or.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Or.__index</code></td>
<td>[Ty<Or>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L198">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Or.__fmt</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L126">src</a>)</td>
</tr>
<tr>
<td><code>pegl.Or.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Or.parse" href="#Or.parse">Or.parse</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L417"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Parser" href="#pegl.Parser">pegl.Parser</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L110"><i>src</i></a>)</h3>
The parser tracks the current position of parsing in `dat` and has several
convienience methods for hand-rolling your own recursive descent functions.
<p>
<blockquote> Note: the location is **line/col based** (not position based) because it
is designed to work with an application that stores the strings as lines
(a text editor) </blockquote>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Parser.dat</code></td>
<td>[lines] 
reference to the underlying data.
Must look like a table of lines</td>
</tr>
<tr>
<td><code>pegl.Parser.l</code></td>
<td>[int] 
line, incremented when <code>c</code> is exhausted</td>
</tr>
<tr>
<td><code>pegl.Parser.c</code></td>
<td>[int] 
column in <code>line</code></td>
</tr>
<tr>
<td><code>pegl.Parser.line</code></td>
<td>[string] 
the current line (<code>dat[l]</code>)</td>
</tr>
<tr>
<td><code>pegl.Parser.lines</code></td>
<td>  </td>
</tr>
<tr>
<td><code>pegl.Parser.root</code></td>
<td>[RootSpec] </td>
</tr>
<tr>
<td><code>pegl.Parser.stack</code></td>
<td>[list] </td>
</tr>
<tr>
<td><code>pegl.Parser.stackL</code></td>
<td>[list] </td>
</tr>
<tr>
<td><code>pegl.Parser.stackC</code></td>
<td>[list] </td>
</tr>
<tr>
<td><code>pegl.Parser.stackLast</code></td>
<td>[{item, l, c}] </td>
</tr>
<tr>
<td><code>pegl.Parser.commentLC</code></td>
<td>[table] 
table of {line={col=CommentToken}}</td>
</tr>
<tr>
<td><code>pegl.Parser.dbgLevel</code></td>
<td>[number] = <code>0</code></td>
</tr>
</table>
<h3>Table <a id="pegl.Parser.__docs" href="#pegl.Parser.__docs">pegl.Parser.__docs</a></h3>
<h3>Table <a id="pegl.Parser.__fieldIds" href="#pegl.Parser.__fieldIds">pegl.Parser.__fieldIds</a></h3>
<h3>Table <a id="pegl.Parser.__fields" href="#pegl.Parser.__fields">pegl.Parser.__fields</a></h3>
<h4>Value <a id="pegl.Parser.__name" href="#pegl.Parser.__name">pegl.Parser.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Parser.__index</code></td>
<td>[Ty<Parser>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L110">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Parser.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Parser.__tostring" href="#Parser.__tostring">Parser.__tostring</a><code>() -&gt; 'Parser()'</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L512"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.assertNode" href="#Parser.assertNode">Parser.assertNode</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L484"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.checkPin" href="#Parser.checkPin">Parser.checkPin</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L624"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.consume" href="#Parser.consume">Parser.consume</a><code>(p, pat, plain) -&gt; Token</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L537"><i>src</i></a>)</h4>
consume the pattern, advancing the column if found
<h4>Function <a id="Parser.dbg" href="#Parser.dbg">Parser.dbg</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L669"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.dbgEnter" href="#Parser.dbgEnter">Parser.dbgEnter</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L645"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.dbgLeave" href="#Parser.dbgLeave">Parser.dbgLeave</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L654"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.dbgMatched" href="#Parser.dbgMatched">Parser.dbgMatched</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L657"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.dbgMissed" href="#Parser.dbgMissed">Parser.dbgMissed</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L660"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.dbgUnpack" href="#Parser.dbgUnpack">Parser.dbgUnpack</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L663"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.error" href="#Parser.error">Parser.error</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L630"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.incLine" href="#Parser.incLine">Parser.incLine</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L552"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.isEof" href="#Parser.isEof">Parser.isEof</a><code>(p) -&gt; isAtEndOfFile</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L553"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.makeStrTokens" href="#Parser.makeStrTokens">Parser.makeStrTokens</a><code>(p, t) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L580"><i>src</i></a>)</h4>
recursively mutate table converting all Tokens to strings
<h4>Function <a id="Parser.new" href="#Parser.new">Parser.new</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L521"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.parse" href="#Parser.parse">Parser.parse</a><code>(p, spec) -&gt; node</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L531"><i>src</i></a>)</h4>
the main entry point and used recursively.
Parses the spec, returning the node, which is a table of nodes that are
eventually tokens.
<h4>Function <a id="Parser.parseAssert" href="#Parser.parseAssert">Parser.parseAssert</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L637"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.peek" href="#Parser.peek">Parser.peek</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L545"><i>src</i></a>)</h4>
identical to `consume` except it does not advance the column
<h4>Function <a id="Parser.setState" href="#Parser.setState">Parser.setState</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L561"><i>src</i></a>)</h4>
restore the current parser state <code>{l, c, line}</code>
<h4>Function <a id="Parser.skipEmpty" href="#Parser.skipEmpty">Parser.skipEmpty</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L557"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.state" href="#Parser.state">Parser.state</a><code>(p) -&gt; {l=p.l, c=p.c, line=p.line}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L559"><i>src</i></a>)</h4>
get the current parser state <code>{l, c, line}</code>
<h4>Function <a id="Parser.sub" href="#Parser.sub">Parser.sub</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L548"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.toStrTokens" href="#Parser.toStrTokens">Parser.toStrTokens</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L572"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.tokenStr" href="#Parser.tokenStr">Parser.tokenStr</a><code>(p, t) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L581"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.trimTokenLast" href="#Parser.trimTokenLast">Parser.trimTokenLast</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L603"><i>src</i></a>)</h4>
<h4>Function <a id="Parser.trimTokenStart" href="#Parser.trimTokenStart">Parser.trimTokenStart</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L590"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Pat" href="#pegl.Pat">pegl.Pat</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L141"><i>src</i></a>)</h3>
<code>Pat{'%w+', kind='word'}</code> will create a Token with the span matching the
<code>%w+</code> pattern and the kind of <code>word</code> when matched.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Pat.kind</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>pegl.Pat.name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="pegl.Pat.__docs" href="#pegl.Pat.__docs">pegl.Pat.__docs</a></h3>
<h3>Table <a id="pegl.Pat.__fieldIds" href="#pegl.Pat.__fieldIds">pegl.Pat.__fieldIds</a></h3>
<h3>Table <a id="pegl.Pat.__fields" href="#pegl.Pat.__fields">pegl.Pat.__fields</a></h3>
<h4>Value <a id="pegl.Pat.__name" href="#pegl.Pat.__name">pegl.Pat.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Pat.__index</code></td>
<td>[Ty<Pat>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L141">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Pat.__fmt</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L126">src</a>)</td>
</tr>
<tr>
<td><code>pegl.Pat.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Pat.parse" href="#Pat.parse">Pat.parse</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L363"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.RootSpec" href="#pegl.RootSpec">pegl.RootSpec</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L90"><i>src</i></a>)</h3>
The root spec defines custom behavior for your spec. It's attributes
can be set to change how the parser skips empty (whitespace) and handles comments.
TODO: rename this.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.RootSpec.skipEmpty</code></td>
<td>[fn(p) -> nil] = <code>fn"pegl.skipEmpty"[/home/rett/projects/civlua/lib/pegl/pegl.lua:292]</code>
default=skip whitespace <ul>
<li>must be a function that accepts the `Parser`
and advances it's `l` and `c` past any empty (white) space. It must also set
`p.line` appropriately when `l` is moved.</li>
<li>The return value is ignored.</li>
<li>The default is to skip all whitespace (spaces, newlines, tabs, etc). This
should work for _most_ languages but fails for languages like python.</li>
<li>Recommendation: If your language has only a few whitespace-aware nodes (i.e.
strings) then hand-roll those as recursive-descent functions and leave
this function alone.</li>
</ul></td>
</tr>
<tr>
<td><code>pegl.RootSpec.skipComment</code></td>
<td>[function] 
fn(p) -> Token for found comment</td>
</tr>
<tr>
<td><code>pegl.RootSpec.tokenizer</code></td>
<td>[fn(p) -> nil] = <code>fn"pegl.defaultTokenizer"[/home/rett/projects/civlua/lib/pegl/pegl.lua:305]</code>
Requires: <ul>
<li>must return one token. The default is to return a single punctuation character
or a whole word (<code>_%w</code>)</li>
<li>Objects like <code>Key</code> can use the single punctuation characters in a Trie-like
performant data structure.</li>
</ul></td>
</tr>
<tr>
<td><code>pegl.RootSpec.dbg</code></td>
<td>[boolean] </td>
</tr>
</table>
<h3>Table <a id="pegl.RootSpec.__docs" href="#pegl.RootSpec.__docs">pegl.RootSpec.__docs</a></h3>
<h3>Table <a id="pegl.RootSpec.__fieldIds" href="#pegl.RootSpec.__fieldIds">pegl.RootSpec.__fieldIds</a></h3>
<h3>Table <a id="pegl.RootSpec.__fields" href="#pegl.RootSpec.__fields">pegl.RootSpec.__fields</a></h3>
<h4>Value <a id="pegl.RootSpec.__name" href="#pegl.RootSpec.__name">pegl.RootSpec.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.RootSpec.__index</code></td>
<td>[Ty<RootSpec>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L90">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.RootSpec.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="RootSpec.newFmt" href="#RootSpec.newFmt">RootSpec.newFmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L724"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Seq" href="#pegl.Seq">pegl.Seq</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L242"><i>src</i></a>)</h3>
A Sequence of parsers. Note that <code>Parser</code> treats <code>Seq{'a'}</code> and <code>{'a'}</code>
identically (you can use plain tables instead).
<p>
Raw strings are treated as keywords (the are parsed literally and have
<code>key</code> set to themselves). Functions are called with the <code>parser</code> as the
only argument and must return the node/s they parsed or <code>nil</code> for a
non-error match.
<p>
A sequence is a list of either other parsers
(<code>Seq, {}, "keyword", fn(p), Not, Or, etc</code>} and/or plain strings which are
treated as keywords and will have <code>kind</code> be set to themselves when parsed.
<p>
If the first spec matches but a later one doesn't an <code>error</code> will be thrown
(instead of <code>nil</code> returned) unless <code>UNPIN</code> is used. See the PIN/UNPIN
docs for details.
<p>
<h4>PIN/UNPIN: Syntax Error Reporting</h4>
PEGL implements syntax error detection ONLY in Sequence specs (table specs i.e.
`{...}`) by throwing an <code>error</code> if a "pinned" spec is missing. <ul>
<li>By default, no error will be raised if the first spec is missing. After the
first spec, <code>pin=true</code> and any missing specs to throw an error with context.</li>
<li><code>PIN</code> can be used to force <code>pin=true</code> until <code>UNPIN</code> is (optionally)
specified.</li>
<li><code>UNPIN</code> can be used to force <code>pin=false</code> until <code>PIN</code> is (optionally)
specified.</li>
<li>PIN / UNPIN only affect the <i>current</i> sequence (they do not pin
sub-sequences).</li>
</ul>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Seq.kind</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>pegl.Seq.name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="pegl.Seq.__docs" href="#pegl.Seq.__docs">pegl.Seq.__docs</a></h3>
<h3>Table <a id="pegl.Seq.__fieldIds" href="#pegl.Seq.__fieldIds">pegl.Seq.__fieldIds</a></h3>
<h3>Table <a id="pegl.Seq.__fields" href="#pegl.Seq.__fields">pegl.Seq.__fields</a></h3>
<h4>Value <a id="pegl.Seq.__name" href="#pegl.Seq.__name">pegl.Seq.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Seq.__index</code></td>
<td>[Ty<Seq>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L242">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Seq.__fmt</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L126">src</a>)</td>
</tr>
<tr>
<td><code>pegl.Seq.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Seq.parse" href="#Seq.parse">Seq.parse</a><code>(seq, p) -&gt; M.parseSeq(p, seq)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L398"><i>src</i></a>)</h4>
<h3>Record <a id="pegl.Token" href="#pegl.Token">pegl.Token</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L31"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pegl.Token.kind</code></td>
<td>[string] 
optional, used for debugging</td>
</tr>
</table>
<h3>Table <a id="pegl.Token.__docs" href="#pegl.Token.__docs">pegl.Token.__docs</a></h3>
<h3>Table <a id="pegl.Token.__fieldIds" href="#pegl.Token.__fieldIds">pegl.Token.__fieldIds</a></h3>
<h3>Table <a id="pegl.Token.__fields" href="#pegl.Token.__fields">pegl.Token.__fields</a></h3>
<h4>Value <a id="pegl.Token.__name" href="#pegl.Token.__name">pegl.Token.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>pegl.Token.__index</code></td>
<td>[Ty<Token>] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L31">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pegl.Token.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Token.__fmt" href="#Token.__fmt">Token.__fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L40"><i>src</i></a>)</h4>
<h4>Function <a id="Token.decode" href="#Token.decode">Token.decode</a><code>(t, dat) -&gt; lines.sub(dat, M.decodeSpan(t[1]))</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L36"><i>src</i></a>)</h4>
<h4>Function <a id="Token.encode" href="#Token.encode">Token.encode</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L35"><i>src</i></a>)</h4>
<h4>Function <a id="Token.span" href="#Token.span">Token.span</a><code>(t, dec) -&gt; M.decodeSpan(t[1])</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L32"><i>src</i></a>)</h4>
<b>Functions: </b> <table>
<tr>
<td><code>pegl.fmtSpec</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L126">src</a>)</td>
</tr>
</table>
<h3>Function <a id="pegl.Maybe" href="#pegl.Maybe">pegl.Maybe</a><code>(spec) -&gt; M.Or{spec, M.Empty}</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L199"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.assertParse" href="#pegl.assertParse">pegl.assertParse</a><code>(t) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L500"><i>src</i></a>)</h3>
Parse the <code>dat</code> with the <code>spec</code>, asserting the resulting "string tokens"
are identical to <code>expect</code>.
<p>
the input is a table of the form: <code class="block">  {dat, spec, expect, dbg=nil, root=default} --&gt; nil</code>
<h3>Function <a id="pegl.assertParseError" href="#pegl.assertParseError">pegl.assertParseError</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L507"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.decodeSpan" href="#pegl.decodeSpan">pegl.decodeSpan</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L29"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.defaultTokenizer" href="#pegl.defaultTokenizer">pegl.defaultTokenizer</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L305"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.encodeSpan" href="#pegl.encodeSpan">pegl.encodeSpan</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L25"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.firstToken" href="#pegl.firstToken">pegl.firstToken</a><code>(list) -&gt; t, listWithToken</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L49"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.isKeyword" href="#pegl.isKeyword">pegl.isKeyword</a><code>(t) -&gt; #t == 1 and t.kind == t[1]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L682"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.lastToken" href="#pegl.lastToken">pegl.lastToken</a><code>(list) -&gt; t, listWithToken</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L56"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.nodeSpan" href="#pegl.nodeSpan">pegl.nodeSpan</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L62"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.parse" href="#pegl.parse">pegl.parse</a><code>(dat, spec, root) -&gt; list[Node]</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L463"><i>src</i></a>)</h3>
Parse a spec, returning the nodes or throwing a syntax error.
<p>
<code>root</code> is used to define settings of the parser such as how to skip
comments and whether to use debug mode.
<h3>Function <a id="pegl.parseSeq" href="#pegl.parseSeq">pegl.parseSeq</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L396"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.skipEmpty" href="#pegl.skipEmpty">pegl.skipEmpty</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L292"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.skipEmptyMinimal" href="#pegl.skipEmptyMinimal">pegl.skipEmptyMinimal</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L300"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.skipWs1" href="#pegl.skipWs1">pegl.skipWs1</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L275"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.specToStr" href="#pegl.specToStr">pegl.specToStr</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L131"><i>src</i></a>)</h3>
<h3>Function <a id="pegl.specTy" href="#pegl.specTy">pegl.specTy</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl.lua#L137"><i>src</i></a>)</h3>
Create a parser spec record. These have the fields <code>kind</code> and <code>name</code>
and must define the <code>parse</code> method.
<h2>Module <a id="pegl.lua" href="#pegl.lua">pegl.lua</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl/lua.lua#L7"><i>src</i></a>)</h2>
Lua syntax in PEGL
<p>
http://parrot.github.io/parrot-docs0/0.4.7/html/languages/lua/doc/lua51.bnf.html
was used as a reference.
<p>
<h4>Value <a id="pegl.lua.__name" href="#pegl.lua.__name">pegl.lua.__name</a></h4>
<h3>Table <a id="pegl.lua.call" href="#pegl.lua.call">pegl.lua.call</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted<code class="block">M.update = function(t, add) --&gt; t
  for k, v in pairs(add) do t[k] = v end; return t</code>
<h3>Table <a id="pegl.lua.exp" href="#pegl.lua.exp">pegl.lua.exp</a></h3>
<h3>Table <a id="pegl.lua.exp1" href="#pegl.lua.exp1">pegl.lua.exp1</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted<code class="block">M.update = function(t, add) --&gt; t
  for k, v in pairs(add) do t[k] = v end; return t</code>
<h3>Table <a id="pegl.lua.explist" href="#pegl.lua.explist">pegl.lua.explist</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted<code class="block">M.update = function(t, add) --&gt; t
  for k, v in pairs(add) do t[k] = v end; return t</code>
<h3>Table <a id="pegl.lua.field" href="#pegl.lua.field">pegl.lua.field</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted<code class="block">M.update = function(t, add) --&gt; t
  for k, v in pairs(add) do t[k] = v end; return t</code>
<h3>Table <a id="pegl.lua.name" href="#pegl.lua.name">pegl.lua.name</a></h3>
<h3>Table <a id="pegl.lua.num" href="#pegl.lua.num">pegl.lua.num</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted<code class="block">M.update = function(t, add) --&gt; t
  for k, v in pairs(add) do t[k] = v end; return t</code>
<h3>Table <a id="pegl.lua.root" href="#pegl.lua.root">pegl.lua.root</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pegl/pegl/lua.lua#L250"><i>src</i></a>)</h3>
<h3>Table <a id="pegl.lua.src" href="#pegl.lua.src">pegl.lua.src</a></h3>
<h3>Table <a id="pegl.lua.stmt" href="#pegl.lua.stmt">pegl.lua.stmt</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted<code class="block">M.update = function(t, add) --&gt; t
  for k, v in pairs(add) do t[k] = v end; return t</code>
<h3>Table <a id="pegl.lua.str" href="#pegl.lua.str">pegl.lua.str</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted<code class="block">M.update = function(t, add) --&gt; t
  for k, v in pairs(add) do t[k] = v end; return t</code>
<h3>Table <a id="pegl.lua.varset" href="#pegl.lua.varset">pegl.lua.varset</a></h3>
<h3>Function <a id="pegl.lua.skipComment" href="#pegl.lua.skipComment">pegl.lua.skipComment</a><code>(t, add) -&gt; t</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L356"><i>src</i></a>)</h3>
return t with the key/vals of add inserted
<p>
<h1><a id="Package_luck" href="#Package_luck">Package luck</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck"><i>src</i></a>)</h1><table>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_luck">https://lua.civboot.org#Package_luck</a></td>
</tr>
</table>
Luck: Lua Configuration Language It's syntax and execution is literally Lua,
but with it's <code>_ENV</code> (it's accessible global variables) stripped to only a
few safe and deterministic modules and functions.
<p>
The values it exports are it's globals. For instance: <code class="block">name    = "Rett Berg"
date    = "2023-12-20"
version = {1, 2, 3},
project = {
  name = "Civboot",
  url = "civboot.org",
}</code>
<p>
Is equivalent to the JSON <code class="block">{
  "name": "Rett Berg",
  "date": "2023-12-20",
  "version": [1, 2, 3],
  "project": {
    "name": "Civboot",
    "url": "civboot.org",
  }
}</code>
<p>
Unlike JSON, Luck supports everything Lua supports, including: <ul>
<li>precomputing local values</li>
<li>referencing local and global values</li>
<li>defining and calling functions</li>
<li><a href="#Dependencies">dependencies</a></li>
</ul>
<p>
<h2>API</h2>
<p>
The available functions are (TODO: give linked table instead):
<p>
<code class="block">luck=luck,
sfmt=string.format, push=table.insert,

string=string, table=table,   utf8=utf8,
type=type,     select=select,
pairs=pairs,   ipairs=ipairs, next=next,
error=error,   assert=assert,

tonumber=tonumber,
abs=math.abs, ceil=math.ceil, floor=math.floor,
max=math.max, min=math.min,
maxinteger=math.maxinteger,</code>
<p>
<h2>Dependencies</h2>
<p>
The first symbol of a luck file CAN be a call to the <code>meta</code> function
which specifies the package name and any dependencies.
<p>
The build system (which can simply be a Lua script which calls
<code>luck.loadall</code>) must give the paths to all needed luck files. It will
then load only the leading <code>meta</code> call to build the dependency graph
before loading the entire tree in the correct order.
<p>
When executed, each luck file will receive a clone of its dependency's values
assigned to the keys it specifies.
<p>
<code class="block">meta {
  'my.pkg.name',           -- package name
  dep1 = 'some.pkg.name',  -- a dependency
  dep2 = 'other.pkg.name', -- another dependnecy
}

-- export value
value1 = dep1.someFunction(dep1.someValue, dep2.otherValue * 3)</code>
<p>

<p>
<h2>Module <a id="luck" href="#luck">luck</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L4"><i>src</i></a>)</h2>
luck: lua configuration language
<p>
<h3>Table <a id="luck.LUCK" href="#luck.LUCK">luck.LUCK</a></h3>
<h4>Value <a id="luck.__name" href="#luck.__name">luck.__name</a></h4>
<h3>Record <a id="luck.Luck" href="#luck.Luck">luck.Luck</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L63"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>luck.Luck.name</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>luck.Luck.deps</code></td>
<td>  </td>
</tr>
<tr>
<td><code>luck.Luck.dat</code></td>
<td>  </td>
</tr>
<tr>
<td><code>luck.Luck.path</code></td>
<td>  </td>
</tr>
</table>
<h3>Table <a id="luck.Luck.__docs" href="#luck.Luck.__docs">luck.Luck.__docs</a></h3>
<h3>Table <a id="luck.Luck.__fieldIds" href="#luck.Luck.__fieldIds">luck.Luck.__fieldIds</a></h3>
<h3>Table <a id="luck.Luck.__fields" href="#luck.Luck.__fields">luck.Luck.__fields</a></h3>
<h4>Value <a id="luck.Luck.__name" href="#luck.Luck.__name">luck.Luck.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>luck.Luck.__index</code></td>
<td>[Ty<Luck>] (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L63">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>luck.Luck.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Luck.fromMeta" href="#Luck.fromMeta">Luck.fromMeta</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L81"><i>src</i></a>)</h4>
<h3>Function <a id="luck.createEnv" href="#luck.createEnv">luck.createEnv</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L35"><i>src</i></a>)</h3>
<h3>Function <a id="luck.load" href="#luck.load">luck.load</a><code>(path, env) -&gt; table</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L134"><i>src</i></a>)</h3>
Load a single path which has no dependencies.
<h3>Function <a id="luck.loadMeta" href="#luck.loadMeta">luck.loadMeta</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L58"><i>src</i></a>)</h3>
<h3>Function <a id="luck.loadMetas" href="#luck.loadMetas">luck.loadMetas</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L96"><i>src</i></a>)</h3>
<h3>Function <a id="luck.loadall" href="#luck.loadall">luck.loadall</a><code>(paths, allenv) -&gt; built, lucks, sorted</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L126"><i>src</i></a>)</h3>
<h3>Function <a id="luck.loadraw" href="#luck.loadraw">luck.loadraw</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/luck/luck.lua#L44"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_smol" href="#Package_smol">Package smol</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>compression algorithms</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_smol">https://lua.civboot.org#Package_smol</a></td>
</tr>
</table>
smol: compression algorithms and data structures
<p>
The smol library supports native (C) implementations of ultra-tiny compression
and delta algorithms, and the data structures to interface them with Lua.
<p>
<h2>Module <a id="smol" href="#smol">smol</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L3"><i>src</i></a>)</h2>
small compression algorithms
<p>
<h4>Value <a id="smol.__name" href="#smol.__name">smol.__name</a></h4>
<h3>Record <a id="smol.Main" href="#smol.Main">smol.Main</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L122"><i>src</i></a>)</h3>
de/compress library and utility.
<p>
Example: <ul>
<li><code>smol file.txt    file.txt.sm --compress</code></li>
<li><code>smol file.txt.sm file.txt</code></li>
</ul>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>smol.Main.compress</code></td>
<td>[bool] 
compresses first argument, otherwise decompress it</td>
</tr>
<tr>
<td><code>smol.Main.verbose</code></td>
<td>[bool] 
prints stats</td>
</tr>
<tr>
<td><code>smol.Main.dry</code></td>
<td>[bool] 
if true then don't write data</td>
</tr>
</table>
<h3>Table <a id="smol.Main.__docs" href="#smol.Main.__docs">smol.Main.__docs</a></h3>
<h3>Table <a id="smol.Main.__fieldIds" href="#smol.Main.__fieldIds">smol.Main.__fieldIds</a></h3>
<h3>Table <a id="smol.Main.__fields" href="#smol.Main.__fields">smol.Main.__fields</a></h3>
<h4>Value <a id="smol.Main.__name" href="#smol.Main.__name">smol.Main.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>smol.Main.__index</code></td>
<td>[Ty<Main>] (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L122">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>smol.Main.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Record <a id="smol.Smol" href="#smol.Smol">smol.Smol</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L33"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>smol.Smol.x</code></td>
<td>[smol.X] 
holds settings and buffers for smol operations</td>
</tr>
<tr>
<td><code>smol.Smol.rdelta</code></td>
<td>[bool] 
whether to use rdelta in compress</td>
</tr>
<tr>
<td><code>smol.Smol.huff</code></td>
<td>[bool] 
whether to use huffman coding in compress and rdelta</td>
</tr>
</table>
<h3>Table <a id="smol.Smol.__docs" href="#smol.Smol.__docs">smol.Smol.__docs</a></h3>
<h3>Table <a id="smol.Smol.__fieldIds" href="#smol.Smol.__fieldIds">smol.Smol.__fieldIds</a></h3>
<h3>Table <a id="smol.Smol.__fields" href="#smol.Smol.__fields">smol.Smol.__fields</a></h3>
<h4>Value <a id="smol.Smol.__name" href="#smol.Smol.__name">smol.Smol.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>smol.Smol.__index</code></td>
<td>[Ty<Smol>] (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L33">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>smol.Smol.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Smol.compress" href="#Smol.compress">Smol.compress</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L84"><i>src</i></a>)</h4>
<h4>Function <a id="Smol.compressRDelta" href="#Smol.compressRDelta">Smol.compressRDelta</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L74"><i>src</i></a>)</h4>
<h4>Function <a id="Smol.decompress" href="#Smol.decompress">Smol.decompress</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L110"><i>src</i></a>)</h4>
<h4>Function <a id="Smol.hdecode" href="#Smol.hdecode">Smol.hdecode</a><code>(sm, henc) -&gt; text</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L62"><i>src</i></a>)</h4>
<h4>Function <a id="Smol.hencode" href="#Smol.hencode">Smol.hencode</a><code>(sm, text) -&gt; htree..enc</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L56"><i>src</i></a>)</h4>
<h3>Record <a id="smol.XConfig" href="#smol.XConfig">smol.XConfig</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L27"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>smol.XConfig.fp4po2</code></td>
<td>[int] = <code>14</code>
max size of len4 fingerprint table</td>
</tr>
</table>
<h3>Table <a id="smol.XConfig.__docs" href="#smol.XConfig.__docs">smol.XConfig.__docs</a></h3>
<h3>Table <a id="smol.XConfig.__fieldIds" href="#smol.XConfig.__fieldIds">smol.XConfig.__fieldIds</a></h3>
<h3>Table <a id="smol.XConfig.__fields" href="#smol.XConfig.__fields">smol.XConfig.__fields</a></h3>
<h4>Value <a id="smol.XConfig.__name" href="#smol.XConfig.__name">smol.XConfig.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>smol.XConfig.__index</code></td>
<td>[Ty<XConfig>] (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L27">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>smol.XConfig.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Function <a id="smol.main" href="#smol.main">smol.main</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/smol/smol.lua#L150"><i>src</i></a>)</h3>
<h3>Table <a id="smol.sys" href="#smol.sys">smol.sys</a></h3>
<p>
<h1><a id="Package_civdb" href="#Package_civdb">Package civdb</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>minimalistic CRUD database</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_civdb">https://lua.civboot.org#Package_civdb</a></td>
</tr>
</table>
<h1>civdb: minimalistic CRUD database</h1>
<p>
CivDB's basic requirements are: <ul>
<li>"Single file" database: all data is stored in a single file</li>
<li>indexes can be added which are separate files but all indexes can always be
rebuilt from the single file.</li>
<li>CRUD database: you can create rows, read rows, update rows and delete rows
using an integer row id.</li>
<li>Fast O(1) row creation and updates which can hold arbitrary Lua values
(but typically hold the value referenced by the schema).</li>
<li>Can hold metadata, especially the schema (auto type conversion)</li>
</ul>
<p>
<h2>Design</h2>
The basic design is: <ul>
<li>The "database" is a folder, i.e. <code>path/to/mydata.civdb/</code></li>
<li>Within the folder is a single file called `data` which contains entries
which contain the operation and row data encoded using `civdb.encode`
(binary encoding format) <ul>
<li>The data file starts with the magic bytes `civdb\0`</li>
<li>The size of the entry is 7bit encoded, followed by the entry data</li>
</ul></li>
<li>Values are de/serialized by first calling <code>ds.pod.(from/to)Pod</code> and then
de/serializing them using <code>pod.[de]ser</code>.
<blockquote>If the type of fromPod matches the schema then it is first stripped to
save on binary space.
</blockquote></li>
<li>Also within the folder is the <code>rows</code> file, which contains 3-byte positions
into the <code>data</code> file (the start of that row's entry), or `0` if that row
was deleted. <ul>
<li>The rows file is updated as the data file is written to. On flush their
timestamps are set to the same value (indicating a reindex is not necessary)</li>
<li>The <code>rows</code> file is the most basic index as it points to a specific position.
All other indexes operate similarily but instead of pointing to a position
they point to a row.</li>
</ul></li>
<li>"Transactions" are written into the <code>data</code> file one at a time. A transaction
is encoded as an "operation" (<code>create</code>, <code>update(row)</code>, <code>delete(row)</code>,
<code>metadata</code>) and a value (except for delete). <ul>
<li>When the transaction is written the <code>rows</code> table is updated, and then
other indexes are updated.</li>
</ul></li>
<li>Other indexes are stored based on the schema, but are basically just a list of
functions to call every time a row is created or modified (with some sane
defaults for the schema). <ul>
<li>These typically modify BOTH a <code>field.rhood</code> and <code>field.ll</code>.
The <code>field.rhood</code> contains a 3-byte robin hood hash table which point to
entries in <code>field.ll</code>, which is a linked-list file containing the rows
containing that field value.</li>
</ul></li>
</ul>
<p>
<h2>Module <a id="civdb" href="#civdb">civdb</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L6"><i>src</i></a>)</h2>
civdb: minimalistic CRUD database
<p>
This module exports the encode/decode functions which
can be used for encoding and decoding plain-old-data.
<p>
<h4>Value <a id="civdb.__name" href="#civdb.__name">civdb.__name</a></h4>
<h3>Record <a id="civdb.DB" href="#civdb.DB">civdb.DB</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L34"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>civdb.DB.path</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>civdb.DB.mode</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>civdb.DB.f</code></td>
<td>[File] </td>
</tr>
<tr>
<td><code>civdb.DB.idx</code></td>
<td>[lines.U3File] 
row -> pos</td>
</tr>
<tr>
<td><code>civdb.DB.cache</code></td>
<td>[WeakV] 
cache of rows</td>
</tr>
<tr>
<td><code>civdb.DB._row</code></td>
<td>[int] = <code>1</code>
the next row</td>
</tr>
<tr>
<td><code>civdb.DB._eofpos</code></td>
<td>[nil</td>
<td>int] 
nil or pos at eof</td>
</tr>
</table>
<h4>Value <a id="civdb.DB.IDX_DIR" href="#civdb.DB.IDX_DIR">civdb.DB.IDX_DIR</a></h4>
<h4>Value <a id="civdb.DB.MAGIC" href="#civdb.DB.MAGIC">civdb.DB.MAGIC</a></h4>
<h3>Table <a id="civdb.DB.__docs" href="#civdb.DB.__docs">civdb.DB.__docs</a></h3>
<h3>Table <a id="civdb.DB.__fieldIds" href="#civdb.DB.__fieldIds">civdb.DB.__fieldIds</a></h3>
<h3>Table <a id="civdb.DB.__fields" href="#civdb.DB.__fields">civdb.DB.__fields</a></h3>
<h4>Value <a id="civdb.DB.__name" href="#civdb.DB.__name">civdb.DB.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>civdb.DB.__index</code></td>
<td>[Ty<DB>] (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L34">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>civdb.DB.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>civdb.DB.flush</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/lines/lines/File.lua#L84">src</a>)</td>
</tr>
</table>
<h4>Function <a id="DB.__len" href="#DB.__len">DB.__len</a><code>(db) -&gt; #db.idx</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L133"><i>src</i></a>)</h4>
<h4>Function <a id="DB._initnew" href="#DB._initnew">DB._initnew</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L104"><i>src</i></a>)</h4>
<h4>Function <a id="DB._pushvalue" href="#DB._pushvalue">DB._pushvalue</a><code>(db, op, value) -&gt; pos, dat</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L188"><i>src</i></a>)</h4>
<h4>Function <a id="DB._reindex" href="#DB._reindex">DB._reindex</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L131"><i>src</i></a>)</h4>
<h4>Function <a id="DB.close" href="#DB.close">DB.close</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L193"><i>src</i></a>)</h4>
<h4>Function <a id="DB.createRaw" href="#DB.createRaw">DB.createRaw</a><code>(db, value) -&gt; row</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L144"><i>src</i></a>)</h4>
Create a new row with value, returning the rownum
Note: directly encodes with toPod (ignores schema)
<h4>Function <a id="DB.delete" href="#DB.delete">DB.delete</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L175"><i>src</i></a>)</h4>
Delete the row, future reads will return nil
<h4>Function <a id="DB.readRaw" href="#DB.readRaw">DB.readRaw</a><code>(db, row) -&gt; value?</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L156"><i>src</i></a>)</h4>
Read the row, returning its value
Note: does not attempt to convert to the schema type.
<h4>Function <a id="DB.updateRaw" href="#DB.updateRaw">DB.updateRaw</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L164"><i>src</i></a>)</h4>
Modify the value of the row with the value
Note: directly encodes with toPod (ignores schema)
<h3>Record <a id="civdb.Op" href="#civdb.Op">civdb.Op</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L42"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>civdb.Op.kind</code></td>
<td>[string] 
create, delete or update</td>
</tr>
<tr>
<td><code>civdb.Op.row</code></td>
<td>[int] 
the row index being modified</td>
</tr>
</table>
<h3>Table <a id="civdb.Op.__docs" href="#civdb.Op.__docs">civdb.Op.__docs</a></h3>
<h3>Table <a id="civdb.Op.__fieldIds" href="#civdb.Op.__fieldIds">civdb.Op.__fieldIds</a></h3>
<h3>Table <a id="civdb.Op.__fields" href="#civdb.Op.__fields">civdb.Op.__fields</a></h3>
<h4>Value <a id="civdb.Op.__name" href="#civdb.Op.__name">civdb.Op.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>civdb.Op.__index</code></td>
<td>[Ty<Op>] (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L42">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>civdb.Op.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Op.decode" href="#Op.decode">Op.decode</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/civdb/civdb.lua#L82"><i>src</i></a>)</h4>
Op:decode(val) - decode the operation.
<p>
<h1><a id="Package_vcds" href="#Package_vcds">Package vcds</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>version control data structures and algorithms</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-6</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_vcds">https://lua.civboot.org#Package_vcds</a></td>
</tr>
</table>
<p>
<h2>Module <a id="vcds" href="#vcds">vcds</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L2"><i>src</i></a>)</h2>
vsds: version control data structures (and algorithms)
<p>
<h4>Value <a id="vcds.ADD" href="#vcds.ADD">vcds.ADD</a></h4>
<h3>Table <a id="vcds.DiffEoF" href="#vcds.DiffEoF">vcds.DiffEoF</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L104"><i>src</i></a>)</h3>
<h3>Table <a id="vcds.DiffSoF" href="#vcds.DiffSoF">vcds.DiffSoF</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L103"><i>src</i></a>)</h3>
<h4>Value <a id="vcds.REM" href="#vcds.REM">vcds.REM</a></h4>
<h4>Value <a id="vcds.__name" href="#vcds.__name">vcds.__name</a></h4>
<h3>Record <a id="vcds.Change" href="#vcds.Change">vcds.Change</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L55"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vcds.Change.rem</code></td>
<td>[int</td>
<td>table] 
removed lines</td>
</tr>
<tr>
<td><code>vcds.Change.add</code></td>
<td>[string] 
text to add</td>
</tr>
</table>
<h3>Table <a id="vcds.Change.__docs" href="#vcds.Change.__docs">vcds.Change.__docs</a></h3>
<h3>Table <a id="vcds.Change.__fieldIds" href="#vcds.Change.__fieldIds">vcds.Change.__fieldIds</a></h3>
<h3>Table <a id="vcds.Change.__fields" href="#vcds.Change.__fields">vcds.Change.__fields</a></h3>
<h4>Value <a id="vcds.Change.__name" href="#vcds.Change.__name">vcds.Change.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vcds.Change.__index</code></td>
<td>[Ty<Change>] (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L55">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vcds.Change.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Change.len" href="#Change.len">Change.len</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L58"><i>src</i></a>)</h4>
<h3>Record <a id="vcds.Diff" href="#vcds.Diff">vcds.Diff</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L29"><i>src</i></a>)</h3>
Single Line Diff
This type is good for displaying differences to a user.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vcds.Diff.b</code></td>
<td>  
(base)   orig file.  '+'=added</td>
</tr>
<tr>
<td><code>vcds.Diff.c</code></td>
<td>  
(change) new file.   '-'=removed</td>
</tr>
<tr>
<td><code>vcds.Diff.text</code></td>
<td>[string] </td>
</tr>
</table>
<b>Values: </b> <table>
<tr>
<td><code>vcds.Diff.__name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="vcds.Diff.__docs" href="#vcds.Diff.__docs">vcds.Diff.__docs</a></h3>
<h3>Table <a id="vcds.Diff.__fieldIds" href="#vcds.Diff.__fieldIds">vcds.Diff.__fieldIds</a></h3>
<h3>Table <a id="vcds.Diff.__fields" href="#vcds.Diff.__fields">vcds.Diff.__fields</a></h3>
<b>Records: </b> <table>
<tr>
<td><code>vcds.Diff.__index</code></td>
<td>[Ty<Diff>] (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L29">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vcds.Diff.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Diff.__tostring" href="#Diff.__tostring">Diff.__tostring</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L36"><i>src</i></a>)</h4>
<h4>Function <a id="Diff.isKeep" href="#Diff.isKeep">Diff.isKeep</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L39"><i>src</i></a>)</h4>
<h3>Record <a id="vcds.DiffsExtender" href="#vcds.DiffsExtender">vcds.DiffsExtender</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L111"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vcds.DiffsExtender.diffs</code></td>
<td>[list] </td>
</tr>
<tr>
<td><code>vcds.DiffsExtender.base</code></td>
<td>  </td>
</tr>
<tr>
<td><code>vcds.DiffsExtender.bl</code></td>
<td>[int] 
base line</td>
</tr>
<tr>
<td><code>vcds.DiffsExtender.cl</code></td>
<td>[int] 
change line</td>
</tr>
</table>
<h3>Table <a id="vcds.DiffsExtender.__docs" href="#vcds.DiffsExtender.__docs">vcds.DiffsExtender.__docs</a></h3>
<h3>Table <a id="vcds.DiffsExtender.__fieldIds" href="#vcds.DiffsExtender.__fieldIds">vcds.DiffsExtender.__fieldIds</a></h3>
<h3>Table <a id="vcds.DiffsExtender.__fields" href="#vcds.DiffsExtender.__fields">vcds.DiffsExtender.__fields</a></h3>
<h4>Value <a id="vcds.DiffsExtender.__name" href="#vcds.DiffsExtender.__name">vcds.DiffsExtender.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vcds.DiffsExtender.__index</code></td>
<td>[Ty<DiffsExtender>] (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L111">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vcds.DiffsExtender.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="DiffsExtender.__call" href="#DiffsExtender.__call">DiffsExtender.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L132"><i>src</i></a>)</h4>
extend change to diffs
<h3>Record <a id="vcds.Keep" href="#vcds.Keep">vcds.Keep</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L49"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vcds.Keep.num</code></td>
<td>[int] </td>
</tr>
</table>
<h3>Table <a id="vcds.Keep.__docs" href="#vcds.Keep.__docs">vcds.Keep.__docs</a></h3>
<h3>Table <a id="vcds.Keep.__fieldIds" href="#vcds.Keep.__fieldIds">vcds.Keep.__fieldIds</a></h3>
<h3>Table <a id="vcds.Keep.__fields" href="#vcds.Keep.__fields">vcds.Keep.__fields</a></h3>
<h4>Value <a id="vcds.Keep.__name" href="#vcds.Keep.__name">vcds.Keep.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vcds.Keep.__index</code></td>
<td>[Ty<Keep>] (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L49">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vcds.Keep.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Keep.len" href="#Keep.len">Keep.len</a><code>(k) -&gt; k.num and k.num or #k</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L50"><i>src</i></a>)</h4>
<h3>Record <a id="vcds.Patch" href="#vcds.Patch">vcds.Patch</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L253"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vcds.Patch.conflict</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>vcds.Patch.bl</code></td>
<td>[number] </td>
</tr>
</table>
<h3>Table <a id="vcds.Patch.__docs" href="#vcds.Patch.__docs">vcds.Patch.__docs</a></h3>
<h3>Table <a id="vcds.Patch.__fieldIds" href="#vcds.Patch.__fieldIds">vcds.Patch.__fieldIds</a></h3>
<h3>Table <a id="vcds.Patch.__fields" href="#vcds.Patch.__fields">vcds.Patch.__fields</a></h3>
<h4>Value <a id="vcds.Patch.__name" href="#vcds.Patch.__name">vcds.Patch.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vcds.Patch.__index</code></td>
<td>[Ty<Patch>] (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L253">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vcds.Patch.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Record <a id="vcds.Picks" href="#vcds.Picks">vcds.Picks</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L171"><i>src</i></a>)</h3>
Create picks (aka cherry picks) iterator from changes.
These can then be applied to a new base using vcds.patch(base, picks)
<p>
Each "pick" is a list of Diffs which are anchored by the lines
above and below (unless they are start/end of file).
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vcds.Picks.changes</code></td>
<td>[list] 
list of changes</td>
</tr>
<tr>
<td><code>vcds.Picks.ci</code></td>
<td>[int] 
for iterating</td>
</tr>
<tr>
<td><code>vcds.Picks.de</code></td>
<td>[DiffsExtender] </td>
</tr>
<tr>
<td><code>vcds.Picks.set</code></td>
<td>[table] 
settings (need refactor)</td>
</tr>
</table>
<h3>Table <a id="vcds.Picks.__docs" href="#vcds.Picks.__docs">vcds.Picks.__docs</a></h3>
<h3>Table <a id="vcds.Picks.__fieldIds" href="#vcds.Picks.__fieldIds">vcds.Picks.__fieldIds</a></h3>
<h3>Table <a id="vcds.Picks.__fields" href="#vcds.Picks.__fields">vcds.Picks.__fields</a></h3>
<h4>Value <a id="vcds.Picks.__name" href="#vcds.Picks.__name">vcds.Picks.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vcds.Picks.__index</code></td>
<td>[Ty<Picks>] (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L171">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vcds.Picks.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Picks.__call" href="#Picks.__call">Picks.__call</a><code>(p) -&gt; iterator</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L193"><i>src</i></a>)</h4>
<h4>Function <a id="Picks.groupChanges" href="#Picks.groupChanges">Picks.groupChanges</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L212"><i>src</i></a>)</h4>
Get which changes to include in a patch group.
A group is a series of patches with Keep:len() < anchorLen (default=3)
between them.
<h3>Function <a id="vcds.apply" href="#vcds.apply">vcds.apply</a><code>(base, changes, out--[[{}]]) -&gt; out</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L75"><i>src</i></a>)</h3>
Apply changes to base (TableLines), push to <code>out</code>
<h3>Function <a id="vcds.createAnchorBot" href="#vcds.createAnchorBot">vcds.createAnchorBot</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L159"><i>src</i></a>)</h3>
<h3>Function <a id="vcds.createAnchorTop" href="#vcds.createAnchorTop">vcds.createAnchorTop</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L150"><i>src</i></a>)</h3>
<h3>Function <a id="vcds.createPatch" href="#vcds.createPatch">vcds.createPatch</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L350"><i>src</i></a>)</h3>
Create a patch item from a pick
<p>
At it's most basic it would just be: <ul>
<li>find line position via top and/or bottom anchor. We want at least 2 lines</li>
<li>convert pick to change. Walk the text applying the change.</li>
</ul>
<p>
There are some strategies to fix common anchor misses: <ul>
<li>If an anchor is missing, the nearby change can be used instead. Use either
the removed or added lines. For instance, if we are supposed to remove lines
then try and find them. Conversely if the patch was already applied then the
supposed-to-be added lines will already be there!</li>
<li>When adding, existing identical text is okay.</li>
<li>When removing, missing text is okay as long as it's followed by an anchor of
some kind</li>
<li>Keep lines act as an anchor (for above) but are otherwise not required - they
are "free" to change or be removed. If they are missing then the algorithm will
try to continue the change with or without them (dynamic programming)</li>
<li>empty lines are entirely ignored and are not considered an anchor</li>
</ul>
<h3>Function <a id="vcds.findAnchor" href="#vcds.findAnchor">vcds.findAnchor</a><code>(base, baseMap, anchors, above--[[false]]) -&gt; (l, c)</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L249"><i>src</i></a>)</h3>
Find the actual anchor by searching for uniqueness in the anchors <ul>
<li>above=true:  find above (search up)</li>
<li>above=false: find below (search down)</li>
</ul>
<h3>Function <a id="vcds.normalize" href="#vcds.normalize">vcds.normalize</a><code>(s) -&gt; ds.squash(ds.trimEnd(s))</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L21"><i>src</i></a>)</h3>
normalize a line for comparing (anchoring).
This just squashes and trims the end.
<h3>Function <a id="vcds.pickAnchorsBot" href="#vcds.pickAnchorsBot">vcds.pickAnchorsBot</a><code>(base, pick) -&gt; isEndOfFile, anchors</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L267"><i>src</i></a>)</h3>
<h3>Function <a id="vcds.pickAnchorsTop" href="#vcds.pickAnchorsTop">vcds.pickAnchorsTop</a><code>(pick) -&gt; isStartOfFile, anchors</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L260"><i>src</i></a>)</h3>
<h3>Function <a id="vcds.toChanges" href="#vcds.toChanges">vcds.toChanges</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L101"><i>src</i></a>)</h3>
<h3>Function <a id="vcds.toDiffs" href="#vcds.toDiffs">vcds.toDiffs</a><code>(base, changes) -&gt; diffs</code> (<a href="https://github.com/civboot/civlua/blob/main/lib/vcds/vcds.lua#L140"><i>src</i></a>)</h3>
Convert Changes to Diffs with full context
<p>
<h1><a id="Package_asciicolor" href="#Package_asciicolor">Package asciicolor</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>encode text color and style with a two ascii characters</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_asciicolor">https://lua.civboot.org#Package_asciicolor</a></td>
</tr>
</table>
encode text color and style with a two ascii characters.
<p>
asciicolor is a protocol which encodes text color in terminals and (in future)
elsewhere using only a single ascii character: i.e. <code>b</code> for black, <code>w</code> for
white and <code>n</code> for navy blue, etc. Capitalizing the character encodes a style
(bold for foreground, underlined for background).
<p>
See <a href="#asciicolor.Color">#asciicolor.Color</a> for all codes.
<p>
The color codes are used by <a href="#asciicolor.style.Styler">#asciicolor.style.Styler</a> to style text
using an <code>AcWriter</code>. See <a href="#vt100.AcWriter">#vt100.AcWriter</a> for the reference spec.
<p>
<p>
<h2>Module <a id="asciicolor" href="#asciicolor">asciicolor</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor.lua#L2"><i>src</i></a>)</h2>
<p>
<h3>Table <a id="asciicolor.CODES" href="#asciicolor.CODES">asciicolor.CODES</a></h3>
<h3>Table <a id="asciicolor.Color" href="#asciicolor.Color">asciicolor.Color</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor.lua#L24"><i>src</i></a>)</h3>
typosafe mapping of asciicode -> fullname
<p>
<blockquote> Note: These map to the available colors in a VT100 terminal emulator,
See the vt100 module for that implementation</blockquote><code class="block">M.Color = ds.TypoSafe{
  z = 'zero', [' '] = 'zero', [''] = 'zero', -- aka default.

  --  (dark)           (light)
  b = 'black',         w = 'white',
  d = 'darkgrey',      l = 'lightgrey',
  r = 'red',           p = 'pink',
  y = 'yellow',        h = 'honey',
  g = 'green',         t = 'tea',
  c = 'cyan',          a = 'aqua',
  n = 'navy',          s = 'sky', -- blue
  m = 'magenta',       f = 'fuschia',
}</code>
<h4>Value <a id="asciicolor.__name" href="#asciicolor.__name">asciicolor.__name</a></h4>
<h3>Function <a id="asciicolor.assertcode" href="#asciicolor.assertcode">asciicolor.assertcode</a><code>(ac) -&gt; single leter (or error)</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor.lua#L52"><i>src</i></a>)</h3>
<h3>Function <a id="asciicolor.bgColor" href="#asciicolor.bgColor">asciicolor.bgColor</a><code>(c) -&gt; colorCode</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor.lua#L36"><i>src</i></a>)</h3>
<h3>Function <a id="asciicolor.fgColor" href="#asciicolor.fgColor">asciicolor.fgColor</a><code>(c) -&gt; colorCode</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor.lua#L33"><i>src</i></a>)</h3>
<p>
<h2>Module <a id="Ascii" href="#Ascii">Ascii</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor.lua#L27"><i>src</i></a>)</h2>
typosafe mapping of fullname -> asciichar
<p>
<h4>Value <a id="asciicolor.Ascii.__name" href="#asciicolor.Ascii.__name">asciicolor.Ascii.__name</a></h4>
<h4>Value <a id="asciicolor.Ascii.aqua" href="#asciicolor.Ascii.aqua">asciicolor.Ascii.aqua</a></h4>
<h4>Value <a id="asciicolor.Ascii.black" href="#asciicolor.Ascii.black">asciicolor.Ascii.black</a></h4>
<h4>Value <a id="asciicolor.Ascii.cyan" href="#asciicolor.Ascii.cyan">asciicolor.Ascii.cyan</a></h4>
<h4>Value <a id="asciicolor.Ascii.darkgrey" href="#asciicolor.Ascii.darkgrey">asciicolor.Ascii.darkgrey</a></h4>
<h4>Value <a id="asciicolor.Ascii.fuschia" href="#asciicolor.Ascii.fuschia">asciicolor.Ascii.fuschia</a></h4>
<h4>Value <a id="asciicolor.Ascii.green" href="#asciicolor.Ascii.green">asciicolor.Ascii.green</a></h4>
<h4>Value <a id="asciicolor.Ascii.honey" href="#asciicolor.Ascii.honey">asciicolor.Ascii.honey</a></h4>
<h4>Value <a id="asciicolor.Ascii.lightgrey" href="#asciicolor.Ascii.lightgrey">asciicolor.Ascii.lightgrey</a></h4>
<h4>Value <a id="asciicolor.Ascii.magenta" href="#asciicolor.Ascii.magenta">asciicolor.Ascii.magenta</a></h4>
<h4>Value <a id="asciicolor.Ascii.navy" href="#asciicolor.Ascii.navy">asciicolor.Ascii.navy</a></h4>
<h4>Value <a id="asciicolor.Ascii.pink" href="#asciicolor.Ascii.pink">asciicolor.Ascii.pink</a></h4>
<h4>Value <a id="asciicolor.Ascii.red" href="#asciicolor.Ascii.red">asciicolor.Ascii.red</a></h4>
<h4>Value <a id="asciicolor.Ascii.sky" href="#asciicolor.Ascii.sky">asciicolor.Ascii.sky</a></h4>
<h4>Value <a id="asciicolor.Ascii.tea" href="#asciicolor.Ascii.tea">asciicolor.Ascii.tea</a></h4>
<h4>Value <a id="asciicolor.Ascii.white" href="#asciicolor.Ascii.white">asciicolor.Ascii.white</a></h4>
<h4>Value <a id="asciicolor.Ascii.yellow" href="#asciicolor.Ascii.yellow">asciicolor.Ascii.yellow</a></h4>
<h4>Value <a id="asciicolor.Ascii.zero" href="#asciicolor.Ascii.zero">asciicolor.Ascii.zero</a></h4>
<h2>Module <a id="asciicolor.style" href="#asciicolor.style">asciicolor.style</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L4"><i>src</i></a>)</h2>
style text from a user's config.
<p>
<h4>Value <a id="asciicolor.style.CONFIG_PATH" href="#asciicolor.style.CONFIG_PATH">asciicolor.style.CONFIG_PATH</a></h4>
<h4>Value <a id="asciicolor.style.__name" href="#asciicolor.style.__name">asciicolor.style.__name</a></h4>
<h3>Table <a id="asciicolor.style.dark" href="#asciicolor.style.dark">asciicolor.style.dark</a></h3>
<h3>Record <a id="asciicolor.style.Styler" href="#asciicolor.style.Styler">asciicolor.style.Styler</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L81"><i>src</i></a>)</h3>
Create a styler
<p>
Note: pass f (file) to create the default AcWriter with the file.
Note: pass mode, stylepath to control loadStyle
<p>
<b>Fields: </b> <table>
<tr>
<td><code>asciicolor.style.Styler.acwriter</code></td>
<td>[AcWriter] </td>
</tr>
<tr>
<td><code>asciicolor.style.Styler.style</code></td>
<td>[table] 
default=loadStyle()</td>
</tr>
</table>
<h3>Table <a id="asciicolor.style.Styler.__docs" href="#asciicolor.style.Styler.__docs">asciicolor.style.Styler.__docs</a></h3>
<h3>Table <a id="asciicolor.style.Styler.__fieldIds" href="#asciicolor.style.Styler.__fieldIds">asciicolor.style.Styler.__fieldIds</a></h3>
<h3>Table <a id="asciicolor.style.Styler.__fields" href="#asciicolor.style.Styler.__fields">asciicolor.style.Styler.__fields</a></h3>
<h4>Value <a id="asciicolor.style.Styler.__name" href="#asciicolor.style.Styler.__name">asciicolor.style.Styler.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>asciicolor.style.Styler.__index</code></td>
<td>[Ty<Styler>] (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L81">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Styler.__tostring" href="#Styler.__tostring">Styler.__tostring</a><code>() -&gt; 'Styler{...}'</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L83"><i>src</i></a>)</h4>
<h4>Function <a id="Styler.flush" href="#Styler.flush">Styler.flush</a><code>(st) -&gt; st.acwriter:flush()</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L86"><i>src</i></a>)</h4>
<h4>Function <a id="Styler.level" href="#Styler.level">Styler.level</a><code>(st, add) -&gt; st.acwriter.f:level(add)</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L85"><i>src</i></a>)</h4>
<h4>Function <a id="Styler.styled" href="#Styler.styled">Styler.styled</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L94"><i>src</i></a>)</h4>
Example: st:styled('path', 'path/to/foo.txt', '\n')
<h4>Function <a id="Styler.write" href="#Styler.write">Styler.write</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L99"><i>src</i></a>)</h4>
write as plain
<h3>Function <a id="asciicolor.style.Fmt" href="#asciicolor.style.Fmt">asciicolor.style.Fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L118"><i>src</i></a>)</h3>
create a Fmt with sensible defaults from the config
<h3>Function <a id="asciicolor.style.loadStyle" href="#asciicolor.style.loadStyle">asciicolor.style.loadStyle</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L72"><i>src</i></a>)</h3>
<h3>Function <a id="asciicolor.style.mode" href="#asciicolor.style.mode">asciicolor.style.mode</a><code>() -&gt; G.CLIMODE or os.getenv'CLIMODE'</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L58"><i>src</i></a>)</h3>
<h3>Function <a id="asciicolor.style.stylePath" href="#asciicolor.style.stylePath">asciicolor.style.stylePath</a><code>() -&gt; pth.concat{pth.home(), CONFIG_PATH}</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/asciicolor/asciicolor/style.lua#L60"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_vt100" href="#Package_vt100">Package vt100</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>Civboot VT100 Terminal Library</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_vt100">https://lua.civboot.org#Package_vt100</a></td>
</tr>
</table>
This is Civboot's VT100 terminal interface library. It implements (and also
defines) the API that civboot terminal emulators must implement to be
considered Civboot compliant.
<p>
It has the following core types and constants: <ul>
<li><code>Term</code> object, see below</li>
<li><code>AsciiColor</code> which is a map from single ascii lowercase characters to the
color name (i.e. <code>w -&gt; white</code>). These can be used in Term.fg and Term.bg to
set the relvant colors.</li>
<li><code>FgColor</code> and <code>BgColor</code> contains a map from the color name to the VT100 color
code (for external libraries).</li>
<li>Various key utility functions and maps for checking and working with the
values sent by <code>Term:input()</code></li>
</ul>
<p>
To be civboot compliant the <code>Term</code> type exported must have the following API: <ul>
<li><code>ds.Grid</code> fields <code>text, fg, bg</code> for terminal text, foreground color and
background color respectively</li>
<li><code>l, c</code> fields for setting the cursor location (which is drawn)</li>
<li><code>h, w</code> (height width) fields (see <code>resize()</code>)</li>
<li><code>:input(keysend)</code> method which asyncronously (LAP) sends any user-inputed keys</li>
<li><code>:draw()</code> method which draws the text</li>
<li><code>:resize()</code> method that (if nothing is passed to it) retrieves the <code>h, w</code>
fields and updates and clears child grids.</li>
<li><code>:clear()</code> method which clears all child grids.</li>
<li><code>run</code> boolean (default=true) which can be set to false to stop related
coroutines (best effort)</li>
</ul>
<p>
<p>
<h2>Module <a id="vt100" href="#vt100">vt100</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L8"><i>src</i></a>)</h2>
Civboot vt100 Terminal library that supports LAP protocol.
Module for interacting with the vt100 via keys and AsciiColors.
<code class="block">License CC0 / UNLICENSE
Originally written 2022 Phil Leblanc, modified 2023 Rett Berg (Civboot.org)
Authorized for relicense in: http://github.com/philanc/plterm/issues/4</code>
<p>
<h3>Table <a id="vt100.ATEXIT" href="#vt100.ATEXIT">vt100.ATEXIT</a></h3>
<h3>Table <a id="vt100.Bg" href="#vt100.Bg">vt100.Bg</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L235"><i>src</i></a>)</h3>
asciicolor code -> vt100 code
<h3>Table <a id="vt100.BgColor" href="#vt100.BgColor">vt100.BgColor</a></h3>
<h3>Table <a id="vt100.CMD" href="#vt100.CMD">vt100.CMD</a></h3>
<h3>Table <a id="vt100.Fg" href="#vt100.Fg">vt100.Fg</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L235"><i>src</i></a>)</h3>
asciicolor code -> vt100 code
<h3>Table <a id="vt100.FgColor" href="#vt100.FgColor">vt100.FgColor</a></h3>
<h3>Table <a id="vt100.INP_SEQ" href="#vt100.INP_SEQ">vt100.INP_SEQ</a></h3>
<h3>Table <a id="vt100.INP_SEQO" href="#vt100.INP_SEQO">vt100.INP_SEQO</a></h3>
<h3>Table <a id="vt100.LITERALS" href="#vt100.LITERALS">vt100.LITERALS</a></h3>
<h3>Table <a id="vt100.Style" href="#vt100.Style">vt100.Style</a></h3>
<h3>Table <a id="vt100.VALID_KEY" href="#vt100.VALID_KEY">vt100.VALID_KEY</a></h3>
<h4>Value <a id="vt100.__name" href="#vt100.__name">vt100.__name</a></h4>
<h3>Record <a id="vt100.Term" href="#vt100.Term">vt100.Term</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L52"><i>src</i></a>)</h3>
VT100 Terminal Emulator <ul>
<li>Write the text to display</li>
<li>Write the foreground/background colors to fg/bg</li>
<li>Then call :draw() to draw to terminal.</li>
</ul>
<p>
Requires <code>vt100.start()</code> have been called to initiate raw mode.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vt100.Term.l</code></td>
<td>[int] = <code>1</code>
cursor line</td>
</tr>
<tr>
<td><code>vt100.Term.c</code></td>
<td>[int] = <code>1</code>
cursor column</td>
</tr>
<tr>
<td><code>vt100.Term.h</code></td>
<td>[int] = <code>40</code>
height</td>
</tr>
<tr>
<td><code>vt100.Term.w</code></td>
<td>[int] = <code>80</code>
width</td>
</tr>
<tr>
<td><code>vt100.Term.text</code></td>
<td>[ds.Grid] 
the text to display</td>
</tr>
<tr>
<td><code>vt100.Term.fg</code></td>
<td>[ds.Grid] 
foreground color (ASCII coded)</td>
</tr>
<tr>
<td><code>vt100.Term.bg</code></td>
<td>[ds.Grid] 
background color (ASCII coded)</td>
</tr>
<tr>
<td><code>vt100.Term._waiting</code></td>
<td>[thread] 
the thread waiting on update (i.e. size)</td>
</tr>
<tr>
<td><code>vt100.Term.run</code></td>
<td>[boolean] = <code>true</code>
set to false to stop coroutines</td>
</tr>
</table>
<h3>Table <a id="vt100.Term.__docs" href="#vt100.Term.__docs">vt100.Term.__docs</a></h3>
<h3>Table <a id="vt100.Term.__fieldIds" href="#vt100.Term.__fieldIds">vt100.Term.__fieldIds</a></h3>
<h3>Table <a id="vt100.Term.__fields" href="#vt100.Term.__fields">vt100.Term.__fields</a></h3>
<h4>Value <a id="vt100.Term.__name" href="#vt100.Term.__name">vt100.Term.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vt100.Term.__index</code></td>
<td>[Ty<Term>] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L52">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vt100.Term.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Term.__fmt" href="#Term.__fmt">Term.__fmt</a><code>(tm, fmt) -&gt; tm.text:__fmt(fmt)</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L71"><i>src</i></a>)</h4>
<h4>Function <a id="Term._ready" href="#Term._ready">Term._ready</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L303"><i>src</i></a>)</h4>
<h4>Function <a id="Term._requestSize" href="#Term._requestSize">Term._requestSize</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L299"><i>src</i></a>)</h4>
send a request for size.
Note: the input() coroutine will receive and call _ready()
<h4>Function <a id="Term._updateChildren" href="#Term._updateChildren">Term._updateChildren</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L65"><i>src</i></a>)</h4>
<h4>Function <a id="Term.clear" href="#Term.clear">Term.clear</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L69"><i>src</i></a>)</h4>
<h4>Function <a id="Term.draw" href="#Term.draw">Term.draw</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L329"><i>src</i></a>)</h4>
draw the text and color(fg/bg) grids to the screen
<h4>Function <a id="Term.input" href="#Term.input">Term.input</a><code>(tm, send) -&gt; infinite loop (run in coroutine)</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L386"><i>src</i></a>)</h4>
function to run in a (LAP) coroutine.
<code>send()</code> is called with each key recieved. Typically this is a lap.Send.
<h4>Function <a id="Term.resize" href="#Term.resize">Term.resize</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L311"><i>src</i></a>)</h4>
request size and clear children
This can only be run with an active (LAP) input coroutine
<h3>Function <a id="vt100.acwrite" href="#vt100.acwrite">vt100.acwrite</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L285"><i>src</i></a>)</h3>
write to the terminal-like file f using colors fgstr and bgstr
accounting for previous color codes fg, bg
<p>
Additional strings (...) are written using plain color.
<p>
Return: <code>fg, bg, write(str, ...)</code>
<blockquote> Note: fg and bg are the updated color codes</blockquote>
<h3>Function <a id="vt100.checkKey" href="#vt100.checkKey">vt100.checkKey</a><code>(key) -&gt; key?, errstring?</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L170"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.colorFB" href="#vt100.colorFB">vt100.colorFB</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L255"><i>src</i></a>)</h3>
Set the color, taking into account the previous color
<h3>Function <a id="vt100.ctrlChar" href="#vt100.ctrlChar">vt100.ctrlChar</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L116"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.key" href="#vt100.key">vt100.key</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L116"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.keyError" href="#vt100.keyError">vt100.keyError</a><code>(key) -&gt; errstring?</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L166"><i>src</i></a>)</h3>
Check that a key is valid. Return errstring if not.
<h3>Function <a id="vt100.literal" href="#vt100.literal">vt100.literal</a><code>(key) -&gt; literalstring?</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L138"><i>src</i></a>)</h3>
Convert any key to it's literal form <code class="block">  literal'a'       -&gt; 'a'
  literal'return'  -&gt; '\n'
  literal'invalid' -&gt; nil</code>
<h3>Function <a id="vt100.start" href="#vt100.start">vt100.start</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L429"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.stop" href="#vt100.stop">vt100.stop</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L410"><i>src</i></a>)</h3>
<p>
<h2>Module <a id="vt100.ctrl" href="#vt100.ctrl">vt100.ctrl</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L31"><i>src</i></a>)</h2>
Direct terminal control functions
<p>
<h4>Value <a id="vt100.ctrl.__name" href="#vt100.ctrl.__name">vt100.ctrl.__name</a></h4>
<h3>Function <a id="vt100.ctrl.clear" href="#vt100.ctrl.clear">vt100.ctrl.clear</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.cleareol" href="#vt100.ctrl.cleareol">vt100.ctrl.cleareol</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.color" href="#vt100.ctrl.color">vt100.ctrl.color</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.colorFB" href="#vt100.ctrl.colorFB">vt100.ctrl.colorFB</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.down" href="#vt100.ctrl.down">vt100.ctrl.down</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.getlc" href="#vt100.ctrl.getlc">vt100.ctrl.getlc</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.golc" href="#vt100.ctrl.golc">vt100.ctrl.golc</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.hide" href="#vt100.ctrl.hide">vt100.ctrl.hide</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.left" href="#vt100.ctrl.left">vt100.ctrl.left</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.nextline" href="#vt100.ctrl.nextline">vt100.ctrl.nextline</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.reset" href="#vt100.ctrl.reset">vt100.ctrl.reset</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.restore" href="#vt100.ctrl.restore">vt100.ctrl.restore</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.right" href="#vt100.ctrl.right">vt100.ctrl.right</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.save" href="#vt100.ctrl.save">vt100.ctrl.save</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.show" href="#vt100.ctrl.show">vt100.ctrl.show</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Function <a id="vt100.ctrl.size" href="#vt100.ctrl.size">vt100.ctrl.size</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L197"><i>src</i></a>)</h3>
causes terminal to send size as (escaped) cursor position
<h3>Function <a id="vt100.ctrl.up" href="#vt100.ctrl.up">vt100.ctrl.up</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L189"><i>src</i></a>)</h3>
<h3>Record <a id="vt100.AcWriter" href="#vt100.AcWriter">vt100.AcWriter</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vt100.AcWriter.f</code></td>
<td>[file] </td>
</tr>
<tr>
<td><code>vt100.AcWriter.fg</code></td>
<td>[string] = <code>"z"</code>
current foreground ac letter</td>
</tr>
<tr>
<td><code>vt100.AcWriter.bg</code></td>
<td>[string] = <code>"z"</code>
current background ac letter</td>
</tr>
</table>
<h3>Table <a id="vt100.AcWriter.__docs" href="#vt100.AcWriter.__docs">vt100.AcWriter.__docs</a></h3>
<h3>Table <a id="vt100.AcWriter.__fieldIds" href="#vt100.AcWriter.__fieldIds">vt100.AcWriter.__fieldIds</a></h3>
<h3>Table <a id="vt100.AcWriter.__fields" href="#vt100.AcWriter.__fields">vt100.AcWriter.__fields</a></h3>
<h4>Value <a id="vt100.AcWriter.__name" href="#vt100.AcWriter.__name">vt100.AcWriter.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vt100.AcWriter.__index</code></td>
<td>[Ty<vt100.AcWriter>] </td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vt100.AcWriter.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="vt100.AcWriter.acwrite" href="#vt100.AcWriter.acwrite">vt100.AcWriter.acwrite</a><code>(aw, fgstr, bgstr, ...) -&gt; write(...)</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/AcWriter.lua#L22"><i>src</i></a>)</h4>
<code>:acwrite(fgstr, bgstr, str, ...)</code>: writes str with style of fg/bg str
<h4>Function <a id="vt100.AcWriter.flush" href="#vt100.AcWriter.flush">vt100.AcWriter.flush</a><code>(aw) -&gt; aw.f:flush()</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/AcWriter.lua#L14"><i>src</i></a>)</h4>
<h4>Function <a id="vt100.AcWriter.write" href="#vt100.AcWriter.write">vt100.AcWriter.write</a><code>(aw, ...) -&gt; aw:acwrite(nil, nil, ...)</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/AcWriter.lua#L24"><i>src</i></a>)</h4>
write plain
<h2>Module <a id="vt100.testing" href="#vt100.testing">vt100.testing</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/testing.lua#L2"><i>src</i></a>)</h2>
helpers for testing/demoing vt100
<p>
<h4>Value <a id="vt100.testing.__name" href="#vt100.testing.__name">vt100.testing.__name</a></h4>
<h3>Record <a id="vt100.testing.Fake" href="#vt100.testing.Fake">vt100.testing.Fake</a> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/testing.lua#L11"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>vt100.testing.Fake.l</code></td>
<td>[int] = <code>1</code>
cursor line</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.c</code></td>
<td>[int] = <code>1</code>
cursor column</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.h</code></td>
<td>[int] = <code>40</code>
height</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.w</code></td>
<td>[int] = <code>80</code>
width</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.text</code></td>
<td>[ds.Grid] 
the text to display</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.fg</code></td>
<td>[ds.Grid] 
foreground color (ASCII coded)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.bg</code></td>
<td>[ds.Grid] 
background color (ASCII coded)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake._waiting</code></td>
<td>[thread] 
the thread waiting on update (i.e. size)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.run</code></td>
<td>[boolean] = <code>true</code>
set to false to stop coroutines</td>
</tr>
</table>
<h3>Table <a id="vt100.testing.Fake.__docs" href="#vt100.testing.Fake.__docs">vt100.testing.Fake.__docs</a></h3>
<h3>Table <a id="vt100.testing.Fake.__fieldIds" href="#vt100.testing.Fake.__fieldIds">vt100.testing.Fake.__fieldIds</a></h3>
<h3>Table <a id="vt100.testing.Fake.__fields" href="#vt100.testing.Fake.__fields">vt100.testing.Fake.__fields</a></h3>
<h4>Value <a id="vt100.testing.Fake.__name" href="#vt100.testing.Fake.__name">vt100.testing.Fake.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>vt100.testing.Fake.__index</code></td>
<td>[Ty<Fake>] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/testing.lua#L11">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>vt100.testing.Fake.__fmt</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L71">src</a>)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake._ready</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L303">src</a>)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake._requestSize</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L299">src</a>)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake._updateChildren</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L65">src</a>)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.clear</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L69">src</a>)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.draw</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L88">src</a>)</td>
</tr>
<tr>
<td><code>vt100.testing.Fake.input</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/ds/ds.lua#L88">src</a>)</td>
</tr>
</table>
<h3>Function <a id="vt100.testing.run" href="#vt100.testing.run">vt100.testing.run</a><code>() -&gt; out, err</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/testing.lua#L31"><i>src</i></a>)</h3>
start rawmode using tmpfiles
<h3>Function <a id="vt100.testing.startTmp" href="#vt100.testing.startTmp">vt100.testing.startTmp</a><code>() -&gt; out, err</code> (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100/testing.lua#L27"><i>src</i></a>)</h3>
start rawmode using tmpfiles
<p>
<h1><a id="Package_cxt" href="#Package_cxt">Package cxt</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>text markup for civilization</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_cxt">https://lua.civboot.org#Package_cxt</a></td>
</tr>
</table>
cxt: text markup for civilization
<p>
It should not take more than a few minutes to know how to read and write
documentation.
<p>
cxt is an ultra-simple markup language which is designed to be as easy as
possible to parse (for computers <i>and</i> humans) while still using as few
characters as possible to express format for common cases. The <code>src/</code>
dir of <a href="code.commonmark.org">CommonMark</a> contains more than 20,000 lines of
code whereas cxt is implemented in less than 500.
<p>
cxt is designed to: <ul>
<li>Make document writing easy: use relatively few characters to express
common formatting</li>
<li>Make document parsing easy: unambiguous, unlike <code>Ma**rk_do*wn</code></li>
<li>Readable as raw text</li>
<li>structured data can be consumed: supports arbitrary attributes</li>
</ul>
<p>
CXT contains only three special characters for deliniating formatting controls: <ul>
<li>the two bracket characters <code>[]</code></li>
<li>a way to escape brackets and itself <code>\\</code>, <code>\[</code> and <code>\]</code></li>
</ul>
<p>
There are two ways to specify attributes for a block: <ul>
<li>short: <code>[*bold text]</code> where <code>*</code> can be any of the shortcuts below</li>
<li>full: <code>[{*_ attr1 attr2=value}bold underlined with attr 1 and 2]</code></li>
</ul>
<p>
The following attributes and shortcuts are supported
<code class="block">  b i u   bold (*), italic (,) and underlined (_)
  * , _   Example: [*bold] [,italic] [_underlined]
                   [{*,_}bold italic and underlined]

  code    inline or block code (depending on whether newlines exist)
   $      shortcut: [$inline code]
   #...   See also: '[#... ]#...' which sets the code attribute.

  quote   create a quote block
   "      Example: ["quote block]

  list    list syntax, see demos
   +      Example: [+
            * list item 1
            * list item 2
          ]

  table   table syntax, see demos.
  # head  modify the delimiters with row/col/head attrs.
  + row
  | col

  hidden  hidden block, used for comments and/or assigning attributes
   !      Example: [!hidden block]

  #...    any number of # characters create a "raw" block that must
          have the same number of # characters closing it.

          [##
          some code
          ]##

          [{## code=html}
          &lt;b&gt;example html&lt;/b&gt;
          ]##

  href    hyper reference, aka a url.
  &lt;href&gt;

   path   a path, typically relative to project or website root.
    /     Example: [/path/to/file.lua]

  name    sets the name of the block.
   n      Used with: [@name]  href=#name  anyAttr=@name
   :      shortcut: [{: ...}name]
          Example: [{name=Civboot href=http://civboot.org}Civboot]
          Example: [{: href=http://civboot.org}Civboot]

  value   when @ is used for an attr value, it will get this attribute.
   v      defaults to "href" if the node has one, else "text" which
          is the node's text.

   @      copies a block with given name. When used as an attr value
          it gets the attribute referenced by "value"
          Example:
            [{!:href=http://civboot.org}Civboot] creates a hidden named block
            [@Civboot] clones the block (removing name and hidden)
            [&lt;@Civboot&gt;Civboot Project] has href=http://civboot.org
              note: the default for "value" is "href" if it exists.

 escapes
   \[    literal [
   \]    literal ]
   \\    literal \
   \*    literal \*, where * is any other character</code>
<p>
<blockquote> Note:
Any value after a bracket besides <code> {...} b i u * , _ $ " + ! / : v @ </code>
is invalid.</blockquote>
<p>
<h2><a id="Demos" href="#Demos">Demos</h2></a>
<p>
<h3>Inline Code:</h3>
<p>
<code>[$inline code]. Note that [$balanced[brackets] are allowed]</code> <ul>
<li><code>inline code</code>. Note that <code>balanced[brackets] are allowed</code></li>
</ul>
<p>
<h3>Code block:</h3>
<p>
Writing this: <code class="block">[{## lang=lua}
function example()
  print'Hello world'
end
]##</code>
<p>
Will create a formatted code block: <code class="block">function example()
  print'Hello world'
end</code>
<p>
<h3>Text Formatting</h3>
<code>[*bold], [,italic] and [_underlined]</code> <ul>
<li><b>bold</b>, <i>italic</i> and <u>underlined</u></li>
</ul>
<p>
<h3>Linking</h3>
<code>[{b i href=http://civboot.org}bold italic link]</code> <ul>
<li><a href="http://civboot.org"><b><i>bold italic link</i></b></a></li>
</ul>
<p>
<h3>List</h3>
Lists are started with <code>+</code>, each items is deliniated by <code>*</code>: <code class="block">A list of stuff: [+
* example list
* with sub list:[+
  * sub item
  * multi-line

    sub item.
  * inner code block
    [##
    function example()
      print'example inner block'
    end
    ]##
  * final sub
]
* final item
]</code>
<p>
A list of stuff: <ul>
<li>example list</li>
<li>with sub list:<ul>
<li>sub item</li>
<li>multi-line
<p>
sub item.</li>
<li>inner code block
<code class="block">function example()
  print'example inner block'
end</code></li>
<li>final sub</li>
</ul></li>
<li>final item</li>
</ul>
<p>
<h3>Hidden</h3>
<code>Hidden block: "[! this is hidden]"</code> <ul>
<li>Hidden block: ""</li>
</ul>
<p>
<h3>Table</h3>
A table is created by the 'table' attribute. We also set the <code>head</code>, <code>row</code>
and <code>col</code> to the defaults for demonstration (they can be excluded). The
<code>row</code> and <code>head</code> deliminters are only recognized at the start of a line.
<p>
<code class="block">A table: [{table head=# row=+ col=|}
# col 1      | col 2   | col 3
+ row [*1.1] | row 1.2 | row 1.3
+ row [*1.1] | row 1.2 | row 1.3
]</code>
<p>
A table: <table>
<tr>
<th>col 1</th>
<th>col 2</th>
<th>col 3</th>
</tr>
<tr>
<td>row <b>1.1</b></td>
<td>row 1.2</td>
<td>row 1.3</td>
</tr>
<tr>
<td>row <b>1.1</b></td>
<td>row 1.2</td>
<td>row 1.3</td>
</tr>
</table>
<p>
<h3>Table with large columns</h3>
For very large or multi-lined columns, you can organize them similar to
sub-lists: <code class="block">[{table}
# 1st header column
| 2nd header column
| 3rd header column
+ long row 1.1
| long row 1.2

  Even includes new line!
| long row 1.3
  [{## code=lua}
  function example()
    return "code block"
  end
  ]##
+ row 2.1
| row 2.2
| row 2.3
]</code>
<p>
<table>
<tr>
<th>1st header column
</th>
<th>2nd header column
</th>
<th>3rd header column</th>
</tr>
<tr>
<td>long row 1.1
</td>
<td>long row 1.2
<p>
Even includes new line!
</td>
<td>long row 1.3
<code class="block">function example()
  return "code block"
end</code></td>
</tr>
<tr>
<td>row 2.1
</td>
<td>row 2.2
</td>
<td>row 2.3</td>
</tr>
</table>
<p>
<h3>Named Nodes and Values</h3>
<blockquote> <b>Note</b>: all visible named blocks have a ☍ link next to them and serve dual
purpose of being referenced within the cxt file using <code>[@name]</code> and by
local and external links (<code>href=#name</code>) </blockquote>
<p>
<code>A hidden named block: "[{!:href=http://civboot.org}Civboot]"</code> <ul>
<li>A hidden named block: ""</li>
</ul>
<p>
<code>A visible named block: [{:href=https://github.com/civboot/civlua}civlua]</code> <ul>
<li>A visible named block: <a id="civlua" href="#civlua"><a href="https://github.com/civboot/civlua">civlua</a></a></li>
</ul>
<p>
<code>[@Civboot] clones the hidden block (removing the [$clone] attribute)</code> <ul>
<li><a href="http://civboot.org">Civboot</a> clones the hidden block (removing the <code>clone</code> attribute)</li>
</ul>
<p>
<code>[&lt;@Civboot&gt;Civboot Project] has [$href=http://civboot.org].</code><ul>
<li><a href="http://civboot.org">Civboot Project</a> has <code>href=http://civboot.org</code>.</li>
</ul>
<p>
<code class="block">You can also link to named blocks with [$href=#name], for instance the "Demos"
header is named [&lt;#Demos&gt;Demos].</code> <ul>
<li>You can also link to named blocks with <code>href=#name</code>, for instance the "Demos"
header is named <a href="#Demos">Demos</a>.</li>
</ul>
<p>
<h3>Escaping [brackets]</h3>
<code class="block">You can \[escape\] brackets to render them directly. You can also escape '\\'.</code> <ul>
<li>You can [escape] brackets to render them directly. You can also escape '\'.</li>
</ul>
<p>
<h2>UNLICENSE</h2>
Cxt is in the the public domain, see the <a href="../UNLICENSE">UNLICENSE</a> for details.
<p>
It was originally created by Rett Berg as part of the <a href="http://civboot.org">Civboot</a> project.
<p>
<h2>Module <a id="cxt" href="#cxt">cxt</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L3"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="cxt.__name" href="#cxt.__name">cxt.__name</a></h4>
<h3>Table <a id="cxt.attr" href="#cxt.attr">cxt.attr</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L69"><i>src</i></a>)</h3>
<h3>Table <a id="cxt.attrSym" href="#cxt.attrSym">cxt.attrSym</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L64"><i>src</i></a>)</h3><code class="block">M.attrSym = Key{kind='attrSym', {
  '!',             -- hidden
  '*', '/', '_',   -- bold, italic, underline
  ':',             -- define node name
}}</code>
<h3>Table <a id="cxt.attrs" href="#cxt.attrs">cxt.attrs</a></h3>
<h3>Table <a id="cxt.fmtAttr" href="#cxt.fmtAttr">cxt.fmtAttr</a></h3>
<h3>Table <a id="cxt.htmlFmt" href="#cxt.htmlFmt">cxt.htmlFmt</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L442"><i>src</i></a>)</h3>
<h3>Table <a id="cxt.keyval" href="#cxt.keyval">cxt.keyval</a></h3>
<h3>Record <a id="cxt.Config" href="#cxt.Config">cxt.Config</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L447"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>cxt.Config.header</code></td>
<td>[string] 
typically used for html header</td>
</tr>
<tr>
<td><code>cxt.Config.pathUrl</code></td>
<td>[function(path) -> url] = <code>fn"ds.iden"[/home/rett/projects/civlua/lib/ds/ds.lua:89]</code></td>
</tr>
</table>
<h3>Table <a id="cxt.Config.__docs" href="#cxt.Config.__docs">cxt.Config.__docs</a></h3>
<h3>Table <a id="cxt.Config.__fieldIds" href="#cxt.Config.__fieldIds">cxt.Config.__fieldIds</a></h3>
<h3>Table <a id="cxt.Config.__fields" href="#cxt.Config.__fields">cxt.Config.__fields</a></h3>
<h4>Value <a id="cxt.Config.__name" href="#cxt.Config.__name">cxt.Config.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>cxt.Config.__index</code></td>
<td>[Ty<Config>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L447">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>cxt.Config.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Record <a id="cxt.Writer" href="#cxt.Writer">cxt.Writer</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L460"><i>src</i></a>)</h3>
A Writer for cxt serializers (terminal, http, etc) to use.
<p>
The writer contains: <ul>
<li>The src lines and token decoder for getting pegl.Token values.</li>
<li>The destination lines and current indent level.</li>
</ul>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>cxt.Writer.src</code></td>
<td>  </td>
</tr>
<tr>
<td><code>cxt.Writer.to</code></td>
<td>  </td>
</tr>
<tr>
<td><code>cxt.Writer.indent</code></td>
<td>[int] </td>
</tr>
<tr>
<td><code>cxt.Writer.style</code></td>
<td>[string] 
see asciicolor.style</td>
</tr>
<tr>
<td><code>cxt.Writer.config</code></td>
<td>[Config] = <code>Config{header=nil, pathUrl=fn"ds.iden"[/home/rett/projects/civlua/lib/ds/ds.lua:89]}</code></td>
</tr>
</table>
<h3>Table <a id="cxt.Writer.__docs" href="#cxt.Writer.__docs">cxt.Writer.__docs</a></h3>
<h3>Table <a id="cxt.Writer.__fieldIds" href="#cxt.Writer.__fieldIds">cxt.Writer.__fieldIds</a></h3>
<h3>Table <a id="cxt.Writer.__fields" href="#cxt.Writer.__fields">cxt.Writer.__fields</a></h3>
<h4>Value <a id="cxt.Writer.__name" href="#cxt.Writer.__name">cxt.Writer.__name</a></h4>
<h4>Function <a id="Writer.__len" href="#Writer.__len">Writer.__len</a><code>(w) -&gt; #w.to</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L477"><i>src</i></a>)</h4>
<h4>Function <a id="Writer.fromParser" href="#Writer.fromParser">Writer.fromParser</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L463"><i>src</i></a>)</h4>
<h4>Function <a id="Writer.level" href="#Writer.level">Writer.level</a><code>(w, add) -&gt; w.to:level(add)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L478"><i>src</i></a>)</h4>
<h4>Function <a id="Writer.tokenStr" href="#Writer.tokenStr">Writer.tokenStr</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L466"><i>src</i></a>)</h4>
<h3>Function <a id="cxt._codeHashes" href="#cxt._codeHashes">cxt._codeHashes</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L38"><i>src</i></a>)</h3>
<h3>Function <a id="cxt._hasUnbalancedBrackets" href="#cxt._hasUnbalancedBrackets">cxt._hasUnbalancedBrackets</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L34"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.assertParse" href="#cxt.assertParse">cxt.assertParse</a><code>(dat, expected, dbg) -&gt; node</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L439"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.checkParse" href="#cxt.checkParse">cxt.checkParse</a><code>(dat, context) -&gt; dat</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L415"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.code" href="#cxt.code">cxt.code</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L52"><i>src</i></a>)</h3>
create <code>[$inline code]</code>
<h3>Function <a id="cxt.codeblock" href="#cxt.codeblock">cxt.codeblock</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L45"><i>src</i></a>)</h3>
create a <code>[##code block]##</code>
<h3>Function <a id="cxt.content" href="#cxt.content">cxt.content</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L346"><i>src</i></a>)</h3>
parse normal content, adding to node
<h3>Function <a id="cxt.escape" href="#cxt.escape">cxt.escape</a><code>(str) -&gt; str:gsub('([\\%[%]])', '\\%1')</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L25"><i>src</i></a>)</h3>
escape the string so it renders literally
<h3>Function <a id="cxt.parse" href="#cxt.parse">cxt.parse</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L403"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.parsedStrings" href="#cxt.parsedStrings">cxt.parsedStrings</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt.lua#L432"><i>src</i></a>)</h3>
<h2>Module <a id="cxt.html" href="#cxt.html">cxt.html</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/html.lua#L2"><i>src</i></a>)</h2>
Serialize cxt nodes as html
<p>
<h4>Value <a id="cxt.html.__name" href="#cxt.html.__name">cxt.html.__name</a></h4>
<h4>Value <a id="cxt.html.htmlHead" href="#cxt.html.htmlHead">cxt.html.htmlHead</a></h4>
<h3>Function <a id="cxt.html.assertHtml" href="#cxt.html.assertHtml">cxt.html.assertHtml</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/html.lua#L227"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.html.convert" href="#cxt.html.convert">cxt.html.convert</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/html.lua#L220"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.html.main" href="#cxt.html.main">cxt.html.main</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/html.lua#L244"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.html.serialize" href="#cxt.html.serialize">cxt.html.serialize</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/html.lua#L205"><i>src</i></a>)</h3>
serialize the node to the writer.
<h3>Function <a id="cxt.html.serializeDoc" href="#cxt.html.serializeDoc">cxt.html.serializeDoc</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/html.lua#L212"><i>src</i></a>)</h3>
<h2>Module <a id="cxt.term" href="#cxt.term">cxt.term</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/term.lua#L3"><i>src</i></a>)</h2>
cxt for the terminal, either plain text or vt100/etc
<p>
<h3>Table <a id="cxt.term.HEADER" href="#cxt.term.HEADER">cxt.term.HEADER</a></h3>
<h3>Table <a id="cxt.term.STYLES" href="#cxt.term.STYLES">cxt.term.STYLES</a></h3>
<h4>Value <a id="cxt.term.__name" href="#cxt.term.__name">cxt.term.__name</a></h4>
<h3>Record <a id="cxt.term.Args" href="#cxt.term.Args">cxt.term.Args</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/term.lua#L26"><i>src</i></a>)</h3>
Render cxt on a terminal.
<p>
Will render an input string or --inp=file.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>cxt.term.Args.inp</code></td>
<td>[path</td>
<td>file] 
input file</td>
</tr>
<tr>
<td><code>cxt.term.Args.out</code></td>
<td>[path</td>
<td>file] 
output file (default=stdout)</td>
</tr>
</table>
<b>Values: </b> <table>
<tr>
<td><code>cxt.term.Args.__name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="cxt.term.Args.__docs" href="#cxt.term.Args.__docs">cxt.term.Args.__docs</a></h3>
<h3>Table <a id="cxt.term.Args.__fieldIds" href="#cxt.term.Args.__fieldIds">cxt.term.Args.__fieldIds</a></h3>
<h3>Table <a id="cxt.term.Args.__fields" href="#cxt.term.Args.__fields">cxt.term.Args.__fields</a></h3>
<b>Records: </b> <table>
<tr>
<td><code>cxt.term.Args.__index</code></td>
<td>[Ty<Args>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/term.lua#L26">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>cxt.term.Args.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Function <a id="cxt.term.convert" href="#cxt.term.convert">cxt.term.convert</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/term.lua#L125"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.term.main" href="#cxt.term.main">cxt.term.main</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/term.lua#L136"><i>src</i></a>)</h3>
<h3>Function <a id="cxt.term.serialize" href="#cxt.term.serialize">cxt.term.serialize</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/cxt/cxt/term.lua#L117"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_doc" href="#Package_doc">Package doc</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc"><i>src</i></a>)</h1><table>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_doc">https://lua.civboot.org#Package_doc</a></td>
</tr>
</table>
Get documentation on any Lua object. Includes documentation for several items
in the lua stdlibrary.
<p>
<blockquote>Note: This requires the PKG protocol to be installed, see <a href="https://github.com/civboot/civlua/blob/main/lib/pkg">lib/pkg</a></blockquote>
<p>
Making a library's types self-documenting is easy:
<p>
<code class="block">local G = G or _G
-- My module docs
local M = G.mod and mod'myModName' or {}

--- my fn docs in [$cxt]
M.myFn = function(a, b) --&gt; string
  -- do stuff
end</code>
<p>
See Package pkg and Package cxt for more details.
<p>
<b>Other Resources</b> <ul>
<li>Lua API reference: <a href="https://www.lua.org/manual">https://www.lua.org/manual</a></li>
<li>Tutorial style documentation: <a href="https://www.lua.org/pil/contents.html">https://www.lua.org/pil/contents.html</a></li>
</ul>
<p>
<h2>Module <a id="doc" href="#doc">doc</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L10"><i>src</i></a>)</h2>
Get documentation for lua types and syntax.
Examples: <code class="block">doc{string.find}
doc'for'
doc'myMod.myFunction'
doc{'someMod', --pkg} -- full pkg documentation</code>
<p>
<blockquote>Note: depends on pkg for lookup</blockquote>
<p>
<h4>Value <a id="doc.__name" href="#doc.__name">doc.__name</a></h4>
<h3>Record <a id="doc.Args" href="#doc.Args">doc.Args</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L440"><i>src</i></a>)</h3>
Get documentation for an object or package. Usage: <code class="block"> help 'path.of.object'</code>
<p>
If no path is given shows all available packages.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>doc.Args.help</code></td>
<td>[bool] 
get help</td>
</tr>
<tr>
<td><code>doc.Args.to</code></td>
<td>[path] 
the output. If ends in <code>.html</code> then auto-converts to html</td>
</tr>
<tr>
<td><code>doc.Args.pkg</code></td>
<td>[deep</td>
<td>bool] 
if true uses PKG.lua (and all sub-modules). If "deep" also uses PKG.pkgs</td>
</tr>
<tr>
<td><code>doc.Args.expand</code></td>
<td>[int</td>
<td>bool] = <code>1</code>
expand to depth (expand=true means expand=10)</td>
</tr>
<tr>
<td><code>doc.Args.local</code></td>
<td>[bool] 
if true only unpacks local pkgs/mods</td>
</tr>
</table>
<b>Values: </b> <table>
<tr>
<td><code>doc.Args.__name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="doc.Args.__docs" href="#doc.Args.__docs">doc.Args.__docs</a></h3>
<h3>Table <a id="doc.Args.__fieldIds" href="#doc.Args.__fieldIds">doc.Args.__fieldIds</a></h3>
<h3>Table <a id="doc.Args.__fields" href="#doc.Args.__fields">doc.Args.__fields</a></h3>
<b>Records: </b> <table>
<tr>
<td><code>doc.Args.__index</code></td>
<td>[Ty<Args>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L440">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>doc.Args.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Record <a id="doc.Doc" href="#doc.Doc">doc.Doc</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L93"><i>src</i></a>)</h3>
Documentation on a single type
These pull together the various sources of documentation
from the PKG and META_TY specs into a single object.
<p>
<b>Fields: </b> <table>
<tr>
<td><code>doc.Doc.obj</code></td>
<td>[any] 
the object being documented</td>
</tr>
<tr>
<td><code>doc.Doc.name</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>doc.Doc.pkgname</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>doc.Doc.ty</code></td>
<td>[Type] 
type, can be string</td>
</tr>
<tr>
<td><code>doc.Doc.docTy</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>doc.Doc.path</code></td>
<td>[str] </td>
</tr>
<tr>
<td><code>doc.Doc.main</code></td>
<td>[Doc] 
main Args, mostly used for PKG</td>
</tr>
<tr>
<td><code>doc.Doc.meta</code></td>
<td>[table] 
metadata, mostly used for PKG</td>
</tr>
<tr>
<td><code>doc.Doc.comments</code></td>
<td>[lines] 
comments above item</td>
</tr>
<tr>
<td><code>doc.Doc.fnsig</code></td>
<td>[string] 
function signature</td>
</tr>
<tr>
<td><code>doc.Doc.code</code></td>
<td>[lines] 
code which defines the item</td>
</tr>
<tr>
<td><code>doc.Doc.call</code></td>
<td>[function] </td>
</tr>
<tr>
<td><code>doc.Doc.fields</code></td>
<td>[table{name=DocItem}] 
(for metatys)</td>
</tr>
<tr>
<td><code>doc.Doc.values</code></td>
<td>[table] 
raw values that are not the other types</td>
</tr>
<tr>
<td><code>doc.Doc.tys</code></td>
<td>[table] 
table of values</td>
</tr>
<tr>
<td><code>doc.Doc.fns</code></td>
<td>[table] 
methods or functions</td>
</tr>
<tr>
<td><code>doc.Doc.mods</code></td>
<td>[table] 
sub modules (for PKG)</td>
</tr>
<tr>
<td><code>doc.Doc.lvl</code></td>
<td>[int] 
level inside another type (nil or 1)</td>
</tr>
</table>
<h3>Table <a id="doc.Doc.__docs" href="#doc.Doc.__docs">doc.Doc.__docs</a></h3>
<h3>Table <a id="doc.Doc.__fieldIds" href="#doc.Doc.__fieldIds">doc.Doc.__fieldIds</a></h3>
<h3>Table <a id="doc.Doc.__fields" href="#doc.Doc.__fields">doc.Doc.__fields</a></h3>
<h4>Value <a id="doc.Doc.__name" href="#doc.Doc.__name">doc.Doc.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>doc.Doc.__index</code></td>
<td>[Ty<Doc>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L93">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>doc.Doc.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Doc.__tostring" href="#Doc.__tostring">Doc.__tostring</a><code>(d) -&gt; sfmt('Doc%q', d.name)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L95"><i>src</i></a>)</h4>
<h3>Record <a id="doc.DocItem" href="#doc.DocItem">doc.DocItem</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L103"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>doc.DocItem.obj</code></td>
<td>[any] </td>
</tr>
<tr>
<td><code>doc.DocItem.name</code></td>
<td>  </td>
</tr>
<tr>
<td><code>doc.DocItem.pkgname</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>doc.DocItem.ty</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>doc.DocItem.docTy</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>doc.DocItem.path</code></td>
<td>[string] </td>
</tr>
<tr>
<td><code>doc.DocItem.fnsig</code></td>
<td>[string] 
function signature</td>
</tr>
<tr>
<td><code>doc.DocItem.default</code></td>
<td>[any] </td>
</tr>
<tr>
<td><code>doc.DocItem.doc</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="doc.DocItem.__docs" href="#doc.DocItem.__docs">doc.DocItem.__docs</a></h3>
<h3>Table <a id="doc.DocItem.__fieldIds" href="#doc.DocItem.__fieldIds">doc.DocItem.__fieldIds</a></h3>
<h3>Table <a id="doc.DocItem.__fields" href="#doc.DocItem.__fields">doc.DocItem.__fields</a></h3>
<h4>Value <a id="doc.DocItem.__name" href="#doc.DocItem.__name">doc.DocItem.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>doc.DocItem.__index</code></td>
<td>[Ty<DocItem>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L103">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>doc.DocItem.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="DocItem.__tostring" href="#DocItem.__tostring">DocItem.__tostring</a><code>(di) -&gt; sfmt('DocItem%q', di.name)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L105"><i>src</i></a>)</h4>
<h3>Record <a id="doc._Construct" href="#doc._Construct">doc._Construct</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L123"><i>src</i></a>)</h3>
internal type to construct Doc and DocItems
<p>
<b>Fields: </b> <table>
<tr>
<td><code>doc._Construct.done</code></td>
<td>[table] 
objects already documented</td>
</tr>
</table>
<h3>Table <a id="doc._Construct.__docs" href="#doc._Construct.__docs">doc._Construct.__docs</a></h3>
<h3>Table <a id="doc._Construct.__fieldIds" href="#doc._Construct.__fieldIds">doc._Construct.__fieldIds</a></h3>
<h3>Table <a id="doc._Construct.__fields" href="#doc._Construct.__fields">doc._Construct.__fields</a></h3>
<h4>Value <a id="doc._Construct.__name" href="#doc._Construct.__name">doc._Construct.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>doc._Construct.__index</code></td>
<td>[Ty<_Construct>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L123">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>doc._Construct.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="_Construct.__call" href="#_Construct.__call">_Construct.__call</a><code>(c, obj, key, expand, lvl) -&gt; Doc | DocItem</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L207"><i>src</i></a>)</h4>
<h4>Function <a id="_Construct.main" href="#_Construct.main">_Construct.main</a><code>(c, obj) -&gt; Doc</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L247"><i>src</i></a>)</h4>
<h4>Function <a id="_Construct.pkg" href="#_Construct.pkg">_Construct.pkg</a><code>(c, pkg, expand) -&gt; Doc</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L239"><i>src</i></a>)</h4>
<h3>Function <a id="doc.cleanFieldTy" href="#doc.cleanFieldTy">doc.cleanFieldTy</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L295"><i>src</i></a>)</h3>
<h3>Function <a id="doc.construct" href="#doc.construct">doc.construct</a><code>(obj, key, expand, lvl) -&gt; M._Construct{}(obj, key, expand, lvl)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L118"><i>src</i></a>)</h3>
get a Doc or DocItem. If expand is true then recurse.
<h3>Function <a id="doc.docHeader" href="#doc.docHeader">doc.docHeader</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L365"><i>src</i></a>)</h3>
<h3>Function <a id="doc.find" href="#doc.find">doc.find</a><code>(obj) -&gt; Object</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L43"><i>src</i></a>)</h3>
Find the object or name in pkgs
<h3>Function <a id="doc.findcode" href="#doc.findcode">doc.findcode</a><code>(loc) -&gt; (commentLines, codeLines)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L291"><i>src</i></a>)</h3>
<h3>Function <a id="doc.fmt" href="#doc.fmt">doc.fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L426"><i>src</i></a>)</h3>
<h3>Function <a id="doc.fmtAttr" href="#doc.fmtAttr">doc.fmtAttr</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L359"><i>src</i></a>)</h3>
<h3>Function <a id="doc.fmtDoc" href="#doc.fmtDoc">doc.fmtDoc</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L419"><i>src</i></a>)</h3>
<h3>Function <a id="doc.fmtDocItem" href="#doc.fmtDocItem">doc.fmtDocItem</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L335"><i>src</i></a>)</h3>
<h3>Function <a id="doc.fmtMeta" href="#doc.fmtMeta">doc.fmtMeta</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L374"><i>src</i></a>)</h3>
<h3>Function <a id="doc.getpath" href="#doc.getpath">doc.getpath</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L315"><i>src</i></a>)</h3>
get any path with <code>.</code> in it. This is mostly used by help/etc functions
<h3>Function <a id="doc.main" href="#doc.main">doc.main</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L480"><i>src</i></a>)</h3>
<h3>Function <a id="doc.modinfo" href="#doc.modinfo">doc.modinfo</a><code>(obj) -&gt; (name, loc)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L261"><i>src</i></a>)</h3>
<h3>Function <a id="doc.stripComments" href="#doc.stripComments">doc.stripComments</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L302"><i>src</i></a>)</h3>
<h3>Function <a id="doc.type" href="#doc.type">doc.type</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/doc.lua#L115"><i>src</i></a>)</h3>
return the object's "document type"
<h2>Module <a id="doc.lua" href="#doc.lua">doc.lua</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L15"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="doc.lua.__name" href="#doc.lua.__name">doc.lua.__name</a></h4>
<h3>Table <a id="false" href="#false">false</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L542"><i>src</i></a>)</h3>
<h3>Table <a id="io.fmt" href="#io.fmt">io.fmt</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h4>Value <a id="io.stderr" href="#io.stderr">io.stderr</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h4>
not documented: see <code>string</code> module
<h4>Value <a id="io.stdin" href="#io.stdin">io.stdin</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h4>
not documented: see <code>string</code> module
<h4>Value <a id="io.stdout" href="#io.stdout">io.stdout</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h4>
not documented: see <code>string</code> module
<h3>Table <a id="local" href="#local">local</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L536"><i>src</i></a>)</h3>
<code>local x = (expression)</code>
<p>
Define a local (instead of a global) variable. Prefer local variables for
most things unless you are: <ul>
<li>modifying the fundamentals of the language (i.e. replacing 'require')</li>
<li>implementing a "protocol" for libraries to communicate global state</li>
<li>managing true physical state (i.e. robotics, terminal output, etc)</li>
<li>you are the top-level application (i.e. a game, CLI, etc) and global state
is the best solution.</li>
</ul>
<h4>Value <a id="doc.lua.math.huge" href="#doc.lua.math.huge">doc.lua.math.huge</a></h4>
<h4>Value <a id="doc.lua.math.maxinteger" href="#doc.lua.math.maxinteger">doc.lua.math.maxinteger</a></h4>
<h4>Value <a id="doc.lua.math.mininteger" href="#doc.lua.math.mininteger">doc.lua.math.mininteger</a></h4>
<h4>Value <a id="doc.lua.math.pi" href="#doc.lua.math.pi">doc.lua.math.pi</a></h4>
<h3>Table <a id="nil" href="#nil">nil</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L547"><i>src</i></a>)</h3>
<code>nil</code> value, the the absense of a value. Used for: <ul>
<li>a variable is not set or has been set to <code>nil</code></li>
<li>a table key is not set or has been set to <code>nil</code></li>
</ul>
<h3>Table <a id="true" href="#true">true</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L540"><i>src</i></a>)</h3>
<b>Functions: </b> <table>
<tr>
<td><code>doc.lua.io.close</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.flush</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.input</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.lines</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.open</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.output</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.popen</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.read</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.tmpfile</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.type</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.write</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.abs</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.acos</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L449">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.asin</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L450">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.atan</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L451">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.atan2</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L451">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.ceil</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.cos</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L446">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.cosh</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.deg</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.exp</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L452">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.floor</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.fmod</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.frexp</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.ldexp</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.log</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.log10</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.max</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L444">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.min</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L444">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.modf</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.pow</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.rad</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.random</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.randomseed</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.sin</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L447">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.sinh</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.sqrt</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.tan</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L448">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.tanh</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.tointeger</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.type</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L443">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.math.ult</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.clock</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.date</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.difftime</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.execute</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L433">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.exit</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.getenv</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.remove</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.rename</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.setlocale</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.time</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.os.tmpname</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.byte</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L227">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.char</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L230">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.concat</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L121">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.find</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L157">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.format</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L222">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.gmatch</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L170">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.gsub</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L190">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.match</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L163">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.pack</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L256">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.packsize</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L262">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.rep</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L233">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.sub</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L176">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.string.unpack</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L259">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.table.concat</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L303">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.table.insert</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L328">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.table.move</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L340">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.table.remove</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L307">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.table.sort</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L311">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.table.update</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L294">src</a>)</td>
</tr>
</table>
<h3>Function <a id="for" href="#for">for</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L523"><i>src</i></a>)</h3>
for is a looping construct with two forms:
<p>
Numeric: <code class="block">  for i=si,ei,period do -- period=1 by default
    ... do something with i
  end

  -- is basically the same as
  local i = si
  while i &lt;= ei do i = i + si
    ... do something with i
  end</code>
<p>
Generic: <code class="block">  for i, v, etc in (nextfn, state, _index) do
    .. do something with i, v, ...
  end

  -- is almost the same as
  while true do
    local i, v, etc = nextfn(state, _index)
    if i == nil then break end
    _index = i -- note: C internal, _index from lua doesn't change
    ... code using i, v, etc here
  end</code>
<p>
The goal in writing a stateless iterator function is to match this
loop's API as much as possible.
<p>
Example rewriting ipairs: <code class="block">  local function rawipairs(t, i)
    i = i + 1
    if i &gt; #t then return nil end
    return i, t[i]
  end
  local function myipairs_(t)
    return rawipairs, t, 0
  end
  for i, v in myipairs{5, 6, 7} do
    iterates through (1, 5) -&gt; (2, 6) -&gt; (3, 7)
  end</code>
<p>
Example rewriting pairs using <code>next(t, key)</code>: <code class="block">  function mypairs(t)
    return next, t, nil
  end
  for k, v in mypairs{a=1, b=2, c=3} do
    iterates through ('a', 1) -&gt; ('b', 2) -&gt; ('c', 3)
  end</code>
<p>
See also: metaty.split is a more complex example.
<h3>Function <a id="getmetatable" href="#getmetatable">getmetatable</a><code>(t) -&gt; mt</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L98"><i>src</i></a>)</h3>
See setmetatable.
<h3>Function <a id="keyword" href="#keyword">keyword</a><code>() -&gt; setmetatable({}, Keyword)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L20"><i>src</i></a>)</h3>
<h3>Function <a id="next" href="#next">next</a><code>(tbl, key) -&gt; nextKey</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L53"><i>src</i></a>)</h3>
Get the next key in the table. Used for iterating through tables.
If <code>key=nil</code> returns the first key. Returns <code>nil</code> when <code>key</code> is
the last key.
<h3>Function <a id="pcall" href="#pcall">pcall</a><code>(fn, ...) -&gt; ok, fn(...)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L57"><i>src</i></a>)</h3>
call a function but catch errors. Returns <code>ok</code> followed by the function
results. If not ok, returns the error.
<h3>Function <a id="select" href="#select">select</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L62"><i>src</i></a>)</h3>
select elements in varargs <code>...</code> at and after index.
<p>
Special value: if <code>index='#'</code> then returns length of <code>...</code>
<h3>Function <a id="setmetatable" href="#setmetatable">setmetatable</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L95"><i>src</i></a>)</h3>
Sets the metatable on the table which can get gotten with
<code>getmetatable</code> and affects the behavior of operators.
<p>
All metamethods: <code class="block">__index    (i.e. t[k])     NOTE: these are only called
__newindex (i.e. t[k] = v)       when key is missing!

__call     (i.e. t())
__tostring (i.e. tostring(t))

+         -        *        /       //        %
__add     __sub    __mul    __div   __idiv    __mod
          __unm

&         |        ~        &lt;&lt;      &gt;&gt;        ^
__band    __bor    __bnot   __shl   __shr     __pow

==        &lt;        &lt;=       #        ..
__eq      __lt     __le     __len    __concat

__name</code>
<p>
<blockquote> See also metaty metamethods: __fields   __fmt</blockquote>
<h3>Function <a id="tostring" href="#tostring">tostring</a><code>(v) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L101"><i>src</i></a>)</h3>
Convert any value to a string by calling __tostring or using lua's default.
<h3>Function <a id="type" href="#type">type</a><code>(val) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L69"><i>src</i></a>)</h3>
Get the type of <code>val</code>. Possible return values are: <ul>
<li>data: nil number string boolean table</li>
<li>other: function thread userdata</li>
</ul>
<blockquote> See also: metaty.ty(v) for metatypes</blockquote>
<p>
<h2>Module <a id="io" href="#io">io</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L383"><i>src</i></a>)</h2>
the builtin lua io (input/output) module
<p>
Module Functions: <table>
<tr>
<td><code> input(file=nil)  -&gt;  file  </code></td>
<td>get/set stdin</td>
</tr>
<tr>
<td><code> output(file=nil) -&gt;  file  </code></td>
<td>get/set stdout</td>
</tr>
<tr>
<td><code> tmpfile() -&gt; file          </code></td>
<td>note: removed on program exit</td>
</tr>
<tr>
<td><code> popen()   -&gt; file          </code></td>
<td>see io.popen</td>
</tr>
<tr>
<td><code> lines(path or file) -&gt; iter</code></td>
<td>close when done, fail=error</td>
</tr>
<tr>
<td><code> type(f) -&gt; "[closed ]file" </code></td>
<td>get whether f is a file</td>
</tr>
</table>
<p>
File Methods: <table>
<tr>
<td><code> read(format="l")  </code></td>
<td>read a file according to format</td>
</tr>
<tr>
<td><code> lines(format="l") </code></td>
<td>get iterator for reading format</td>
</tr>
<tr>
<td><code> write(a, b, ...)  </code></td>
<td>write strings a, b, ... in order</td>
</tr>
<tr>
<td><code> flush()           </code></td>
<td>flush (save) all writes</td>
</tr>
<tr>
<td><code> seek(whence, offset)</code></td>
<td>see seek section below</td>
</tr>
<tr>
<td><code> setvbuf("no|full|line", sizeHint=appropriateSize)</code> see function</td>
</tr>
</table>
<p>
Format paramater used in read/etc <table>
<tr>
<td>format</td>
<td>behavior</td>
<td>(in Lua<=5.2)</td>
</tr>
<tr>
<td>a</td>
<td>read all text                        *a</td>
</tr>
<tr>
<td>l</td>
<td>read next line, skip EOL             *l</td>
</tr>
<tr>
<td>L</td>
<td>read next line, keep EOL             *L</td>
</tr>
<tr>
<td>n</td>
<td>read and return a number             *n</td>
</tr>
<tr>
<td>number</td>
<td>read an exact number of bytes, EOF=nil</td>
</tr>
<tr>
<td>0</td>
<td>EOF=nil, notEOF=''</td>
</tr>
</table>
<p>
seek <table>
<tr>
<td><code> whence="set" </code></td>
<td>offset from beginning of file (0)</td>
</tr>
<tr>
<td><code> whence="cur" </code></td>
<td>offset from current position</td>
</tr>
<tr>
<td><code> whence="end" </code></td>
<td>offset from end of file (use negative)</td>
</tr>
<tr>
<td><code> seek()       </code></td>
<td>get current position</td>
</tr>
<tr>
<td><code> seek'set'    </code></td>
<td>set to beginning</td>
</tr>
<tr>
<td><code> seek'end'    </code></td>
<td>set to end</td>
</tr>
</table>
<p>
<b>Values: </b> <table>
<tr>
<td><code>doc.lua.io.fmt</code></td>
<td>[Fmt] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.stderr</code></td>
<td>[userdata] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.stdin</code></td>
<td>[userdata] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
<tr>
<td><code>doc.lua.io.stdout</code></td>
<td>[userdata] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265">src</a>)</td>
</tr>
</table>
<h3>Function <a id="io.close" href="#io.close">io.close</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.flush" href="#io.flush">io.flush</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.input" href="#io.input">io.input</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.lines" href="#io.lines">io.lines</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.open" href="#io.open">io.open</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.output" href="#io.output">io.output</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.popen" href="#io.popen">io.popen</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.read" href="#io.read">io.read</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.tmpfile" href="#io.tmpfile">io.tmpfile</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.type" href="#io.type">io.type</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h3>Function <a id="io.write" href="#io.write">io.write</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L265"><i>src</i></a>)</h3>
not documented: see <code>string</code> module
<h2>Module <a id="math" href="#math">math</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L441"><i>src</i></a>)</h2>
The builtin lua math module.
<p>
<b>Values: </b> <table>
<tr>
<td><code>doc.lua.math.huge</code></td>
<td>[number] </td>
</tr>
<tr>
<td><code>doc.lua.math.maxinteger</code></td>
<td>[number] </td>
</tr>
<tr>
<td><code>doc.lua.math.mininteger</code></td>
<td>[number] </td>
</tr>
<tr>
<td><code>doc.lua.math.pi</code></td>
<td>[number] </td>
</tr>
</table>
<b>Functions: </b> <table>
<tr>
<td><code>doc.lua.math.atan2</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L451">src</a>)</td>
</tr>
</table>
<h3>Function <a id="math.abs" href="#math.abs">math.abs</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.acos" href="#math.acos">math.acos</a><code>(x) -&gt; arccos(x) in radians</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L449"><i>src</i></a>)</h3>
<h3>Function <a id="math.asin" href="#math.asin">math.asin</a><code>(x) -&gt; arcsin(x) in radians</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L450"><i>src</i></a>)</h3>
<h3>Function <a id="n" href="#n">n</a><code>(n, d) -&gt; arctan(n / d) in radians</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L451"><i>src</i></a>)</h3>
<h3>Function <a id="math.ceil" href="#math.ceil">math.ceil</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.cos" href="#math.cos">math.cos</a><code>(x) -&gt; cos(x) in radians</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L446"><i>src</i></a>)</h3>
<h3>Function <a id="math.cosh" href="#math.cosh">math.cosh</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.deg" href="#math.deg">math.deg</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.exp" href="#math.exp">math.exp</a><code>(x) -&gt; e^x (where e is the natural log base)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L452"><i>src</i></a>)</h3>
<h3>Function <a id="math.floor" href="#math.floor">math.floor</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.fmod" href="#math.fmod">math.fmod</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.frexp" href="#math.frexp">math.frexp</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.ldexp" href="#math.ldexp">math.ldexp</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.log" href="#math.log">math.log</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.log10" href="#math.log10">math.log10</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="" href="#"></a><code>(x, ...) -&gt; max according to [$&lt;]</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L444"><i>src</i></a>)</h3>
<h3>Function <a id="math.modf" href="#math.modf">math.modf</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.pow" href="#math.pow">math.pow</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.rad" href="#math.rad">math.rad</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.random" href="#math.random">math.random</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.randomseed" href="#math.randomseed">math.randomseed</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.sin" href="#math.sin">math.sin</a><code>(x) -&gt; sin(x) in radians</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L447"><i>src</i></a>)</h3>
<h3>Function <a id="math.sinh" href="#math.sinh">math.sinh</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.sqrt" href="#math.sqrt">math.sqrt</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.tan" href="#math.tan">math.tan</a><code>(x) -&gt; tan(x) in radians</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L448"><i>src</i></a>)</h3>
<h3>Function <a id="math.tanh" href="#math.tanh">math.tanh</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.tointeger" href="#math.tointeger">math.tointeger</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h3>Function <a id="math.type" href="#math.type">math.type</a><code>(v) -&gt; ("float" | "integer" | nil)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L443"><i>src</i></a>)</h3>
<h3>Function <a id="math.ult" href="#math.ult">math.ult</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L459"><i>src</i></a>)</h3>
currently not documented
<h2>Module <a id="os" href="#os">os</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L415"><i>src</i></a>)</h2>
the builtin lua os module
<p>
Useful functions: <table>
<tr>
<td><code>exit(rc=0, close=false)</code></td>
<td>exit program with return code</td>
</tr>
<tr>
<td><code>date()</code></td>
<td>get the date. See os.date</td>
</tr>
<tr>
<td><code>execute'command'</code></td>
<td>execute command, see os.execute</td>
</tr>
<tr>
<td><code>getenv(varname)</code></td>
<td>get environment variable</td>
</tr>
<tr>
<td><code>remove(path)</code></td>
<td>rm path</td>
</tr>
<tr>
<td><code>rename(old, new)</code></td>
<td>mv old new</td>
</tr>
<tr>
<td><code>tmpname() -&gt; path</code></td>
<td>create temporary file</td>
</tr>
<tr>
<td><code>clock()</code></td>
<td>seconds used by process (performance)</td>
</tr>
</table>
<p>
Recommendations: <ul>
<li>use civix.epoch() (nanosec precision) vs os.time() (sec precision)</li>
</ul>
<p>
<h3>Function <a id="os.clock" href="#os.clock">os.clock</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.date" href="#os.date">os.date</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.difftime" href="#os.difftime">os.difftime</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.execute" href="#os.execute">os.execute</a><code>(string) -&gt; (ok, "exit", rc)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L433"><i>src</i></a>)</h3>
Execute shell command via C's `system` API. Returns: <ul>
<li>ok:      true on command success, false if rc>0</li>
<li>"exit":  always literal "exit" if command completed</li>
<li>rc:      the return code of the command</li>
</ul>
<code class="block">  os.execute'shell command' -&gt; (ok, "exit", rc)
  os.execute()              -&gt; isShellAvailable</code>
<p>
Prints whatever was executed. There are no ways to
redirect the output besides piping in the command
string itself.
<p>
Recommendation:
For all but the simplest cases use io.popen instead
<h3>Function <a id="os.exit" href="#os.exit">os.exit</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.getenv" href="#os.getenv">os.getenv</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.remove" href="#os.remove">os.remove</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.rename" href="#os.rename">os.rename</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.setlocale" href="#os.setlocale">os.setlocale</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.time" href="#os.time">os.time</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h3>Function <a id="os.tmpname" href="#os.tmpname">os.tmpname</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L436"><i>src</i></a>)</h3>
not documented: see <code>os</code> module
<h2>Module <a id="string" href="#string">string</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L116"><i>src</i></a>)</h2>
the builtin lua string module.
<p>
string literal values can use <ul>
<li><code>'single quotes'</code></li>
<li><code>"double quotes"</code></li>
<li><code>[==[raw string with any number of = symbols ]==]</code></li>
</ul>
<p>
<code>\</code> characters can be used to escape special characters,
except in raw bracketed strings. Common escaped characters
are <code>\'</code> (literal <code>'</code>), <code>\n</code> (newline) and <code>\t</code> (tab).
<p>
<h3>Function <a id="string.byte" href="#string.byte">string.byte</a><code>(str, si=1, ei=si) -&gt; ...ints</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L227"><i>src</i></a>)</h3>
Get ASCII (integer) codes for <code>s[si:ei]</code>
<p>
Example: <code>assertEq({98, 99}, {string.byte('abcd', 2, 3)})</code>
<h3>Function <a id="string.char" href="#string.char">string.char</a><code>(c1, c2, ...) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L230"><i>src</i></a>)</h3>
<h3>Function <a id="string.concat" href="#string.concat">string.concat</a><code>(sep, ...) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L121"><i>src</i></a>)</h3>
concatenate all items in ... with sep.
<p>
Note: this is an addon to from metaty.
<h3>Function <a id="string.find" href="#string.find">string.find</a><code>(subj, pat, index=1) -&gt; (si, ei, ...matches)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L157"><i>src</i></a>)</h3>
Find the pattern in the subj (subject) string, starting at the index.
returns the si (start index), ei (end index) and match groups
<p>
<code class="block">assertEq({2, 4},       {find('%w+', ' bob is nice')})
assertEq({2, 7, 'is'}, {find(' bob is nice', '%w+ (%w+)')})</code>
<p>
Character classes for matching specific sets: <code class="block">  .   all characters
  %a  letters
  %c  control characters
  %d  digits
  %l  lower case letters
  %p  punctuation characters
  %s  space characters
  %u  upper case letters
  %w  alphanumeric characters
  %x  hexadecimal digits
  %z  the character with representation 0</code>
<p>
Magic characters, <code>.</code> indicates one character, more indicates many <code class="block">    %.     selects a character class or escapes a magic char
    (...)  create a group
    [...]  create your own character class
    [^..]  inversion of [...]
    +.     match one or more of previous class  (NOT group)
    *.     match zero or more of previous class (NOT group)
    ?      match zero or one of previous class  (NOT group)
    ^...   if at pat[1], match only beggining of text
    ...$   if at pat[#pat], match only end of text
    %1-9   matches the previously matched group index EXACTLY</code>
<h3>Function <a id="string.format" href="#string.format">string.format</a><code>(fmt: str, ...) -&gt; str</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L222"><i>src</i></a>)</h3>
Format values into a fmt string, i.e: <code>format('%s: %i', 'age', 42)</code>
<p>
Directives: <table>
<tr>
<td><code>%%</code></td>
<td>literal % char</td>
</tr>
<tr>
<td><code>%d</code></td>
<td>decimal</td>
</tr>
<tr>
<td><code>%o</code></td>
<td>octal</td>
</tr>
<tr>
<td><code>%x</code></td>
<td>hexidecimal (%X uppercase)</td>
</tr>
<tr>
<td><code>%f</code></td>
<td>floating point</td>
</tr>
<tr>
<td><code>%s</code></td>
<td>string</td>
</tr>
</table>
<p>
Directive control structure (ignore spaces): <code class="block">  % (specifier width)? directive</code>
<p>
Where <code>width</code> is an integer and <code>specifier</code> can be one of <table>
<tr>
<td><code>+</code></td>
<td>right justify to width (the default)</td>
</tr>
<tr>
<td><code>-</code></td>
<td>left justify to width</td>
</tr>
<tr>
<td><code> </code></td>
<td>prefix a positive number with a space</td>
</tr>
<tr>
<td><code>#</code></td>
<td>prefix o, x or X directives with 0, 0x and 0X respectively</td>
</tr>
<tr>
<td><code>0</code></td>
<td>left-pad a number with zeros</td>
</tr>
</table>
<p>
Examples: <code class="block">  sfmt = string.format
  assertEq('age: 42',    sfmt('%s: %i',   'age', 42))
  assertEq('age:    42', sfmt('%s: %5i',  'age', 42))
  assertEq('age: 42,     sfmt('%s: %-5i', 'age', 42))
  assertEq('age: 00042', sfmt('%s: %05i', 'age', 42)</code>
<h3>Function <a id="string.gmatch" href="#string.gmatch">string.gmatch</a><code>(subj, pat, index=1) -&gt; iterator()</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L170"><i>src</i></a>)</h3>
Return an iterator function that when called returns the next capture group.
index: where to start the search and can be negative.
<p>
See also: string.find.
<h3>Function <a id="string.gsub" href="#string.gsub">string.gsub</a><code>(subj, pat, repl, index=1) -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L190"><i>src</i></a>)</h3>
Substittue all matches of pattern with repl, returning the new string.
<p>
<code>repl</code> can be a: <ul>
<li>string: replace with the string except <code>%1-9</code> will be
a matched group from <code>pat</code> and <code>%%</code> is a literal <code>%</code>.</li>
<li>table: the table will be queried for every match using
the first capture as key.</li>
<li><code>function(...matches) -&gt; string</code>: the function will be called
with all match groups for each match.</li>
</ul>
<p>
See also: string.find for pattern documentation.
<h3>Function <a id="string.match" href="#string.match">string.match</a><code>(subj, pat, index=1) -&gt; ...groups</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L163"><i>src</i></a>)</h3>
Return the capture groups of pat or the whole match if no capture groups.
index: where to start the search and can be negative.
<p>
See also: string.find.
<h3>Function <a id="string.pack" href="#string.pack">string.pack</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L256"><i>src</i></a>)</h3>
pack the values as bytes into the string using the strtys.
<p>
strtys is a string of the form: <table>
<tr>
<td><code> &lt;  &gt;  =</code></td>
<td>(start only) little / big / native endian</td>
</tr>
<tr>
<td><code> !#     </code></td>
<td>(start only) max alignment = <code>#</code> bytes</td>
</tr>
<tr>
<td><code> b B    </code></td>
<td>signed / unsigned byte</td>
</tr>
<tr>
<td><code> h H l L</code></td>
<td>native short(h) and long(l) + unsigned vers</td>
</tr>
<tr>
<td><code> i# I#  </code></td>
<td>signed/unsigned int with <code>#</code> bytes</td>
</tr>
<tr>
<td><code> f d    </code></td>
<td>native float / double</td>
</tr>
<tr>
<td><code> T      </code></td>
<td>size_t</td>
</tr>
<tr>
<td><code> c#     </code></td>
<td>fixed-sized string of <code>#</code> bytes (unaligned)</td>
</tr>
<tr>
<td><code> z      </code></td>
<td>zero-terminated string        (unaligned)</td>
</tr>
<tr>
<td><code> s#     </code></td>
<td>counted string of size <code>#</code> bytes</td>
</tr>
<tr>
<td><code> x      </code></td>
<td>one byte of padding</td>
</tr>
<tr>
<td><code> Xo     </code></td>
<td>align to option <code>o</code>, i.e. <code>Xi4</code></td>
</tr>
<tr>
<td><code> j J n  </code></td>
<td>lua Integer / Unsigned / Number</td>
</tr>
</table>
<p>
Example: <code class="block">assertEq(string.pack('&gt;i2i2', 0x1234, 0x5678) == '\x12\x34\x56\x78')]</code>
<h3>Function <a id="string.packsize" href="#string.packsize">string.packsize</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L262"><i>src</i></a>)</h3>
Get the size which is used by strtys.
<h3>Function <a id="string.rep" href="#string.rep">string.rep</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L233"><i>src</i></a>)</h3>
<h3>Function <a id="string.sub" href="#string.sub">string.sub</a><code>(subj, si, ei) -&gt; str[si:ei]</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L176"><i>src</i></a>)</h3>
Return substring by index. <code>("1234"):sub(3,4) == "34"</code>
<p>
<blockquote>Note: This is confusingly named considering string.gsub uses pattern
matching. Such is life.</blockquote>
<h3>Function <a id="string.unpack" href="#string.unpack">string.unpack</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L259"><i>src</i></a>)</h3>
See string.pack for the fmt
<h2>Module <a id="table" href="#table">table</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L289"><i>src</i></a>)</h2>
the builtin lua table module
<p>
Tables act as BOTH a map (of keys -> values) and a list (ordered values
starting at index=1).
<p>
You can access the keys with <code>t[key]</code> or if they are a string without
special characters with <code>t.key</code>.
<p>
Examples: <code class="block">t = {'first', 'second', 'third', key='hi'}
assertEq('first', t[1])
assertEq('third', t[3])
assertEq('hi',    t.key)
assertEq(#t, 3) -- the length of the "list" part</code>
<p>
<blockquote> WARNING: A table's length is defined as ANY index who's next value
is <code>nil`</code>. That means using a table as a list with "holes" likely
won't work for you.
</blockquote>
<p>
<h3>Function <a id="table.concat" href="#table.concat">table.concat</a><code>(t, sep='') -&gt; string</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L303"><i>src</i></a>)</h3>
concatenate a table of strings with optional separator.
<p>
Examples: <code class="block">concat = table.concat
assertEq(1..' = '..3, concat{1, ' = ', 3})
assertEq('1, 2, 3',   concat({1, 2, 3}, ', ')</code>
<h3>Function <a id="table.insert" href="#table.insert">table.insert</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L328"><i>src</i></a>)</h3>
insert or push to table (list-like)
<p>
Example: <code class="block">local push = table.insert
  local t = {}

  -- push/append behavior
  push(t, 'd')            -- {'d'
  push(t, 'e')            -- {'d', 'e'}

  -- insert behavior
  table.insert(t, 'b', 1) -- {'b', 'd', 'e'}
  table.insert(t, 'c', 2) -- {'b', 'c', 'd', 'e'}
  assertEq({'b', 'c', 'd', 'e'}, t)</code>
<h3>Function <a id="table.move" href="#table.move">table.move</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L340"><i>src</i></a>)</h3>
Move values from one list to another.
Note that <code>si=startIndex</code> and <code>ei=endIndex</code> (inclusive).
<p>
Equivalent to the following, though done in a way
that will properly handle overlapping data: <code class="block">  ti = siTo
  for fi=siFrom,eiFrom do
    to[ti] = from[fi]; ti = ti + 1
  end</code>
<h3>Function <a id="table.remove" href="#table.remove">table.remove</a><code>(t, index=#table) -&gt; t[index]</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L307"><i>src</i></a>)</h3>
remove an item from a table, returning it.
The table is shifted if index < #table which may cost up to O(n)
<h3>Function <a id="table.sort" href="#table.sort">table.sort</a><code>(list, cmp=lt) -&gt; nil</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L311"><i>src</i></a>)</h3>
sort a table in place using a comparison function <code>cmp</code> who's behavior
must be: <code>cmp(a, b) --&gt; makeAFirst</code>
<h3>Function <a id="table.update" href="#table.update">table.update</a><code>(to, from) -&gt; to</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/doc/lua.lua#L294"><i>src</i></a>)</h3>
update to with from, return to.
<p>
Note: this is an addon from metaty.
<p>
<h1><a id="Package_ff" href="#Package_ff">Package ff</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>find+fix files</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_ff">https://lua.civboot.org#Package_ff</a></td>
</tr>
</table><h2>Command when executed directly</h2>
find-fix utility
<p>
Example, note that args are parsed special: 
  ff r:some/dir/ some[pat] -not[pat] p:some%.path -p:not%.path]

<p>
<b>Named Args: </b> <table>
<tr>
<td><code>ff.Main.root</code></td>
<td>[list] 
<code>r:path1 r:path2</code>: list of root paths</td>
</tr>
<tr>
<td><code>ff.Main.pat</code></td>
<td>[list] 
<code>any.+pat1 pat2</code>: list of patterns to find</td>
</tr>
<tr>
<td><code>ff.Main.nopat</code></td>
<td>[list] 
<code>-notpat</code>: list of (file-wide) pattern exclusions</td>
</tr>
<tr>
<td><code>ff.Main.path</code></td>
<td>[list] 
<code>p:%.lua</code> list of file path patterns</td>
</tr>
<tr>
<td><code>ff.Main.nopath</code></td>
<td>[list] 
<code>-p:%.bin</code> list of file path patterns to exclude</td>
</tr>
<tr>
<td><code>ff.Main.sub</code></td>
<td>[string] 
the subsitution string to use with pat</td>
</tr>
<tr>
<td><code>ff.Main.mut</code></td>
<td>[bool] 
mutate files (used with sub)</td>
</tr>
<tr>
<td><code>ff.Main.dirs</code></td>
<td>[bool] 
show all non-excluded directories</td>
</tr>
</table>
<p>
<h2>Module <a id="ff" href="#ff">ff</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L4"><i>src</i></a>)</h2>
re-imagining of ff using new tech and better args
<p>
<h4>Value <a id="ff.__name" href="#ff.__name">ff.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ff.Main</code></td>
<td>[Ty<Main>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L38">src</a>)</td>
</tr>
</table>
<h3>Function <a id="ff.find" href="#ff.find">ff.find</a><code>(path, pats, sub) -&gt; boolean</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L61"><i>src</i></a>)</h3>
find patterns in path.
If there is a match then the path is logged to <code>io.stdout</code> and the matches
to <code>io.fmt</code>.
<h3>Function <a id="ff.fmtMatch" href="#ff.fmtMatch">ff.fmtMatch</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L172"><i>src</i></a>)</h3>
<h3>Function <a id="ff.fmtSub" href="#ff.fmtSub">ff.fmtSub</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L184"><i>src</i></a>)</h3>
<h3>Function <a id="ff.iter" href="#ff.iter">ff.iter</a><code>(args) -&gt; Iter</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L133"><i>src</i></a>)</h3>
Get an iterator of matching paths.
<p>
<blockquote>WARNING: this also writes to io.fmt and io.stdout</blockquote>
<h3>Function <a id="ff.main" href="#ff.main">ff.main</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L187"><i>src</i></a>)</h3>
<h3>Function <a id="ff.parseColons" href="#ff.parseColons">ff.parseColons</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L160"><i>src</i></a>)</h3>
parse <code>c:commands</code> into t
<h3>Function <a id="ff.replace" href="#ff.replace">ff.replace</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ff/ff.lua#L70"><i>src</i></a>)</h3>
perform replacement of <code>pats</code> with <code>sub</code>, writing to <code>to</code>
<p>
<h1><a id="Package_pkgrock" href="#Package_pkgrock">Package pkgrock</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>pkg utilities to work with rockspecs</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-1</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_pkgrock">https://lua.civboot.org#Package_pkgrock</a></td>
</tr>
</table>
<p>
<h2>Module <a id="pkgrock" href="#pkgrock">pkgrock</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock/pkgrock.lua#L1"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="pkgrock.__name" href="#pkgrock.__name">pkgrock.__name</a></h4>
<h3>Record <a id="pkgrock.Args" href="#pkgrock.Args">pkgrock.Args</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock/pkgrock.lua#L19"><i>src</i></a>)</h3>
utility for publishing PKG.lua directories. Usage: <code class="block">  pkgrock dir1 dir2 ...args]</code>
<p>
Example (sh): <code class="block">  , rock lib/pkg --create --gitops='add commit tag' \
    --gitpush='origin main --tags' --upload=$ROCKAPI</code>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>pkgrock.Args.create</code></td>
<td>[bool] 
creates the rocks from PKG.lua files</td>
</tr>
<tr>
<td><code>pkgrock.Args.gitops</code></td>
<td>[string] 
one or more: add,commit,tag</td>
</tr>
<tr>
<td><code>pkgrock.Args.gitpush</code></td>
<td>[string] 
where to push, i.e: 'origin main'</td>
</tr>
<tr>
<td><code>pkgrock.Args.upload</code></td>
<td>[string] 
set to the luarocks api key</td>
</tr>
</table>
<b>Values: </b> <table>
<tr>
<td><code>pkgrock.Args.__name</code></td>
<td>[string] </td>
</tr>
</table>
<h3>Table <a id="pkgrock.Args.__docs" href="#pkgrock.Args.__docs">pkgrock.Args.__docs</a></h3>
<h3>Table <a id="pkgrock.Args.__fieldIds" href="#pkgrock.Args.__fieldIds">pkgrock.Args.__fieldIds</a></h3>
<h3>Table <a id="pkgrock.Args.__fields" href="#pkgrock.Args.__fields">pkgrock.Args.__fields</a></h3>
<b>Records: </b> <table>
<tr>
<td><code>pkgrock.Args.__index</code></td>
<td>[Ty<pkgrock>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock/pkgrock.lua#L19">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>pkgrock.Args.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h3>Function <a id="pkgrock.loadrock" href="#pkgrock.loadrock">pkgrock.loadrock</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock/pkgrock.lua#L75"><i>src</i></a>)</h3>
<h3>Function <a id="pkgrock.main" href="#pkgrock.main">pkgrock.main</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock/pkgrock.lua#L132"><i>src</i></a>)</h3>
<h3>Function <a id="pkgrock.makerock" href="#pkgrock.makerock">pkgrock.makerock</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock/pkgrock.lua#L69"><i>src</i></a>)</h3>
<h3>Function <a id="pkgrock.rockpath" href="#pkgrock.rockpath">pkgrock.rockpath</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/pkgrock/pkgrock.lua#L32"><i>src</i></a>)</h3>
<p>
<h1><a id="Package_ele" href="#Package_ele">Package ele</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele"><i>src</i></a>)</h1><table>
<tr>
<td><b>version</b></td>
<td><code>0.1-0</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_ele">https://lua.civboot.org#Package_ele</a></td>
</tr>
</table>
Ele: Extendable Lua Editor
<p>
Ele is an (**In Development**) extendable lua editor. This is the second
rewrite, with the original code being in <a href="https://github.com/civboot/civlua/blob/main/experiment/ele">experiment/ele</a>.
<p>
Ele's primary goals are: <ul>
<li>Implemented in a minimal amount of understandable code. It is the main editor
for <a href="http://civboot.org">Civboot</a></li>
<li>Enjoyable and extendable for developers to fit their workflow</li>
<li>undo/redo, syntax highlighting, plugins, user-configurable bindings
(supports vim/emacs style), etc.</li>
<li>Implements a lua shell (zsh competitor)</li>
<li>Can handle any size text file</li>
</ul>
<p>
Non-goals of Ele are: <ul>
<li>focusing on performance against the other goals</li>
</ul>
<p>
See <a href="https://github.com/civboot/civlua/blob/main/ARCH.md">ARCH.md</a> for the current architecture.
<p>
<h2>Module <a id="ele" href="#ele">ele</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele.lua#L2"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.__name" href="#ele.__name">ele.__name</a></h4>
<h3>Function <a id="ele.main" href="#ele.main">ele.main</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele.lua#L51"><i>src</i></a>)</h3>
<h3>Record <a id="ele.Ed" href="#ele.Ed">ele.Ed</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ele.Ed.mode</code></td>
<td>[string] 
current editor mode</td>
</tr>
<tr>
<td><code>ele.Ed.modes</code></td>
<td>[table] 
keyboard bindings per mode (see: bindings.lua)</td>
</tr>
<tr>
<td><code>ele.Ed.actions</code></td>
<td>[table] 
actions which events can trigger (see: actions.lua)</td>
</tr>
<tr>
<td><code>ele.Ed.resources</code></td>
<td>[table] 
resources to close when shutting down</td>
</tr>
<tr>
<td><code>ele.Ed.buffers</code></td>
<td>[List] 
list of Buffer objects</td>
</tr>
<tr>
<td><code>ele.Ed.edit</code></td>
<td>[Buffer] 
the current edit buffer</td>
</tr>
<tr>
<td><code>ele.Ed.view</code></td>
<td>[RootView] 
the root view</td>
</tr>
<tr>
<td><code>ele.Ed.display</code></td>
<td>[Term</td>
<td>other] 
display/terminal to write+paint text</td>
</tr>
<tr>
<td><code>ele.Ed.run</code></td>
<td>[boolean] = <code>true</code>
set to false to stop the app</td>
</tr>
<tr>
<td><code>ele.Ed.ext</code></td>
<td>[table] 
table for extensions to store data</td>
</tr>
<tr>
<td><code>ele.Ed.error</code></td>
<td>[callable] 
error handler (ds.log.logfmt sig)</td>
</tr>
<tr>
<td><code>ele.Ed.warn</code></td>
<td>[callable] 
warn handler</td>
</tr>
<tr>
<td><code>ele.Ed.newDat</code></td>
<td>[callable(text)] = <code>fn"function"[/home/rett/projects/civlua/cmd/ele/ele/Ed.lua:29]</code>
function to create new buffer</td>
</tr>
<tr>
<td><code>ele.Ed.redraw</code></td>
<td>[boolean] 
set to true to force a redraw</td>
</tr>
</table>
<h3>Table <a id="ele.Ed.__docs" href="#ele.Ed.__docs">ele.Ed.__docs</a></h3>
<h3>Table <a id="ele.Ed.__fieldIds" href="#ele.Ed.__fieldIds">ele.Ed.__fieldIds</a></h3>
<h3>Table <a id="ele.Ed.__fields" href="#ele.Ed.__fields">ele.Ed.__fields</a></h3>
<h4>Value <a id="ele.Ed.__name" href="#ele.Ed.__name">ele.Ed.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ele.Ed.__index</code></td>
<td>[Ty<Ed>] </td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ele.Ed.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Ed.buffer" href="#Ed.buffer">Ed.buffer</a><code>(ed, v) -&gt; Buffer</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Ed.lua#L63"><i>src</i></a>)</h4>
<h4>Function <a id="Ed.draw" href="#Ed.draw">Ed.draw</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Ed.lua#L90"><i>src</i></a>)</h4>
<h4>Function <a id="Ed.focus" href="#Ed.focus">Ed.focus</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Ed.lua#L77"><i>src</i></a>)</h4>
<h4>Function <a id="Ed.init" href="#Ed.init">Ed.init</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Ed.lua#L45"><i>src</i></a>)</h4>
<h4>Function <a id="Ed.open" href="#Ed.open">Ed.open</a><code>(ed, path) -&gt; edit</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Ed.lua#L82"><i>src</i></a>)</h4>
<h3>Record <a id="ele.Session" href="#ele.Session">ele.Session</a></h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ele.Session.ed</code></td>
<td>[Ed] </td>
</tr>
<tr>
<td><code>ele.Session.events</code></td>
<td>[Recv] </td>
</tr>
<tr>
<td><code>ele.Session.evsend</code></td>
<td>[Send] </td>
</tr>
<tr>
<td><code>ele.Session.keys</code></td>
<td>[Recv] </td>
</tr>
<tr>
<td><code>ele.Session.keysend</code></td>
<td>[Send] </td>
</tr>
<tr>
<td><code>ele.Session.logf</code></td>
<td>[File] </td>
</tr>
</table>
<h3>Table <a id="ele.Session.__docs" href="#ele.Session.__docs">ele.Session.__docs</a></h3>
<h3>Table <a id="ele.Session.__fieldIds" href="#ele.Session.__fieldIds">ele.Session.__fieldIds</a></h3>
<h3>Table <a id="ele.Session.__fields" href="#ele.Session.__fields">ele.Session.__fields</a></h3>
<h4>Value <a id="ele.Session.__name" href="#ele.Session.__name">ele.Session.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ele.Session.__index</code></td>
<td>[Ty<Session>] </td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ele.Session.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Session.draw" href="#Session.draw">Session.draw</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Session.lua#L115"><i>src</i></a>)</h4>
<h4>Function <a id="Session.handleEvents" href="#Session.handleEvents">Session.handleEvents</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Session.lua#L102"><i>src</i></a>)</h4>
<h4>Function <a id="Session.init" href="#Session.init">Session.init</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Session.lua#L34"><i>src</i></a>)</h4>
<h4>Function <a id="Session.play" href="#Session.play">Session.play</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Session.lua#L83"><i>src</i></a>)</h4>
<h4>Function <a id="Session.run" href="#Session.run">Session.run</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Session.lua#L72"><i>src</i></a>)</h4>
<h4>Function <a id="Session.test" href="#Session.test">Session.test</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Session.lua#L41"><i>src</i></a>)</h4>
<h4>Function <a id="Session.user" href="#Session.user">Session.user</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/Session.lua#L48"><i>src</i></a>)</h4>
<h2>Module <a id="ele.actions" href="#ele.actions">ele.actions</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L2"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.actions.__name" href="#ele.actions.__name">ele.actions.__name</a></h4>
<b>Functions: </b> <table>
<tr>
<td><code>ele.actions.keyinput</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L69">src</a>)</td>
</tr>
</table>
<h3>Function <a id="ele.actions.chain" href="#ele.actions.chain">ele.actions.chain</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L86"><i>src</i></a>)</h3>
<h3>Function <a id="ele.actions.keyinput" href="#ele.actions.keyinput">ele.actions.keyinput</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L69"><i>src</i></a>)</h3>
<h3>Function <a id="ele.actions.insert" href="#ele.actions.insert">ele.actions.insert</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L157"><i>src</i></a>)</h3>
<h3>Function <a id="ele.actions.merge" href="#ele.actions.merge">ele.actions.merge</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L79"><i>src</i></a>)</h3>
<h3>Function <a id="ele.actions.move" href="#ele.actions.move">ele.actions.move</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L146"><i>src</i></a>)</h3>
<h3>Function <a id="ele.actions.nav" href="#ele.actions.nav">ele.actions.nav</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L192"><i>src</i></a>)</h3>
<h3>Function <a id="ele.actions.remove" href="#ele.actions.remove">ele.actions.remove</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/actions.lua#L183"><i>src</i></a>)</h3>
<h2>Module <a id="ele.keys" href="#ele.keys">ele.keys</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L5"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.bindings.__name" href="#ele.bindings.__name">ele.bindings.__name</a></h4>
<h3>Table <a id="ele.keys.backspace" href="#ele.keys.backspace">ele.keys.backspace</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L158"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.close" href="#ele.keys.close">ele.keys.close</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L110"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.command" href="#ele.keys.command">ele.keys.command</a></h3>
<h3>Table <a id="ele.keys.commandmode" href="#ele.keys.commandmode">ele.keys.commandmode</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L115"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.delkey" href="#ele.keys.delkey">ele.keys.delkey</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L159"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.exit" href="#ele.keys.exit">ele.keys.exit</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L98"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.goline" href="#ele.keys.goline">ele.keys.goline</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L220"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.insert" href="#ele.keys.insert">ele.keys.insert</a></h3>
<h3>Table <a id="ele.keys.inserteol" href="#ele.keys.inserteol">ele.keys.inserteol</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L114"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.insertmode" href="#ele.keys.insertmode">ele.keys.insertmode</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L112"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.insertsot" href="#ele.keys.insertsot">ele.keys.insertsot</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L113"><i>src</i></a>)</h3>
<h3>Table <a id="ele.keys.listCWD" href="#ele.keys.listCWD">ele.keys.listCWD</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L221"><i>src</i></a>)</h3>
<h3>Record <a id="ele.keys.Chain" href="#ele.keys.Chain">ele.keys.Chain</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L76"><i>src</i></a>)</h3>
<p>
<h3>Table <a id="ele.bindings.Chain.__docs" href="#ele.bindings.Chain.__docs">ele.bindings.Chain.__docs</a></h3>
<h3>Table <a id="ele.bindings.Chain.__fieldIds" href="#ele.bindings.Chain.__fieldIds">ele.bindings.Chain.__fieldIds</a></h3>
<h3>Table <a id="ele.bindings.Chain.__fields" href="#ele.bindings.Chain.__fields">ele.bindings.Chain.__fields</a></h3>
<h4>Value <a id="ele.bindings.Chain.__name" href="#ele.bindings.Chain.__name">ele.bindings.Chain.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ele.bindings.Chain.__index</code></td>
<td>[Ty<Chain>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L76">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ele.bindings.Chain.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Chain.__call" href="#Chain.__call">Chain.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L81"><i>src</i></a>)</h4>
<h3>Record <a id="ele.keys.Event" href="#ele.keys.Event">ele.keys.Event</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L66"><i>src</i></a>)</h3>
<p>
<h3>Table <a id="ele.bindings.Event.__docs" href="#ele.bindings.Event.__docs">ele.bindings.Event.__docs</a></h3>
<h3>Table <a id="ele.bindings.Event.__fieldIds" href="#ele.bindings.Event.__fieldIds">ele.bindings.Event.__fieldIds</a></h3>
<h3>Table <a id="ele.bindings.Event.__fields" href="#ele.bindings.Event.__fields">ele.bindings.Event.__fields</a></h3>
<h4>Value <a id="ele.bindings.Event.__name" href="#ele.bindings.Event.__name">ele.bindings.Event.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ele.bindings.Event.__index</code></td>
<td>[Ty<Event>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L66">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Event.__call" href="#Event.__call">Event.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L73"><i>src</i></a>)</h4>
<h3>Record <a id="ele.keys.Hotkey" href="#ele.keys.Hotkey">ele.keys.Hotkey</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L85"><i>src</i></a>)</h3>
<p>
<h3>Table <a id="ele.bindings.Hotkey.__docs" href="#ele.bindings.Hotkey.__docs">ele.bindings.Hotkey.__docs</a></h3>
<h3>Table <a id="ele.bindings.Hotkey.__fieldIds" href="#ele.bindings.Hotkey.__fieldIds">ele.bindings.Hotkey.__fieldIds</a></h3>
<h3>Table <a id="ele.bindings.Hotkey.__fields" href="#ele.bindings.Hotkey.__fields">ele.bindings.Hotkey.__fields</a></h3>
<h4>Value <a id="ele.bindings.Hotkey.__name" href="#ele.bindings.Hotkey.__name">ele.bindings.Hotkey.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ele.bindings.Hotkey.__index</code></td>
<td>[Ty<Hotkey>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L85">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ele.bindings.Hotkey.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Hotkey.__call" href="#Hotkey.__call">Hotkey.__call</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L93"><i>src</i></a>)</h4>
<h3>Record <a id="ele.keys.Keys" href="#ele.keys.Keys">ele.keys.Keys</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L26"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ele.bindings.Keys.chord</code></td>
<td>[table] 
list of keys which led to this binding, i.e. {'space', 'a'}</td>
</tr>
<tr>
<td><code>ele.bindings.Keys.event</code></td>
<td>[table] 
table to use when returning (emitting) an event.</td>
</tr>
<tr>
<td><code>ele.bindings.Keys.next</code></td>
<td>[table</td>
<td>string] 
the binding which will be used for the next key</td>
</tr>
<tr>
<td><code>ele.bindings.Keys.keep</code></td>
<td>[boolean] 
if true the above fields will be preserved in next call</td>
</tr>
</table>
<h3>Table <a id="ele.bindings.Keys.__docs" href="#ele.bindings.Keys.__docs">ele.bindings.Keys.__docs</a></h3>
<h3>Table <a id="ele.bindings.Keys.__fieldIds" href="#ele.bindings.Keys.__fieldIds">ele.bindings.Keys.__fieldIds</a></h3>
<h3>Table <a id="ele.bindings.Keys.__fields" href="#ele.bindings.Keys.__fields">ele.bindings.Keys.__fields</a></h3>
<h4>Value <a id="ele.bindings.Keys.__name" href="#ele.bindings.Keys.__name">ele.bindings.Keys.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ele.bindings.Keys.__index</code></td>
<td>[Ty<Keys>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L26">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ele.bindings.Keys.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Keys.check" href="#Keys.check">Keys.check</a><code>(k, ele) -&gt; errstring?</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L33"><i>src</i></a>)</h4>
<h3>Function <a id="ele.keys.backword" href="#ele.keys.backword">ele.keys.backword</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L119"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.bind" href="#ele.keys.bind">ele.keys.bind</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L209"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.bindall" href="#ele.keys.bindall">ele.keys.bindall</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L212"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.change" href="#ele.keys.change">ele.keys.change</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L174"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.chord" href="#ele.keys.chord">ele.keys.chord</a><code>(str) -&gt; keylist</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L45"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.chordstr" href="#ele.keys.chordstr">ele.keys.chordstr</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L55"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.delete" href="#ele.keys.delete">ele.keys.delete</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L169"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.down" href="#ele.keys.down">ele.keys.down</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L121"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.eol" href="#ele.keys.eol">ele.keys.eol</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L124"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.eot" href="#ele.keys.eot">ele.keys.eot</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L124"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.find" href="#ele.keys.find">ele.keys.find</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L140"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.findback" href="#ele.keys.findback">ele.keys.findback</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L151"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.forword" href="#ele.keys.forword">ele.keys.forword</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L119"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.insertChord" href="#ele.keys.insertChord">ele.keys.insertChord</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L104"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.install" href="#ele.keys.install">ele.keys.install</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L274"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.keyactions" href="#ele.keys.keyactions">ele.keys.keyactions</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L298"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.left" href="#ele.keys.left">ele.keys.left</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L118"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.literal" href="#ele.keys.literal">ele.keys.literal</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L50"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.moveAction" href="#ele.keys.moveAction">ele.keys.moveAction</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L63"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.movekey" href="#ele.keys.movekey">ele.keys.movekey</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L131"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.right" href="#ele.keys.right">ele.keys.right</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L118"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.sol" href="#ele.keys.sol">ele.keys.sol</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L123"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.sot" href="#ele.keys.sot">ele.keys.sot</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L123"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.till" href="#ele.keys.till">ele.keys.till</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L145"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.tillback" href="#ele.keys.tillback">ele.keys.tillback</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L156"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.times" href="#ele.keys.times">ele.keys.times</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L182"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.unboundChord" href="#ele.keys.unboundChord">ele.keys.unboundChord</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L107"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.up" href="#ele.keys.up">ele.keys.up</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L120"><i>src</i></a>)</h3>
<h3>Function <a id="ele.keys.zero" href="#ele.keys.zero">ele.keys.zero</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/bindings.lua#L188"><i>src</i></a>)</h3>
<h2>Module <a id="ele.edit" href="#ele.edit">ele.edit</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L1"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.edit.__name" href="#ele.edit.__name">ele.edit.__name</a></h4>
<h3>Record <a id="ele.edit.Edit" href="#ele.edit.Edit">ele.edit.Edit</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L30"><i>src</i></a>)</h3>
<p>
<b>Fields: </b> <table>
<tr>
<td><code>ele.edit.Edit.id</code></td>
<td>[int] </td>
</tr>
<tr>
<td><code>ele.edit.Edit.container</code></td>
<td>  </td>
</tr>
<tr>
<td><code>ele.edit.Edit.canvas</code></td>
<td>  </td>
</tr>
<tr>
<td><code>ele.edit.Edit.buf</code></td>
<td>[Buffer] </td>
</tr>
<tr>
<td><code>ele.edit.Edit.l</code></td>
<td>[int] = <code>1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.c</code></td>
<td>[int] = <code>1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.vl</code></td>
<td>[int] = <code>1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.vc</code></td>
<td>[int] = <code>1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.tl</code></td>
<td>[int] = <code>-1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.tc</code></td>
<td>[int] = <code>-1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.th</code></td>
<td>[int] = <code>-1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.tw</code></td>
<td>[int] = <code>-1</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.fh</code></td>
<td>[int] = <code>0</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.fw</code></td>
<td>[int] = <code>0</code></td>
</tr>
<tr>
<td><code>ele.edit.Edit.closed</code></td>
<td>[bool] </td>
</tr>
<tr>
<td><code>ele.edit.Edit.modes</code></td>
<td>[table] </td>
</tr>
</table>
<h3>Table <a id="ele.edit.Edit.__docs" href="#ele.edit.Edit.__docs">ele.edit.Edit.__docs</a></h3>
<h3>Table <a id="ele.edit.Edit.__fieldIds" href="#ele.edit.Edit.__fieldIds">ele.edit.Edit.__fieldIds</a></h3>
<h3>Table <a id="ele.edit.Edit.__fields" href="#ele.edit.Edit.__fields">ele.edit.Edit.__fields</a></h3>
<h4>Value <a id="ele.edit.Edit.__name" href="#ele.edit.Edit.__name">ele.edit.Edit.__name</a></h4>
<b>Records: </b> <table>
<tr>
<td><code>ele.edit.Edit.__index</code></td>
<td>[Ty<Edit>] (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L30">src</a>)</td>
</tr>
</table>
<b>Methods: </b> <table>
<tr>
<td><code>ele.edit.Edit.__newindex</code></td>
<td>[function] (<a href="https://github.com/civboot/civlua/blob/main/lib/metaty/metaty.lua#L189">src</a>)</td>
</tr>
</table>
<h4>Function <a id="Edit.__len" href="#Edit.__len">Edit.__len</a><code>(e) -&gt; #e.buf</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L47"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.__tostring" href="#Edit.__tostring">Edit.__tostring</a><code>(e) -&gt; string.format('Edit[id=%s]', e.id)</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L48"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.append" href="#Edit.append">Edit.append</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L100"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.boundCol" href="#Edit.boundCol">Edit.boundCol</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L72"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.boundLC" href="#Edit.boundLC">Edit.boundLC</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L67"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.changeStart" href="#Edit.changeStart">Edit.changeStart</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L89"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.changeUpdate2" href="#Edit.changeUpdate2">Edit.changeUpdate2</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L94"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.close" href="#Edit.close">Edit.close</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L46"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.colEnd" href="#Edit.colEnd">Edit.colEnd</a><code>(e) -&gt; #e:curLine() + 1</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L54"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.copy" href="#Edit.copy">Edit.copy</a><code>(e) -&gt; ds.copy(e, {id=T.nextViewId()})</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L49"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.curLine" href="#Edit.curLine">Edit.curLine</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L53"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.draw" href="#Edit.draw">Edit.draw</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L158"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.drawCursor" href="#Edit.drawCursor">Edit.drawCursor</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L165"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.forceHeight" href="#Edit.forceHeight">Edit.forceHeight</a><code>(e) -&gt; e.fh</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L50"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.forceWidth" href="#Edit.forceWidth">Edit.forceWidth</a><code>(e) -&gt; e.fw</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L51"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.insert" href="#Edit.insert">Edit.insert</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L112"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.lastLine" href="#Edit.lastLine">Edit.lastLine</a><code>(e) -&gt; e.buf[#e]</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L55"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.offset" href="#Edit.offset">Edit.offset</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L58"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.redo" href="#Edit.redo">Edit.redo</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L148"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.remove" href="#Edit.remove">Edit.remove</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L117"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.removeOff" href="#Edit.removeOff">Edit.removeOff</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L125"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.replace" href="#Edit.replace">Edit.replace</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L135"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.undo" href="#Edit.undo">Edit.undo</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L143"><i>src</i></a>)</h4>
<h4>Function <a id="Edit.viewCursor" href="#Edit.viewCursor">Edit.viewCursor</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/edit.lua#L85"><i>src</i></a>)</h4>
<h2>Module <a id="ele.nav" href="#ele.nav">ele.nav</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/nav.lua#L2"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.nav.__name" href="#ele.nav.__name">ele.nav.__name</a></h4>
<h3>Function <a id="ele.nav.install" href="#ele.nav.install">ele.nav.install</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/nav.lua#L46"><i>src</i></a>)</h3>
<h3>Function <a id="ele.nav.navEdit" href="#ele.nav.navEdit">ele.nav.navEdit</a><code>(ed) -&gt; new temporary nav buffer</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/nav.lua#L29"><i>src</i></a>)</h3>
<p>
<h2>Module <a id="ele.nav.modes" href="#ele.nav.modes">ele.nav.modes</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/nav.lua#L17"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.nav.modes.__name" href="#ele.nav.modes.__name">ele.nav.modes.__name</a></h4>
<h3>Table <a id="ele.nav.modes.command" href="#ele.nav.modes.command">ele.nav.modes.command</a></h3>
<h3>Table <a id="ele.nav.modes.insert" href="#ele.nav.modes.insert">ele.nav.modes.insert</a></h3>
<h2>Module <a id="ele.nav.to" href="#ele.nav.to">ele.nav.to</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/nav.lua#L15"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.nav.to.__name" href="#ele.nav.to.__name">ele.nav.to.__name</a></h4>
<h3>Function <a id="ele.nav.to.line" href="#ele.nav.to.line">ele.nav.to.line</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/nav.lua#L42"><i>src</i></a>)</h3>
<h3>Function <a id="ele.nav.to.listcwd" href="#ele.nav.to.listcwd">ele.nav.to.listcwd</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/nav.lua#L40"><i>src</i></a>)</h3>
<h2>Module <a id="ele.testing" href="#ele.testing">ele.testing</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/testing.lua#L2"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.testing.SLEEP" href="#ele.testing.SLEEP">ele.testing.SLEEP</a></h4>
<h4>Value <a id="ele.testing.__name" href="#ele.testing.__name">ele.testing.__name</a></h4>
<h3>Function <a id="ele.testing.newSession" href="#ele.testing.newSession">ele.testing.newSession</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/testing.lua#L18"><i>src</i></a>)</h3>
<h2>Module <a id="ele.types" href="#ele.types">ele.types</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/types.lua#L1"><i>src</i></a>)</h2>
<p>
<h4>Value <a id="ele.types.ID" href="#ele.types.ID">ele.types.ID</a></h4>
<h4>Value <a id="ele.types.__name" href="#ele.types.__name">ele.types.__name</a></h4>
<h3>Function <a id="ele.types.checkAction" href="#ele.types.checkAction">ele.types.checkAction</a><code>(data, action) -&gt; errstring</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/types.lua#L56"><i>src</i></a>)</h3>
<h3>Function <a id="ele.types.checkBinding" href="#ele.types.checkBinding">ele.types.checkBinding</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/types.lua#L19"><i>src</i></a>)</h3>
<h3>Function <a id="ele.types.checkBindings" href="#ele.types.checkBindings">ele.types.checkBindings</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/types.lua#L44"><i>src</i></a>)</h3>
<h3>Function <a id="ele.types.checkMode" href="#ele.types.checkMode">ele.types.checkMode</a><code>(data, mode) -&gt; errstring</code> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/types.lua#L50"><i>src</i></a>)</h3>
<h3>Function <a id="ele.types.uniqueId" href="#ele.types.uniqueId">ele.types.uniqueId</a> (<a href="https://github.com/civboot/civlua/blob/main/cmd/ele/ele/types.lua#L13"><i>src</i></a>)</h3>
<p>
<code>ele.types.term</code> | [Mod<vt100>] (<a href="https://github.com/civboot/civlua/blob/main/ui/vt100/vt100.lua#L8">src</a>)
<h1><a id="Package_pkg" href="#Package_pkg">Package pkg</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pkg"><i>src</i></a>)</h1><table>
<tr>
<td><b>summary</b></td>
<td>local and recursive require</td>
</tr>
<tr>
<td><b>version</b></td>
<td><code>0.1-15</code></td>
</tr>
<tr>
<td><b>homepage</b></td>
<td><a href="https://lua.civboot.org#Package_pkg">https://lua.civboot.org#Package_pkg</a></td>
</tr>
</table>
pkg: local and recursive require
<p>
This directory exports one lua module (<code>pkglib.lua</code>) and enables <code>PKG.lua</code>
files to be used for looking up <code>require'someModule'</code> statements in lua.
<p>
Why: <ul>
<li>local development: set <code>LUA_PKGS=./</code> and it will only search for pkgs in your
current directory. You can define a <code>PKG.lua</code> with a <code>pkgs</code> variable to
recursively search for other locally defined packages (see <a href="https://github.com/civboot/civlua/blob/main/PKG.lua">PKG.lua</a>)</li>
<li>concise <code>LUA_PKGS</code> environment variables: you no longer have to maintain a huge
and impossible to read <code>LUA_PATH</code> variable with a bunch of obtuse <code>?</code>.</li>
<li>performance: the <code>PKG.lua</code> locations are cached for future lookups whereas
<code>LUA_PATH</code> must perform a complete search every time.</li>
<li>explicitness: (optional) adds global <code>G</code> to allow explicit globals and makes
using implicit globals an error.</li>
</ul>
<p>
<blockquote> civlua uses this library to maintain 10+ projects at
<a href="http://github.com/civboot/civlua">civlua</a>. PKG files can be converted to
rockspec using <code>./civ.lua pkgrock --help</code></blockquote>
<p>
<p>
<h3><a id="pkg-install" href="#pkg-install">Installation</h3></a>
In your <code>~/.bashrc</code> or equiavalent add:
```
LUA_PATH="path/to/civlua/lib/pkg/?.lua;..."
LUA_PKGS="path/to/civlua;path/to/other/pkg;..."
```
<p>
You can get an interactive lua prompt with
<code>lua -e \"require'pkglib'.install()\"; G.MAIN = {}" -i</code>
(Note: however, you must use <code>G.foo</code> for setting globals, so you may want to
do it slightly different for the shell)
<p>
Alternatively, you can put the following at the top of your lua scripts and they
will be executed with pkg require installed (this is what <a href="https://github.com/civboot/civlua/blob/main/civ.lua">civ.lua</a> does): <code class="block">#!/usr/bin/env -S lua -e "require'pkglib'()"</code>
<p>
<h3><a id="define-pkg" href="#define-pkg">Define PKG</h3></a>
<p>
Your libraries (packages) should have a `PKG.lua` in their root:
<code class="block">name    = 'myLib'
version = '0.1-0'
url     = 'git+http://github.com/my/repo'
srcs    = {
    'myLib.lua',      -- require'myLib'
    'myLib/sub1.lua', -- require'myLib.sub1'

    -- require'myLib.sub2'
    ['myLib.sub2'] = 'lib/myLib/submodule.lua'}, 
}
pkgs = {
  'path/to/subpkg/',
}

-- (optional) provide initial rockspec for external tooling
-- https://github.com/luarocks/luarocks/wiki/Rockspec-format
rockspec = {}</code>
<p>
<p>
<h3><a id="pkg-protocol" href="#pkg-protocol">PKG Protocol</h3></a>
pkg exports a few OPTIONAL global variables. Other libraries which override
<code>require</code> or want to create self-documenting code are encouraged to use these
in the following way in order to support both normal and pkglib environments: <ul>
<li><code>local G = G or _G</code> to define/get undefined globals in a typosafe way <ul>
<li>pkglib sets a metatable to <code>_G</code> so that access to <b>undefined</b> globals
throw an error. Note that **defined** globals behave normally with no
performance penalty.</li>
<li>Usage: `G.myGlobal = G.myGlobal or true` will define the global `myGlobal`
as `true` if it is not already defined.</li>
</ul></li>
<li><code>local M = G.mod and mod'myModName' or {}</code> to initialize your module. This
enables self-documenting modules (global <code>mod</code>).</li>
<li><code>G.MAIN = G.MAIN or M</code> should be run before you <code>require</code> other libraries,
but only if your module is runnable from the command line. <ul>
<li>Why: later (at the bottom of your script) you can do
<code>if M == MAIN then M.main(arg); os.exit(0) end</code> to make your library run as
a script when called directly.</li>
<li>This is never required for libraries. It is REQUIRED if your script can be
run from the command line and installs pkg-protocol libraries in it's
dependency tree, as many libraries behave differently when called directly
(i.e. they will run a command and exit).</li>
</ul></li>
</ul>
<p>
<h3><a id="pkg-script" href="#pkg-script">Example Script</h3></a> <code class="block">#!/usr/bin/env -S lua -e "require'pkglib'()"
local G = G or _G -- typosafe globals

--- this module is self documenting from pkglib.
--- Get documentation with [$doc 'myModName.item']
local M = G.mod and mod'myModName' or {} -- self-documenting module
G.MAIN = G.MAIN or M                     -- (cmdline script only)

--- docs for myFn
M.myFn = function() ... end --&gt; returnType

--- docs for main function when run directly
M.main = function(args) --&gt; int
  ... use as a script
end

if M == MAIN then os.exit(M.main(arg)) end
return M -- return as a library</code>
<p>
See also: <a href="#Package_doc">#Package_doc</a>, <a href="#Package_shim">#Package_shim</a>
<p>
<h3>How do PKG.lua files work?</h3>
PKG.lua files are executed in a sandbox. Their environment has access to only
the following globals: <ul>
<li><code>pairs ipairs error assert</code></li>
<li>from string: <code>format</code></li>
<li>from table: <code>insert sort concat</code></li>
</ul>
<p>
It also has the globals <code>UNAME, LIB_EXT</code> which can be values such as
<code>"Linux",".so"</code> or <code>"Windows",".dll"</code> and are for loading C libraries.
<p>
Any globals that the PKG.lua script defines are used as the configuration.
<p>
<h2>Module <a id="pkglib" href="#pkglib">pkglib</a></h2>
<p>
<h3>Table <a id="pkglib.ENV" href="#pkglib.ENV">pkglib.ENV</a></h3>
<h3>Table <a id="pkglib.G" href="#pkglib.G">pkglib.G</a></h3>
<h4>Value <a id="pkglib.LIB_EXT" href="#pkglib.LIB_EXT">pkglib.LIB_EXT</a></h4>
<h3>Table <a id="pkglib.PKGS" href="#pkglib.PKGS">pkglib.PKGS</a></h3>
<h4>Value <a id="pkglib.UNAME" href="#pkglib.UNAME">pkglib.UNAME</a></h4>
<h3>Table <a id="mod" href="#mod">mod</a> (<a href="https://github.com/civboot/civlua/blob/main/lib/pkg/pkglib.lua#L209"><i>src</i></a>)</h3>
</body></html>